Excel处理器部署和使用说明
==========================

一、系统要求
-----------

### 1.1 硬件要求
- CPU: Intel i3 或 AMD 同等性能以上
- 内存: 4GB RAM 以上（推荐 8GB）
- 硬盘: 至少 1GB 可用空间
- 显示器: 分辨率 1024x768 以上

### 1.2 软件要求
- 操作系统: Windows 10/11 (64位)
- .NET Runtime: .NET 6.0 或更高版本
- 数据库: SQLite (内置)
- 可选: SQL Server, MySQL, Oracle (用于外部数据源)

### 1.3 依赖组件
- Material Design in XAML Toolkit
- ClosedXML (Excel处理)
- Dapper (数据访问)
- SQLite (数据库)
- Quartz.NET (任务调度)

二、安装部署
-----------

### 2.1 下载安装
1. 下载最新版本的 ExcelProcessor.exe
2. 将文件解压到目标目录
3. 确保目标目录有写入权限
4. 双击 ExcelProcessor.exe 启动程序

### 2.2 首次运行配置
1. 程序首次运行会自动创建数据库文件
2. 系统会在程序目录下创建以下文件：
   - ExcelProcessor.db (系统数据库)
   - logs/ (日志目录)
   - config/ (配置目录)
   - data/ (数据目录)

### 2.3 环境检查
程序启动时会自动检查：
- .NET Runtime 版本
- 数据库连接
- 文件权限
- 依赖组件

三、基本使用流程
--------------

### 3.1 数据源配置
1. 点击顶部导航栏的"数据源管理"
2. 点击"添加数据源"按钮
3. 选择数据源类型：
   - SQLite (推荐，内置)
   - SQL Server
   - MySQL
   - Oracle
4. 填写连接信息：
   - 数据源名称
   - 连接字符串
   - 用户名密码（如需要）
5. 点击"测试连接"验证配置
6. 点击"保存"完成配置

### 3.2 Excel导入配置
1. 点击"Excel导入配置"
2. 点击"新建配置"按钮
3. 配置基本信息：
   - 配置名称
   - Excel文件路径
   - 目标数据源
4. 配置工作表映射：
   - 选择工作表
   - 设置目标表名
   - 配置字段映射
5. 设置导入选项：
   - 是否包含标题行
   - 是否清空目标表
   - 数据预览
6. 点击"保存"完成配置

### 3.3 SQL处理配置
1. 点击"SQL管理"
2. 点击"新建SQL"按钮
3. 配置SQL脚本：
   - SQL名称
   - 选择执行数据源
   - 编写SQL脚本
   - 配置参数（如需要）
4. 设置输出配置：
   - 输出到数据库表
   - 输出到Excel文件
   - 输出到CSV文件
5. 点击"保存"完成配置

### 3.4 作业配置
1. 点击"作业配置"
2. 点击"新建作业"按钮
3. 配置作业基本信息：
   - 作业名称
   - 作业描述
4. 添加执行步骤：
   - Excel导入步骤
   - SQL执行步骤
   - 数据导出步骤
5. 设置执行调度：
   - 手动执行
   - 定时执行（Cron表达式）
6. 点击"保存"完成配置

### 3.5 作业执行
1. 在作业管理页面查看所有作业
2. 选择要执行的作业
3. 点击"运行"按钮开始执行
4. 查看执行进度和状态
5. 查看执行日志和结果

四、高级功能
-----------

### 4.1 批量处理
1. 配置多个Excel文件路径
2. 设置批量处理规则
3. 创建批量作业
4. 一键执行所有任务

### 4.2 定时任务
1. 在作业配置中设置Cron表达式
2. 系统会自动按计划执行
3. 支持多种调度模式：
   - 每天执行
   - 每周执行
   - 每月执行
   - 自定义时间

### 4.3 数据导出
1. 支持多种导出格式：
   - Excel (.xlsx)
   - CSV (.csv)
   - JSON (.json)
   - XML (.xml)
2. 配置导出路径和文件名
3. 支持数据格式化和转换

### 4.4 配置导入导出
1. 导出配置：
   - 选择要导出的配置
   - 选择导出格式（JSON）
   - 设置导出路径
   - 点击"导出"
2. 导入配置：
   - 选择配置文件
   - 系统自动解析配置
   - 确认导入内容
   - 点击"导入"

五、故障排除
-----------

### 5.1 常见问题

#### 问题1: 程序无法启动
**症状**: 双击程序无反应或报错
**解决方案**:
1. 检查.NET Runtime是否安装
2. 检查文件权限
3. 查看错误日志文件
4. 重新下载程序文件

#### 问题2: 数据库连接失败
**症状**: 提示数据库连接错误
**解决方案**:
1. 检查数据库文件是否存在
2. 检查文件权限
3. 删除损坏的数据库文件，重新启动程序
4. 检查磁盘空间

#### 问题3: Excel文件读取失败
**症状**: 无法读取Excel文件
**解决方案**:
1. 检查文件路径是否正确
2. 确认文件格式支持（.xlsx, .xls）
3. 检查文件是否被其他程序占用
4. 确认文件没有损坏

#### 问题4: SQL执行失败
**症状**: SQL脚本执行报错
**解决方案**:
1. 检查SQL语法是否正确
2. 确认数据源连接正常
3. 检查表结构和字段名
4. 查看详细错误信息

#### 问题5: 作业执行失败
**症状**: 作业执行过程中出错
**解决方案**:
1. 检查作业配置是否正确
2. 确认所有步骤配置完整
3. 查看执行日志
4. 检查数据源连接

### 5.2 日志查看
1. 程序日志位置：logs/目录
2. 日志文件命名：ExcelProcessor_YYYY-MM-DD.log
3. 日志级别：Debug, Info, Warning, Error
4. 查看方法：
   - 程序内查看：系统设置 -> 日志查看
   - 直接打开文件：用文本编辑器打开

### 5.3 性能优化
1. 大数据量处理：
   - 分批处理数据
   - 优化SQL查询
   - 使用索引
2. 内存优化：
   - 及时释放资源
   - 避免一次性加载大量数据
3. 磁盘优化：
   - 定期清理日志文件
   - 使用SSD硬盘
   - 定期备份数据

六、安全建议
-----------

### 6.1 数据安全
1. 定期备份数据库文件
2. 加密敏感配置信息
3. 限制文件访问权限
4. 使用强密码

### 6.2 系统安全
1. 及时更新程序版本
2. 使用防火墙保护
3. 定期检查日志
4. 监控异常访问

### 6.3 操作安全
1. 测试环境验证配置
2. 备份重要数据
3. 记录操作日志
4. 定期检查执行结果

七、技术支持
-----------

### 7.1 获取帮助
1. 查看程序内置帮助文档
2. 查看日志文件获取错误信息
3. 联系技术支持团队
4. 提交问题反馈

### 7.2 更新升级
1. 定期检查程序更新
2. 备份当前配置和数据
3. 下载最新版本
4. 按照升级说明操作

### 7.3 培训资源
1. 用户手册
2. 视频教程
3. 在线培训
4. 技术文档

八、版本历史
-----------

### v1.0.0 (2024-01-15)
- 初始版本发布
- 支持Excel导入配置
- 支持SQL管理
- 支持作业配置和执行
- 支持数据源管理
- 支持配置导入导出
- 支持系统设置

### 后续版本计划
- v1.1.0: 增加数据可视化功能
- v1.2.0: 支持更多数据源类型
- v1.3.0: 增加批量处理功能
- v2.0.0: 支持分布式部署

九、许可证信息
-------------
本软件遵循相关开源许可证，具体条款请查看LICENSE文件。

十、联系方式
-----------
- 技术支持：support@excelprocessor.com
- 官方网站：https://www.excelprocessor.com
- 问题反馈：https://github.com/excelprocessor/issues 