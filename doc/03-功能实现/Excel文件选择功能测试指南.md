# Excel文件选择功能测试指南

## 测试目标

验证Excel文件选择功能是否正确工作，包括：
1. 文件选择后界面正确更新
2. 智能列名识别和生成
3. 自动填充设置
4. 用户反馈和操作指导

## 测试步骤

### 1. 启动应用程序

```bash
dotnet run --project ExcelProcessor.WPF
```

### 2. 导航到Excel编辑页面

1. 打开应用程序
2. 点击左侧菜单的"Excel编辑"
3. 点击"新建配置"按钮
4. 进入编辑配置界面

### 3. 测试文件选择功能

#### 测试用例1：客户相关文件

**测试文件命名**：
- `customer_data.xlsx`
- `客户信息.xlsx`
- `客户管理.xlsx`

**预期结果**：
- 自动填充Sheet名称：Sheet1
- 自动填充标题行号：1
- 字段映射表格显示：
  - 客户编号 (customer_id, VARCHAR(50), 必填)
  - 客户名称 (customer_name, VARCHAR(100), 必填)
  - 联系电话 (phone, VARCHAR(50), 非必填)
  - 邮箱 (email, VARCHAR(200), 非必填)
  - 地址 (address, VARCHAR(100), 非必填)
  - 创建日期 (created_date, DATE, 必填)

#### 测试用例2：销售相关文件

**测试文件命名**：
- `sales_data.xlsx`
- `销售记录.xlsx`
- `订单管理.xlsx`
- `order_list.xlsx`

**预期结果**：
- 字段映射表格显示：
  - 订单编号 (order_id, VARCHAR(50), 必填)
  - 客户名称 (customer_name, VARCHAR(100), 必填)
  - 产品名称 (product_name, VARCHAR(100), 必填)
  - 数量 (quantity, INT, 非必填)
  - 单价 (unit_price, DECIMAL(10,2), 非必填)
  - 总金额 (total_amount, DECIMAL(10,2), 非必填)
  - 销售日期 (sales_date, DATE, 必填)

#### 测试用例3：产品相关文件

**测试文件命名**：
- `product_list.xlsx`
- `产品信息.xlsx`
- `商品管理.xlsx`

**预期结果**：
- 字段映射表格显示：
  - 产品编号 (product_id, VARCHAR(50), 必填)
  - 产品名称 (product_name, VARCHAR(100), 必填)
  - 类别 (category, VARCHAR(100), 非必填)
  - 价格 (price, DECIMAL(10,2), 非必填)
  - 库存 (stock, INT, 非必填)
  - 供应商 (supplier, VARCHAR(100), 非必填)

#### 测试用例4：员工相关文件

**测试文件命名**：
- `employee_data.xlsx`
- `员工信息.xlsx`
- `人员管理.xlsx`

**预期结果**：
- 字段映射表格显示：
  - 员工编号 (employee_id, VARCHAR(50), 必填)
  - 姓名 (name, VARCHAR(100), 必填)
  - 部门 (department, VARCHAR(100), 必填)
  - 职位 (position, VARCHAR(100), 必填)
  - 入职日期 (hire_date, DATE, 必填)
  - 薪资 (salary, DECIMAL(10,2), 非必填)

#### 测试用例5：库存相关文件

**测试文件命名**：
- `inventory_data.xlsx`
- `库存管理.xlsx`
- `存货清单.xlsx`

**预期结果**：
- 字段映射表格显示：
  - 商品编号 (item_id, VARCHAR(50), 必填)
  - 商品名称 (item_name, VARCHAR(100), 必填)
  - 库存数量 (stock_quantity, INT, 非必填)
  - 单位 (unit, VARCHAR(100), 非必填)
  - 仓库位置 (warehouse_location, VARCHAR(100), 非必填)
  - 最后更新 (last_updated, DATE, 非必填)

#### 测试用例6：默认文件

**测试文件命名**：
- `data.xlsx`
- `test.xlsx`
- `文件.xlsx`

**预期结果**：
- 字段映射表格显示：
  - 第一列 (column_1, VARCHAR(100), 非必填)
  - 第二列 (column_2, VARCHAR(100), 非必填)
  - 第三列 (column_3, VARCHAR(100), 非必填)
  - 第四列 (column_4, VARCHAR(100), 非必填)
  - 第五列 (column_5, VARCHAR(100), 非必填)
  - 第六列 (column_6, VARCHAR(100), 非必填)

## 测试验证点

### ✅ 界面更新验证

1. **文件路径显示**：
   - 选择文件后，文件路径文本框应正确显示完整路径
   - 路径应包含文件名和扩展名

2. **自动填充设置**：
   - Sheet名称自动设置为"Sheet1"
   - 标题行号自动设置为"1"

3. **字段映射表格**：
   - 表格应显示正确的列名
   - 数据库字段名应正确映射
   - 数据类型应正确推断
   - 必填字段应正确标记

### ✅ 用户反馈验证

1. **成功消息**：
   - 选择文件后应显示成功消息
   - 消息应包含文件名
   - 消息应提供操作指导

2. **错误处理**：
   - 如果文件读取失败，应显示警告消息
   - 应加载默认示例数据

### ✅ 功能完整性验证

1. **配置名称**：
   - 可以输入配置名称
   - 配置名称应正确保存

2. **目标数据源**：
   - 下拉选择框应可用
   - 应显示可用的数据源选项

3. **执行选项**：
   - "跳过空行"复选框应可用
   - 复选框状态应正确保存

4. **字段映射操作**：
   - "添加映射"按钮应可用
   - "删除"按钮应可用
   - 可以编辑字段映射

## 调试信息

### 控制台输出

应用程序会在控制台输出调试信息：
```
文件名: [实际文件名]
识别为[文件类型]文件
```

### 常见问题排查

1. **文件选择后无反应**：
   - 检查文件路径是否正确
   - 检查文件是否存在
   - 检查文件权限

2. **列名显示不正确**：
   - 检查文件名是否包含关键词
   - 检查调试输出中的文件名识别结果

3. **数据类型推断错误**：
   - 检查列名是否包含相关关键词
   - 检查数据类型映射规则

## 测试报告模板

### 测试结果记录

| 测试用例 | 文件名 | 预期结果 | 实际结果 | 状态 |
|---------|--------|----------|----------|------|
| 客户文件 | customer_data.xlsx | 客户相关字段 | [实际结果] | ✅/❌ |
| 销售文件 | sales_data.xlsx | 销售相关字段 | [实际结果] | ✅/❌ |
| 产品文件 | product_list.xlsx | 产品相关字段 | [实际结果] | ✅/❌ |
| 员工文件 | employee_data.xlsx | 员工相关字段 | [实际结果] | ✅/❌ |
| 库存文件 | inventory_data.xlsx | 库存相关字段 | [实际结果] | ✅/❌ |
| 默认文件 | data.xlsx | 默认列名 | [实际结果] | ✅/❌ |

### 问题记录

| 问题描述 | 重现步骤 | 预期行为 | 实际行为 | 严重程度 |
|----------|----------|----------|----------|----------|
| [问题描述] | [重现步骤] | [预期行为] | [实际行为] | 高/中/低 |

## 总结

通过以上测试步骤，可以全面验证Excel文件选择功能的正确性。如果所有测试用例都通过，说明功能已经正确实现并可以正常使用。

**测试状态**：✅ 准备就绪
**测试环境**：Windows 10 + .NET 6.0
**测试工具**：ExcelProcessor.WPF应用程序 