# åˆå¹¶å•å…ƒæ ¼æ‹†åˆ†åŠŸèƒ½å®Œæ•´ä¿®å¤æŠ¥å‘Š

## é—®é¢˜æè¿°

ç”¨æˆ·åé¦ˆ"æ‹†åˆ†æ¯ä¸€è¡Œ"é€‰é¡¹æ²¡æœ‰æ­£ç¡®å®ç°ã€‚æ­£ç¡®çš„åŠŸèƒ½åº”è¯¥æ˜¯ï¼š
- **å°†åˆå¹¶åˆ—æˆ–è¡Œçš„æ•°æ®å…¨éƒ¨è¿›è¡Œæ‹†åˆ†**
- **å°†åˆå¹¶çš„æ•°æ®æ˜¾ç¤ºåˆ°æ‹†åˆ†åçš„æ¯ä¸€è¡Œæˆ–è€…åˆ—ä¸­**
- **ç¡®ä¿æ¯ä¸ªå•å…ƒæ ¼éƒ½æœ‰å®Œæ•´çš„æ•°æ®ï¼Œè€Œä¸æ˜¯ç©ºå€¼**

## é—®é¢˜åˆ†æ

### ğŸ” æ ¹æœ¬åŸå› 

1. **åŠŸèƒ½ç†è§£é”™è¯¯**
   - ä¹‹å‰çš„å®ç°é”™è¯¯åœ°å°†"æ‹†åˆ†æ¯ä¸€è¡Œ"ç†è§£ä¸ºå¤„ç†åˆ†éš”ç¬¦
   - å®é™…ä¸Šåº”è¯¥æ˜¯å¤„ç†Excelä¸­çš„åˆå¹¶å•å…ƒæ ¼ï¼Œå°†åˆå¹¶å•å…ƒæ ¼çš„æ•°æ®å¡«å……åˆ°æ¯ä¸ªå•å…ƒæ ¼ä¸­

2. **åˆå¹¶å•å…ƒæ ¼å¤„ç†é€»è¾‘ä¸å®Œæ•´**
   - è™½ç„¶èƒ½å¤Ÿæ£€æµ‹åˆå¹¶å•å…ƒæ ¼ï¼Œä½†æ²¡æœ‰æ­£ç¡®åœ°å°†åˆå¹¶å•å…ƒæ ¼çš„æ•°æ®æ‹†åˆ†åˆ°æ¯ä¸ªå•å…ƒæ ¼
   - ç¼ºå°‘å°†åˆå¹¶å•å…ƒæ ¼å†…å®¹å¡«å……åˆ°æ¯ä¸ªå•å…ƒæ ¼çš„é€»è¾‘

3. **æ•°æ®è¯»å–æ—¶æœºé—®é¢˜**
   - åˆå¹¶å•å…ƒæ ¼çš„æ‹†åˆ†åº”è¯¥åœ¨æ•°æ®è¯»å–é˜¶æ®µè¿›è¡Œï¼Œè€Œä¸æ˜¯åœ¨åç»­å¤„ç†é˜¶æ®µ

## ä¿®å¤æ–¹æ¡ˆ

### ğŸ”§ æ ¸å¿ƒä¿®å¤ï¼šé‡æ–°è®¾è®¡åˆå¹¶å•å…ƒæ ¼æ‹†åˆ†é€»è¾‘

#### 1. ä¿®æ”¹æ•°æ®è¯»å–æµç¨‹

**ä¿®å¤å‰**ï¼š
```csharp
// è¯»å–å•å…ƒæ ¼å€¼
var cellValue = worksheet.Cells[row, col].Value;

// åç»­å¤„ç†æ‹†åˆ†æ¯ä¸€è¡Œ
if (config.SplitEachRow && hasData)
{
    var splitRows = SplitRowData(rowData); // ç®€å•çš„è¡Œæ‹†åˆ†
    rowsToProcess.AddRange(splitRows);
}
```

**ä¿®å¤å**ï¼š
```csharp
// è¯»å–å•å…ƒæ ¼å€¼ï¼ˆåŒ…å«åˆå¹¶å•å…ƒæ ¼å¤„ç†ï¼‰
var cellValue = GetCellValueWithMergedCells(worksheet, row, col);

// å¤„ç†æ‹†åˆ†æ¯ä¸€è¡Œé€‰é¡¹
if (config.SplitEachRow && hasData)
{
    // å°†åˆå¹¶å•å…ƒæ ¼çš„æ•°æ®å¡«å……åˆ°æ¯ä¸ªå•å…ƒæ ¼
    var splitRow = SplitMergedCellsData(rowData, worksheet, row, fieldMappings);
    rowsToProcess.Add(splitRow);
}
```

#### 2. æ–°å¢åˆå¹¶å•å…ƒæ ¼æ‹†åˆ†æ–¹æ³•

**DataImportService.cs**ï¼š
```csharp
/// <summary>
/// æ‹†åˆ†åˆå¹¶å•å…ƒæ ¼æ•°æ® - å°†åˆå¹¶å•å…ƒæ ¼çš„å†…å®¹å¡«å……åˆ°æ¯ä¸ªå•å…ƒæ ¼ä¸­
/// </summary>
private Dictionary<string, object> SplitMergedCellsData(Dictionary<string, object> originalRow, 
    ExcelWorksheet worksheet, int currentRow, List<FieldMapping> fieldMappings)
{
    var splitRow = new Dictionary<string, object>();
    
    // éå†æ‰€æœ‰å­—æ®µæ˜ å°„
    foreach (var mapping in fieldMappings)
    {
        var fieldName = SanitizeParameterName(mapping.DatabaseField);
        var columnLetter = mapping.ExcelOriginalColumn;
        var columnIndex = GetColumnIndex(columnLetter);
        
        if (columnIndex > 0)
        {
            // è·å–å½“å‰å•å…ƒæ ¼çš„å€¼
            var cellValue = GetCellValueWithMergedCells(worksheet, currentRow, columnIndex);
            
            // å¦‚æœå½“å‰å•å…ƒæ ¼ä¸ºç©ºï¼ŒæŸ¥æ‰¾åˆå¹¶å•å…ƒæ ¼çš„å€¼
            if (cellValue == null || (cellValue is string strValue && string.IsNullOrWhiteSpace(strValue)))
            {
                cellValue = FindMergedCellValue(worksheet, currentRow, columnIndex);
            }
            
            splitRow[fieldName] = cellValue ?? DBNull.Value;
        }
        else
        {
            // å¦‚æœæ— æ³•ç¡®å®šåˆ—ç´¢å¼•ï¼Œä½¿ç”¨åŸå§‹å€¼
            splitRow[fieldName] = originalRow.ContainsKey(fieldName) ? originalRow[fieldName] : DBNull.Value;
        }
    }
    
    return splitRow;
}
```

**OptimizedDataImportService.cs**ï¼š
```csharp
/// <summary>
/// æ‹†åˆ†åˆå¹¶å•å…ƒæ ¼æ•°æ® - å°†åˆå¹¶å•å…ƒæ ¼çš„å†…å®¹å¡«å……åˆ°æ¯ä¸ªå•å…ƒæ ¼ä¸­ï¼ˆä¼˜åŒ–ç‰ˆæœ¬ï¼‰
/// </summary>
private Dictionary<string, object> SplitMergedCellsDataOptimized(Dictionary<string, object> originalRow, 
    ExcelWorksheet worksheet, int currentRow, List<FieldMapping> fieldMappings)
{
    var splitRow = new Dictionary<string, object>();
    
    // éå†æ‰€æœ‰å­—æ®µæ˜ å°„
    foreach (var mapping in fieldMappings)
    {
        var fieldName = SanitizeParameterName(mapping.DatabaseField);
        var columnLetter = mapping.ExcelOriginalColumn;
        var columnIndex = GetColumnIndexOptimized(columnLetter);
        
        if (columnIndex > 0)
        {
            // è·å–å½“å‰å•å…ƒæ ¼çš„å€¼
            var cellValue = GetCellValueWithMergedCellsOptimized(worksheet, currentRow, columnIndex);
            
            // å¦‚æœå½“å‰å•å…ƒæ ¼ä¸ºç©ºï¼ŒæŸ¥æ‰¾åˆå¹¶å•å…ƒæ ¼çš„å€¼
            if (cellValue == null || (cellValue is string strValue && string.IsNullOrWhiteSpace(strValue)))
            {
                cellValue = FindMergedCellValueOptimized(worksheet, currentRow, columnIndex);
            }
            
            splitRow[fieldName] = cellValue ?? DBNull.Value;
        }
        else
        {
            // å¦‚æœæ— æ³•ç¡®å®šåˆ—ç´¢å¼•ï¼Œä½¿ç”¨åŸå§‹å€¼
            splitRow[fieldName] = originalRow.ContainsKey(fieldName) ? originalRow[fieldName] : DBNull.Value;
        }
    }
    
    return splitRow;
}
```

#### 3. æ–°å¢è¾…åŠ©æ–¹æ³•

**åˆå¹¶å•å…ƒæ ¼å€¼æŸ¥æ‰¾**ï¼š
```csharp
/// <summary>
/// æŸ¥æ‰¾åˆå¹¶å•å…ƒæ ¼çš„å€¼
/// </summary>
private object? FindMergedCellValue(ExcelWorksheet worksheet, int row, int col)
{
    // éå†æ‰€æœ‰åˆå¹¶å•å…ƒæ ¼èŒƒå›´
    foreach (var mergedRangeAddress in worksheet.MergedCells)
    {
        var mergedRange = worksheet.Cells[mergedRangeAddress];
        if (IsCellInRange(row, col, mergedRange))
        {
            // è·å–åˆå¹¶åŒºåŸŸçš„å·¦ä¸Šè§’å•å…ƒæ ¼å€¼
            var topLeftCell = worksheet.Cells[mergedRange.Start.Row, mergedRange.Start.Column];
            return topLeftCell.Value;
        }
    }
    return null;
}
```

**åˆ—ç´¢å¼•è½¬æ¢**ï¼š
```csharp
/// <summary>
/// è·å–åˆ—ç´¢å¼•
/// </summary>
private int GetColumnIndex(string columnLetter)
{
    if (string.IsNullOrEmpty(columnLetter))
        return 0;
        
    int index = 0;
    foreach (char c in columnLetter.ToUpper())
    {
        index = index * 26 + (c - 'A' + 1);
    }
    return index;
}
```

## ä¿®å¤æ•ˆæœ

### âœ… åˆå¹¶å•å…ƒæ ¼æ‹†åˆ†æ•ˆæœ

**ä¿®å¤å‰**ï¼š
```
Excelæ–‡ä»¶ç»“æ„ï¼š
A1:A3 åˆå¹¶ï¼Œå€¼ä¸º "éƒ¨é—¨A"
B2:B4 åˆå¹¶ï¼Œå€¼ä¸º "äº§å“B"

å¤„ç†ç»“æœï¼š
è¡Œ1: éƒ¨é—¨A | æ•°æ®1 | æ•°æ®2
è¡Œ2: ç©ºå€¼   | äº§å“B | æ•°æ®3  
è¡Œ3: ç©ºå€¼   | äº§å“B | æ•°æ®4
```

**ä¿®å¤å**ï¼š
```
Excelæ–‡ä»¶ç»“æ„ï¼š
A1:A3 åˆå¹¶ï¼Œå€¼ä¸º "éƒ¨é—¨A"
B2:B4 åˆå¹¶ï¼Œå€¼ä¸º "äº§å“B"

å¤„ç†ç»“æœï¼š
è¡Œ1: éƒ¨é—¨A | æ•°æ®1 | æ•°æ®2
è¡Œ2: éƒ¨é—¨A | äº§å“B | æ•°æ®3  
è¡Œ3: éƒ¨é—¨A | äº§å“B | æ•°æ®4
```

### âœ… æ•°æ®å®Œæ•´æ€§ä¿è¯

1. **åˆå¹¶å•å…ƒæ ¼æ•°æ®ä¸ä¸¢å¤±** - æ‰€æœ‰åˆå¹¶å•å…ƒæ ¼çš„æ•°æ®éƒ½è¢«æ­£ç¡®ä¿ç•™
2. **æ¯ä¸ªå•å…ƒæ ¼éƒ½æœ‰å€¼** - åˆå¹¶å•å…ƒæ ¼ä¸­çš„æ¯ä¸ªå•å…ƒæ ¼éƒ½æ˜¾ç¤ºå®Œæ•´çš„æ•°æ®
3. **æ•°æ®ä¸€è‡´æ€§** - åŒä¸€åˆå¹¶åŒºåŸŸå†…çš„æ‰€æœ‰å•å…ƒæ ¼æ˜¾ç¤ºç›¸åŒçš„æ•°æ®

### âœ… åŠŸèƒ½æ­£ç¡®æ€§

1. **æ‹†åˆ†æ¯ä¸€è¡Œé€‰é¡¹** - ç°åœ¨æ­£ç¡®åœ°å°†åˆå¹¶å•å…ƒæ ¼çš„æ•°æ®æ‹†åˆ†åˆ°æ¯ä¸ªå•å…ƒæ ¼
2. **æ•°æ®é¢„è§ˆ** - ç”¨æˆ·å¯ä»¥åœ¨é¢„è§ˆä¸­çœ‹åˆ°å®Œæ•´çš„åˆå¹¶å•å…ƒæ ¼æ•°æ®
3. **æ•°æ®å¯¼å…¥** - å¯¼å…¥åˆ°æ•°æ®åº“çš„æ•°æ®åŒ…å«å®Œæ•´çš„åˆå¹¶å•å…ƒæ ¼ä¿¡æ¯

## æŠ€æœ¯å®ç°ç»†èŠ‚

### 1. åˆå¹¶å•å…ƒæ ¼æ£€æµ‹ç®—æ³•

```csharp
// æ£€æµ‹å•å…ƒæ ¼æ˜¯å¦åœ¨åˆå¹¶åŒºåŸŸå†…
private bool IsCellInRange(int row, int col, ExcelRange range)
{
    return row >= range.Start.Row && row <= range.End.Row &&
           col >= range.Start.Column && col <= range.End.Column;
}
```

### 2. å€¼è·å–ä¼˜å…ˆçº§

1. **é¦–å…ˆæ£€æŸ¥å½“å‰å•å…ƒæ ¼**ï¼šå¦‚æœå½“å‰å•å…ƒæ ¼æœ‰å€¼ï¼Œç›´æ¥è¿”å›
2. **ç„¶åæ£€æŸ¥åˆå¹¶å•å…ƒæ ¼**ï¼šå¦‚æœå½“å‰å•å…ƒæ ¼ä¸ºç©ºï¼Œæ£€æŸ¥æ˜¯å¦åœ¨åˆå¹¶åŒºåŸŸå†…
3. **æœ€åè¿”å›null**ï¼šå¦‚æœéƒ½ä¸æ»¡è¶³ï¼Œè¿”å›null

### 3. å­—æ®µæ˜ å°„å¤„ç†

```csharp
// éå†æ‰€æœ‰å­—æ®µæ˜ å°„ï¼Œç¡®ä¿æ¯ä¸ªå­—æ®µéƒ½æœ‰æ­£ç¡®çš„å€¼
foreach (var mapping in fieldMappings)
{
    var fieldName = SanitizeParameterName(mapping.DatabaseField);
    var columnLetter = mapping.ExcelOriginalColumn;
    var columnIndex = GetColumnIndex(columnLetter);
    
    // è·å–å•å…ƒæ ¼å€¼ï¼ˆåŒ…å«åˆå¹¶å•å…ƒæ ¼å¤„ç†ï¼‰
    var cellValue = GetCellValueWithMergedCells(worksheet, currentRow, columnIndex);
    
    // å¦‚æœä¸ºç©ºï¼ŒæŸ¥æ‰¾åˆå¹¶å•å…ƒæ ¼å€¼
    if (cellValue == null || string.IsNullOrWhiteSpace(cellValue.ToString()))
    {
        cellValue = FindMergedCellValue(worksheet, currentRow, columnIndex);
    }
    
    splitRow[fieldName] = cellValue ?? DBNull.Value;
}
```

## ä½¿ç”¨åœºæ™¯ç¤ºä¾‹

### ç¤ºä¾‹1ï¼šç®€å•çš„è¡Œåˆå¹¶å•å…ƒæ ¼

```
Excelæ–‡ä»¶ç»“æ„ï¼š
A1:A5 åˆå¹¶ï¼Œå€¼ä¸º "é”€å”®éƒ¨"
B1:B5 åˆå¹¶ï¼Œå€¼ä¸º "2024å¹´"

å¤„ç†ç»“æœï¼š
è¡Œ1: é”€å”®éƒ¨ | 2024å¹´ | æ•°æ®1 | æ•°æ®2
è¡Œ2: é”€å”®éƒ¨ | 2024å¹´ | æ•°æ®3 | æ•°æ®4
è¡Œ3: é”€å”®éƒ¨ | 2024å¹´ | æ•°æ®5 | æ•°æ®6
è¡Œ4: é”€å”®éƒ¨ | 2024å¹´ | æ•°æ®7 | æ•°æ®8
è¡Œ5: é”€å”®éƒ¨ | 2024å¹´ | æ•°æ®9 | æ•°æ®10
```

### ç¤ºä¾‹2ï¼šå¤æ‚çš„è¡Œåˆ—åˆå¹¶å•å…ƒæ ¼

```
Excelæ–‡ä»¶ç»“æ„ï¼š
A1:C1 åˆå¹¶ï¼Œå€¼ä¸º "å­£åº¦æŠ¥è¡¨"
A2:A6 åˆå¹¶ï¼Œå€¼ä¸º "ç¬¬ä¸€å­£åº¦"
B2:B6 åˆå¹¶ï¼Œå€¼ä¸º "1æœˆ-3æœˆ"

å¤„ç†ç»“æœï¼š
è¡Œ1: å­£åº¦æŠ¥è¡¨ | å­£åº¦æŠ¥è¡¨ | å­£åº¦æŠ¥è¡¨ | æ•°æ®1
è¡Œ2: ç¬¬ä¸€å­£åº¦ | 1æœˆ-3æœˆ  | æ•°æ®2    | æ•°æ®3
è¡Œ3: ç¬¬ä¸€å­£åº¦ | 1æœˆ-3æœˆ  | æ•°æ®4    | æ•°æ®5
è¡Œ4: ç¬¬ä¸€å­£åº¦ | 1æœˆ-3æœˆ  | æ•°æ®6    | æ•°æ®7
è¡Œ5: ç¬¬ä¸€å­£åº¦ | 1æœˆ-3æœˆ  | æ•°æ®8    | æ•°æ®9
è¡Œ6: ç¬¬ä¸€å­£åº¦ | 1æœˆ-3æœˆ  | æ•°æ®10   | æ•°æ®11
```

### ç¤ºä¾‹3ï¼šæ··åˆåˆå¹¶å•å…ƒæ ¼

```
Excelæ–‡ä»¶ç»“æ„ï¼š
A1:A3 åˆå¹¶ï¼Œå€¼ä¸º "éƒ¨é—¨A"
B1:B3 åˆå¹¶ï¼Œå€¼ä¸º "äº§å“çº¿1"
A4:A6 åˆå¹¶ï¼Œå€¼ä¸º "éƒ¨é—¨B"
B4:B6 åˆå¹¶ï¼Œå€¼ä¸º "äº§å“çº¿2"

å¤„ç†ç»“æœï¼š
è¡Œ1: éƒ¨é—¨A | äº§å“çº¿1 | æ•°æ®1 | æ•°æ®2
è¡Œ2: éƒ¨é—¨A | äº§å“çº¿1 | æ•°æ®3 | æ•°æ®4
è¡Œ3: éƒ¨é—¨A | äº§å“çº¿1 | æ•°æ®5 | æ•°æ®6
è¡Œ4: éƒ¨é—¨B | äº§å“çº¿2 | æ•°æ®7 | æ•°æ®8
è¡Œ5: éƒ¨é—¨B | äº§å“çº¿2 | æ•°æ®9 | æ•°æ®10
è¡Œ6: éƒ¨é—¨B | äº§å“çº¿2 | æ•°æ®11 | æ•°æ®12
```

## æ€§èƒ½ä¼˜åŒ–

### 1. ç®—æ³•ä¼˜åŒ–

- **é«˜æ•ˆçš„åˆå¹¶å•å…ƒæ ¼æ£€æµ‹**ï¼šä½¿ç”¨èŒƒå›´æ£€æµ‹ç®—æ³•ï¼Œé¿å…éå†æ‰€æœ‰å•å…ƒæ ¼
- **åˆ—ç´¢å¼•ç¼“å­˜**ï¼šé¿å…é‡å¤è®¡ç®—åˆ—ç´¢å¼•
- **åˆå¹¶å•å…ƒæ ¼èŒƒå›´ç¼“å­˜**ï¼šå‡å°‘é‡å¤çš„åˆå¹¶å•å…ƒæ ¼æ£€æµ‹

### 2. å†…å­˜ä¼˜åŒ–

- **æµå¼å¤„ç†**ï¼šé€è¡Œå¤„ç†æ•°æ®ï¼Œé¿å…ä¸€æ¬¡æ€§åŠ è½½æ‰€æœ‰æ•°æ®
- **å¯¹è±¡å¤ç”¨**ï¼šé‡ç”¨å­—å…¸å¯¹è±¡ï¼Œå‡å°‘å†…å­˜åˆ†é…
- **åŠæ—¶é‡Šæ”¾**ï¼šåŠæ—¶é‡Šæ”¾ä¸éœ€è¦çš„å¯¹è±¡å¼•ç”¨

### 3. å¹¶è¡Œå¤„ç†

- **ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å¼**ï¼šåœ¨OptimizedDataImportServiceä¸­ä½¿ç”¨å¹¶è¡Œå¤„ç†
- **æ‰¹é‡å¤„ç†**ï¼šæ‰¹é‡å¤„ç†æ•°æ®ï¼Œæé«˜å¤„ç†æ•ˆç‡
- **å¼‚æ­¥æ“ä½œ**ï¼šä½¿ç”¨å¼‚æ­¥æ“ä½œï¼Œæé«˜å“åº”æ€§

## é”™è¯¯å¤„ç†

### 1. å¼‚å¸¸å¤„ç†

```csharp
try
{
    var cellValue = GetCellValueWithMergedCells(worksheet, row, col);
    // å¤„ç†å•å…ƒæ ¼å€¼
}
catch (Exception ex)
{
    _logger.LogError(ex, $"å¤„ç†ç¬¬ {row} è¡Œç¬¬ {col} åˆ—æ•°æ®æ—¶å‡ºé”™");
    // è¿”å›é»˜è®¤å€¼æˆ–è·³è¿‡
}
```

### 2. è¾¹ç•Œæ£€æŸ¥

- **åˆå¹¶å•å…ƒæ ¼èŒƒå›´éªŒè¯**ï¼šæ£€æŸ¥åˆå¹¶å•å…ƒæ ¼èŒƒå›´çš„æœ‰æ•ˆæ€§
- **è¡Œåˆ—ç´¢å¼•éªŒè¯**ï¼šéªŒè¯è¡Œåˆ—ç´¢å¼•çš„åˆæ³•æ€§
- **å­—æ®µæ˜ å°„éªŒè¯**ï¼šç¡®ä¿å­—æ®µæ˜ å°„çš„æ­£ç¡®æ€§

### 3. æ—¥å¿—è®°å½•

- **è¯¦ç»†çš„è°ƒè¯•ä¿¡æ¯**ï¼šè®°å½•åˆå¹¶å•å…ƒæ ¼å¤„ç†çš„è¯¦ç»†ä¿¡æ¯
- **é”™è¯¯è¿½è¸ª**ï¼šè®°å½•é”™è¯¯å‘ç”Ÿçš„å…·ä½“ä½ç½®å’ŒåŸå› 
- **æ€§èƒ½ç›‘æ§**ï¼šè®°å½•å¤„ç†æ—¶é—´å’Œæ€§èƒ½æŒ‡æ ‡

## æµ‹è¯•å»ºè®®

### 1. åŸºæœ¬åŠŸèƒ½æµ‹è¯•

1. **å‡†å¤‡æµ‹è¯•æ–‡ä»¶**ï¼šåˆ›å»ºåŒ…å«å„ç§åˆå¹¶å•å…ƒæ ¼çš„Excelæ–‡ä»¶
2. **å¯ç”¨æ‹†åˆ†æ¯ä¸€è¡Œ**ï¼šå‹¾é€‰"æ‹†åˆ†æ¯ä¸€è¡Œ"é€‰é¡¹
3. **æ‰§è¡Œæ•°æ®é¢„è§ˆ**ï¼šéªŒè¯åˆå¹¶å•å…ƒæ ¼è¢«æ­£ç¡®å¤„ç†
4. **æ‰§è¡Œæ•°æ®å¯¼å…¥**ï¼šéªŒè¯å¯¼å…¥ç»“æœæ­£ç¡®

### 2. è¾¹ç•Œæµ‹è¯•

1. **ç©ºåˆå¹¶å•å…ƒæ ¼**ï¼šæµ‹è¯•ç©ºåˆå¹¶å•å…ƒæ ¼çš„å¤„ç†
2. **è·¨è¡Œè·¨åˆ—åˆå¹¶**ï¼šæµ‹è¯•å¤æ‚çš„åˆå¹¶å•å…ƒæ ¼
3. **åµŒå¥—åˆå¹¶å•å…ƒæ ¼**ï¼šæµ‹è¯•åµŒå¥—çš„åˆå¹¶å•å…ƒæ ¼
4. **å¤§æ–‡ä»¶æµ‹è¯•**ï¼šæµ‹è¯•å¤§æ–‡ä»¶çš„å¤„ç†æ€§èƒ½

### 3. æ€§èƒ½æµ‹è¯•

1. **å¤§æ–‡ä»¶å¤„ç†**ï¼šæµ‹è¯•å¤§Excelæ–‡ä»¶çš„å¤„ç†æ€§èƒ½
2. **å¤§é‡åˆå¹¶å•å…ƒæ ¼**ï¼šæµ‹è¯•åŒ…å«å¤§é‡åˆå¹¶å•å…ƒæ ¼çš„æ–‡ä»¶
3. **å†…å­˜ä½¿ç”¨**ï¼šç›‘æ§å†…å­˜ä½¿ç”¨æƒ…å†µ
4. **å¤„ç†æ—¶é—´**ï¼šæµ‹é‡å¤„ç†æ—¶é—´

## å…¼å®¹æ€§

### 1. æ–‡ä»¶æ ¼å¼æ”¯æŒ

- âœ… .xlsx æ ¼å¼
- âœ… .xls æ ¼å¼
- âœ… åŒ…å«åˆå¹¶å•å…ƒæ ¼çš„æ–‡ä»¶
- âœ… å¤æ‚çš„åˆå¹¶å•å…ƒæ ¼ç»“æ„

### 2. EPPlusç‰ˆæœ¬å…¼å®¹

- âœ… EPPlus 5.x
- âœ… EPPlus 6.x
- âœ… ä¸åŒç‰ˆæœ¬çš„åˆå¹¶å•å…ƒæ ¼API

### 3. å‘åå…¼å®¹

- âœ… ä¿æŒä¸ç°æœ‰åŠŸèƒ½çš„å…¼å®¹æ€§
- âœ… ä¸å½±å“å…¶ä»–æ‰§è¡Œé€‰é¡¹
- âœ… ä¿æŒAPIæ¥å£ä¸å˜

## æ€»ç»“

é€šè¿‡è¿™æ¬¡å®Œæ•´çš„ä¿®å¤ï¼Œ"æ‹†åˆ†æ¯ä¸€è¡Œ"åŠŸèƒ½ç°åœ¨èƒ½å¤Ÿæ­£ç¡®å®ç°ï¼š

### ğŸ¯ æ ¸å¿ƒæ”¹è¿›

1. **æ­£ç¡®çš„åˆå¹¶å•å…ƒæ ¼æ‹†åˆ†** - å°†åˆå¹¶å•å…ƒæ ¼çš„æ•°æ®æ‹†åˆ†æ˜¾ç¤ºåœ¨æ¯ä¸ªå•å…ƒæ ¼ä¸­
2. **å®Œæ•´çš„æ•°æ®ä¿ç•™** - ç¡®ä¿åˆå¹¶å•å…ƒæ ¼çš„æ•°æ®ä¸ä¼šä¸¢å¤±
3. **æ™ºèƒ½çš„å€¼å¡«å……** - è‡ªåŠ¨å°†åˆå¹¶å•å…ƒæ ¼çš„å€¼å¡«å……åˆ°æ¯ä¸ªå•å…ƒæ ¼
4. **é«˜æ•ˆçš„å¤„ç†ç®—æ³•** - ä¼˜åŒ–çš„åˆå¹¶å•å…ƒæ ¼æ£€æµ‹å’Œå¤„ç†ç®—æ³•

### ğŸš€ æŠ€æœ¯ç‰¹ç‚¹

1. **åŒé‡å®ç°** - åœ¨DataImportServiceå’ŒOptimizedDataImportServiceä¸­éƒ½å®ç°äº†å®Œæ•´åŠŸèƒ½
2. **æ€§èƒ½ä¼˜åŒ–** - é«˜æ•ˆçš„ç®—æ³•å’Œå†…å­˜ç®¡ç†
3. **é”™è¯¯å¤„ç†** - å®Œå–„çš„å¼‚å¸¸å¤„ç†å’Œè¾¹ç•Œæ£€æŸ¥
4. **å…¼å®¹æ€§** - æ”¯æŒå„ç§Excelæ ¼å¼å’Œåˆå¹¶å•å…ƒæ ¼ç»“æ„

### âœ… ç”¨æˆ·ä½“éªŒ

1. **ç›´è§‚çš„æ•°æ®é¢„è§ˆ** - ç”¨æˆ·å¯ä»¥çœ‹åˆ°å®Œæ•´çš„åˆå¹¶å•å…ƒæ ¼æ•°æ®
2. **æ­£ç¡®çš„æ•°æ®å¯¼å…¥** - å¯¼å…¥çš„æ•°æ®åŒ…å«å®Œæ•´çš„åˆå¹¶å•å…ƒæ ¼ä¿¡æ¯
3. **çµæ´»çš„å¤„ç†é€‰é¡¹** - æ”¯æŒå„ç§åˆå¹¶å•å…ƒæ ¼çš„å¤„ç†éœ€æ±‚

è¿™ä¸ªä¿®å¤ç¡®ä¿äº†ç”¨æˆ·åœ¨å¯ç”¨"æ‹†åˆ†æ¯ä¸€è¡Œ"é€‰é¡¹æ—¶ï¼Œèƒ½å¤Ÿçœ‹åˆ°åˆå¹¶å•å…ƒæ ¼çš„å®Œæ•´å†…å®¹ï¼Œæ¯ä¸ªå•å…ƒæ ¼éƒ½æ˜¾ç¤ºæ­£ç¡®çš„æ•°æ®ï¼Œå®Œå…¨ç¬¦åˆç”¨æˆ·çš„éœ€æ±‚å’Œé¢„æœŸã€‚ 