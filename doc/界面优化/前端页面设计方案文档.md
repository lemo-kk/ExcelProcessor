# Excel Processor 前端页面设计方案文档

## 1. 项目概述

Excel Processor 是一个基于 WPF 的桌面应用程序，采用 Material Design 设计风格，提供专业的 Excel 数据处理功能。应用程序采用 MVVM 架构模式，具有现代化的用户界面和丰富的交互功能。

### 1.1 技术栈
- **前端框架**: WPF (Windows Presentation Foundation)
- **设计风格**: Material Design
- **架构模式**: MVVM (Model-View-ViewModel)
- **UI组件库**: MaterialDesignInXamlToolkit
- **数据库**: SQLite

### 1.2 设计主题
- **主色调**: 深蓝色 (#1E3A8A)
- **辅助色**: 青色 (#00E5FF)
- **背景色**: 深灰色 (#1A1A1A)
- **文字色**: 白色 (#FFFFFF)
- **强调色**: 紫色 (#8B5CF6)

## 2. 页面结构设计

### 2.1 主窗口 (MainWindow)
主窗口采用顶部导航栏 + 内容区域的布局设计。

#### 2.1.1 顶部导航栏
**位置**: 窗口顶部，高度65px
**背景**: 深蓝色渐变
**功能**: 提供主要功能模块的快速导航

**导航按钮列表**:
1. **首页** (HomeButton)
   - 样式: CompactActiveNavigationButtonStyle
   - 功能: 导航到首页
   - 点击事件: NavigationButton_Click

2. **Excel配置** (ExcelImportButton)
   - 样式: CompactNavigationButtonStyle
   - 功能: 导航到Excel导入配置页面
   - 点击事件: NavigationButton_Click

3. **SQL管理** (SqlManagementButton)
   - 样式: CompactNavigationButtonStyle
   - 功能: 导航到SQL管理页面
   - 点击事件: NavigationButton_Click

4. **作业管理** (JobManagementButton)
   - 样式: CompactNavigationButtonStyle
   - 功能: 导航到作业管理页面
   - 点击事件: NavigationButton_Click

5. **数据源** (DataSourceButton)
   - 样式: CompactNavigationButtonStyle
   - 功能: 导航到数据源管理页面
   - 点击事件: NavigationButton_Click

6. **导入导出** (ImportExportButton)
   - 样式: CompactNavigationButtonStyle
   - 功能: 导航到导入导出页面
   - 点击事件: NavigationButton_Click

7. **系统设置** (SystemSettingsButton)
   - 样式: CompactNavigationButtonStyle
   - 功能: 导航到系统设置页面
   - 点击事件: NavigationButton_Click

#### 2.1.2 右侧状态栏
**位置**: 顶部导航栏右侧
**功能**: 显示用户登录状态和系统信息

## 3. 详细页面设计

### 3.1 登录窗口 (LoginWindow)

#### 3.1.1 窗口属性
- **尺寸**: 400x500px
- **位置**: 屏幕中央
- **可调整大小**: 否
- **背景**: MaterialDesignPaper

#### 3.1.2 界面元素

**Logo和标题区域**:
- Excel图标 (64x64px)
- 应用名称: "Excel Processor"
- 副标题: "数据处理工具"

**登录表单**:
1. **用户名输入框** (UsernameTextBox)
   - 样式: LoginInputStyle
   - 提示文本: "用户名"
   - 数据绑定: Username属性
   - 键盘事件: UsernameTextBox_KeyDown (Enter键跳转到密码框)

2. **密码输入框** (PasswordBox)
   - 样式: LoginPasswordStyle
   - 提示文本: "密码"
   - 键盘事件: PasswordBox_KeyDown (Enter键执行登录)

3. **记住密码复选框** (RememberPasswordCheckBox)
   - 样式: MaterialDesignCheckBox
   - 文本: "记住密码"
   - 数据绑定: RememberPassword属性

4. **登录按钮** (LoginButton)
   - 样式: LoginButtonStyle
   - 文本: "登录"
   - 点击事件: LoginButton_Click
   - 启用状态: 绑定IsFormValid属性

5. **取消按钮** (CancelButton)
   - 样式: MaterialDesignOutlinedButton
   - 文本: "取消"
   - 点击事件: CancelButton_Click

**状态信息**:
- 状态文本 (StatusTextBlock)
  - 数据绑定: StatusMessage属性
  - 颜色绑定: StatusColor属性

**底部信息**:
- 版本信息: "版本 1.0.0"
- 版权信息: "© 2024 Excel Processor. All rights reserved."

#### 3.1.3 按钮功能详解

**登录按钮 (LoginButton_Click)**:
1. 验证表单完整性
2. 禁用登录按钮，显示"登录中..."
3. 显示状态信息"正在验证用户信息..."
4. 调用AuthenticateUser方法验证用户
5. 验证成功:
   - 保存用户信息到LoggedInUser属性
   - 显示"登录成功！"
   - 如果勾选记住密码，保存登录凭据
   - 设置DialogResult为true并关闭窗口
6. 验证失败:
   - 显示"用户名或密码错误"
   - 清空密码框并聚焦
7. 恢复登录按钮状态

**取消按钮 (CancelButton_Click)**:
1. 设置DialogResult为false
2. 关闭登录窗口

### 3.2 首页 (HomePage)

#### 3.2.1 页面布局
- **背景**: 透明
- **滚动**: 垂直滚动条自动显示
- **边距**: 20px

#### 3.2.2 界面元素

**欢迎标题区域**:
- 背景: 深蓝色渐变
- 圆角: 8px
- 阴影效果: MaterialDesignElevationShadow2
- 标题: "欢迎使用 Excel Processor"
- 副标题: "专业的Excel数据处理工具"

**快捷入口卡片区域**:
1. **Excel导入卡片**
   - 图标: FileExcel (48x48px)
   - 标题: "Excel导入配置"
   - 描述: "配置Excel文件导入规则和映射关系"
   - 悬停效果: 背景色变化 + 阴影效果
   - 点击功能: 导航到Excel导入配置页面

2. **作业配置卡片**
   - 图标: PlayCircle (48x48px)
   - 标题: "作业配置"
   - 描述: "创建和管理数据处理作业流程"
   - 悬停效果: 背景色变化 + 阴影效果
   - 点击功能: 导航到作业管理页面

**最近执行任务区域**:
- 标题: "最近执行任务"
- 数据表格 (RecentTasksDataGrid)
  - 列: 作业名称、执行时间、状态、操作
  - 操作按钮: 查看、重新执行
  - 高度: 200px

**系统资源统计区域**:
1. **SQLite数据库大小卡片**
   - 图标: Database (32x32px)
   - 标题: "SQLite数据库"
   - 数值: "2.5 MB"

2. **配置任务数量卡片**
   - 图标: PlayCircle (32x32px)
   - 标题: "配置任务"
   - 数值: "12 个"

3. **总执行次数卡片**
   - 图标: ChartLine (32x32px)
   - 标题: "总执行次数"
   - 数值: "156 次"

### 3.3 Excel导入配置页面 (ExcelImportPage)

#### 3.3.1 页面布局
- **顶部**: 标题和操作按钮区域
- **主体**: 配置列表表格
- **底部**: 操作提示区域

#### 3.3.2 顶部操作区域

**标题区域**:
- 标题: "Excel导入配置管理"

**操作按钮区域**:
1. **新建配置按钮** (NewConfigButton)
   - 样式: PrimaryButtonStyle
   - 图标: Plus (16x16px)
   - 文本: "新建配置"
   - 点击事件: NewConfigButton_Click
   - 功能: 打开新建配置对话框

2. **批量删除按钮** (BatchDeleteButton)
   - 样式: DangerButtonStyle
   - 文本: "批量删除"
   - 点击事件: BatchDeleteButton_Click
   - 功能: 删除选中的配置项

#### 3.3.3 配置列表表格 (ExcelConfigDataGrid)

**表格属性**:
- 样式: CustomDataGridStyle
- 选择模式: Extended (多选)
- 只读: 是
- 行高: 42px
- 交替行背景: #1E1E1E

**列定义**:
1. **选择列** (DataGridCheckBoxColumn)
   - 宽度: 50px
   - 绑定: IsSelected属性
   - 表头: 全选复选框
   - 点击事件: SelectAllCheckBox_Click

2. **配置名称列** (DataGridTextColumn)
   - 宽度: 15%
   - 绑定: ConfigName属性
   - 对齐: 左对齐
   - 文本截断: CharacterEllipsis

3. **Excel文件路径列** (DataGridTextColumn)
   - 宽度: 40%
   - 绑定: FilePath属性
   - 对齐: 左对齐
   - 文本截断: CharacterEllipsis

4. **目标数据源列** (DataGridTextColumn)
   - 宽度: 12%
   - 绑定: TargetDataSource属性
   - 对齐: 居中对齐

5. **Sheet名称列** (DataGridTextColumn)
   - 宽度: 10%
   - 绑定: SheetName属性
   - 对齐: 居中对齐

6. **标题行列** (DataGridTextColumn)
   - 宽度: 8%
   - 绑定: HeaderRow属性
   - 对齐: 居中对齐

7. **状态列** (DataGridTextColumn)
   - 宽度: 8%
   - 绑定: Status属性
   - 对齐: 居中对齐
   - 样式: 绿色背景 + 白色文字

8. **创建时间列** (DataGridTextColumn)
   - 宽度: 12%
   - 绑定: CreateTime属性
   - 对齐: 居中对齐
   - 字体大小: 10px

9. **操作列** (DataGridTemplateColumn)
   - 宽度: 15%
   - 按钮: 编辑、删除
   - 编辑按钮点击事件: EditButton_Click
   - 删除按钮点击事件: DeleteButton_Click

#### 3.3.4 按钮功能详解

**新建配置按钮 (NewConfigButton_Click)**:
1. 调用ShowConfigDialog方法
2. 传入null作为配置参数（表示新建）
3. 打开配置详情对话框

**批量删除按钮 (BatchDeleteButton_Click)**:
1. 调用BatchDeleteSelectedConfigs方法
2. 获取选中的配置项
3. 显示确认对话框
4. 批量删除选中的配置
5. 刷新配置列表

**全选复选框 (SelectAllCheckBox_Click)**:
1. 获取复选框的选中状态
2. 更新所有配置项的IsSelected属性
3. 刷新DataGrid显示

**编辑按钮 (EditButton_Click)**:
1. 获取按钮的DataContext（ExcelConfig对象）
2. 验证配置数据有效性
3. 调用ShowConfigDialog方法
4. 传入当前配置对象进行编辑

**删除按钮 (DeleteButton_Click)**:
1. 获取按钮的DataContext（ExcelConfig对象）
2. 显示确认删除对话框
3. 调用_excelConfigService.DeleteConfigAsync删除配置
4. 显示操作结果消息
5. 刷新配置列表

### 3.4 作业管理页面 (JobManagementPage)

#### 3.4.1 页面布局
- **顶部**: 标题和操作按钮
- **统计概览**: 作业统计信息
- **筛选区域**: 搜索和筛选控件
- **作业列表**: 作业卡片展示

#### 3.4.2 顶部操作区域

**标题区域**:
- 标题: "作业管理"
- 副标题: "管理和监控所有数据处理作业的执行状态"

**操作按钮区域**:
1. **刷新按钮** (RefreshButton)
   - 样式: ActionButtonStyle
   - 文本: "刷新"
   - 背景: #2A2A2A
   - 点击事件: RefreshButton_Click
   - 功能: 刷新作业数据

2. **新建作业按钮** (CreateJobButton)
   - 样式: ActionButtonStyle
   - 文本: "新建作业"
   - 背景: SuccessColor
   - 点击事件: CreateJobButton_Click
   - 功能: 打开新建作业对话框

#### 3.4.3 统计概览区域

**统计卡片**:
1. **总作业数卡片**
   - 标题: "总作业数"
   - 数值: 绑定TotalJobs属性
   - 描述: "所有作业配置"

2. **运行中作业卡片**
   - 标题: "运行中作业"
   - 数值: 绑定RunningJobs属性
   - 描述: "正在执行的作业"

3. **已完成作业卡片**
   - 标题: "已完成作业"
   - 数值: 绑定CompletedJobs属性
   - 描述: "成功完成的作业"

4. **失败作业卡片**
   - 标题: "失败作业"
   - 数值: 绑定FailedJobs属性
   - 描述: "执行失败的作业"

#### 3.4.4 按钮功能详解

**刷新按钮 (RefreshButton_Click)**:
1. 调用_viewModel?.RefreshCommand.Execute(null)
2. 刷新作业数据和统计信息

**新建作业按钮 (CreateJobButton_Click)**:
1. 创建JobEditDialog对话框
2. 设置对话框所有者为主窗口
3. 显示对话框
4. 如果对话框返回true且IsSaved为true:
   - 调用_viewModel?.CreateJobAsync(dialog.JobConfig)创建作业

**编辑作业按钮 (EditJobButton_Click)**:
1. 获取按钮的Tag属性（作业ID）
2. 从ViewModel中查找对应的作业配置
3. 创建JobEditDialog对话框并传入作业配置
4. 显示对话框
5. 如果对话框返回true且IsSaved为true:
   - 调用_viewModel?.EditJobAsync(dialog.JobConfig)更新作业

**清除筛选按钮 (ClearFiltersButton_Click)**:
1. 调用_viewModel?.ClearFiltersCommand.Execute(null)
2. 清空搜索框文本
3. 重置所有筛选下拉框到默认状态

**执行作业按钮 (ExecuteJob_Click)**:
1. 获取按钮的DataContext（JobConfig对象）
2. 调用_viewModel?.ExecuteJobCommand.Execute(job)执行作业

**暂停作业按钮 (PauseJob_Click)**:
1. 获取按钮的DataContext（JobConfig对象）
2. 调用_viewModel?.PauseJobCommand.Execute(job)暂停作业

### 3.5 数据源管理页面 (DataSourcePage)

#### 3.5.1 页面布局
- **顶部**: 标题和操作按钮
- **搜索区域**: 搜索框和筛选控件
- **数据源列表**: 数据源表格

#### 3.5.2 顶部操作区域

**标题区域**:
- 标题: "数据源管理"
- 副标题: "管理系统中的数据源连接配置，支持多种数据库类型"

**操作按钮区域**:
1. **刷新按钮** (RefreshButton)
   - 样式: SecondaryButtonStyle
   - 图标: Refresh (14x14px)
   - 文本: "刷新"
   - 点击事件: RefreshButton_Click
   - 功能: 刷新数据源列表

2. **添加数据源按钮** (AddDataSourceButton)
   - 样式: PrimaryButtonStyle
   - 图标: Plus (14x14px)
   - 文本: "添加数据源"
   - 点击事件: AddDataSourceButton_Click
   - 功能: 打开添加数据源对话框

#### 3.5.3 搜索区域

**搜索框** (SearchTextBox):
- 样式: DataSourceTextBoxStyle
- 提示文本: "输入关键词搜索数据源（名称、类型、描述）"
- 事件: SearchTextBox_TextChanged
- 功能: 实时搜索数据源

**清除搜索按钮** (ClearSearchButton):
- 样式: MaterialDesignIconButton
- 功能: 清空搜索框内容

### 3.6 系统设置页面 (SystemSettingsPage)

#### 3.6.1 页面布局
- **滚动视图**: 垂直滚动，水平禁用
- **内边距**: 24px
- **分组布局**: 多个设置组

#### 3.6.2 设置分组

**自动保存设置组**:
1. **启用自动保存复选框** (AutoSaveCheckBox)
   - 绑定: AutoSaveEnabled属性
   - 文本: "启用自动保存"

2. **自动保存间隔输入框** (AutoSaveIntervalTextBox)
   - 绑定: AutoSaveInterval属性
   - 标签: "自动保存间隔（分钟）"
   - 启用状态: 绑定AutoSaveIntervalEnabled属性

**启动设置组**:
1. **启动时最小化复选框** (StartupMinimizeCheckBox)
   - 绑定: StartupMinimize属性
   - 文本: "启动时最小化到系统托盘"

2. **检查更新复选框** (CheckForUpdatesCheckBox)
   - 绑定: CheckForUpdates属性
   - 文本: "启动时检查更新"

3. **立即检查更新按钮** (CheckForUpdatesButton)
   - 样式: ConfigButtonStyle
   - 文本: "立即检查更新"
   - 点击事件: CheckForUpdatesButton_Click

**日志设置组**:
1. **启用日志记录复选框** (EnableLoggingCheckBox)
   - 绑定: EnableLogging属性
   - 文本: "启用日志记录"

2. **日志级别下拉框** (LogLevelComboBox)
   - 绑定: LogLevel属性
   - 标签: "日志级别"
   - 启用状态: 绑定LogLevelEnabled属性

3. **打开日志文件夹按钮** (OpenLogFolderButton)
   - 样式: ConfigButtonStyle
   - 文本: "打开日志文件夹"
   - 点击事件: OpenLogFolderButton_Click

4. **清除日志按钮** (ClearLogsButton)
   - 样式: ConfigButtonStyle
   - 文本: "清除日志"
   - 点击事件: ClearLogsButton_Click

#### 3.6.3 按钮功能详解

**立即检查更新按钮 (CheckForUpdatesButton_Click)**:
1. 调用系统更新检查服务
2. 显示检查结果

**打开日志文件夹按钮 (OpenLogFolderButton_Click)**:
1. 获取日志文件夹路径
2. 使用系统默认程序打开文件夹

**清除日志按钮 (ClearLogsButton_Click)**:
1. 显示确认对话框
2. 删除所有日志文件
3. 显示操作结果

## 4. 交互设计规范

### 4.1 按钮交互规范

**主要按钮 (PrimaryButtonStyle)**:
- 背景色: CyberBlue (#00E5FF)
- 前景色: 白色
- 悬停效果: 背景色变亮
- 点击效果: 背景色变暗

**次要按钮 (SecondaryButtonStyle)**:
- 背景色: 透明
- 前景色: #CCCCCC
- 边框: 1px #555555
- 悬停效果: 背景色变为#2A2A2A

**危险按钮 (DangerButtonStyle)**:
- 背景色: #DC2626
- 前景色: 白色
- 悬停效果: 背景色变亮

**图标按钮 (MaterialDesignIconButton)**:
- 背景色: 透明
- 前景色: #CCCCCC
- 悬停效果: 背景色变为#2A2A2A

### 4.2 输入框交互规范

**文本输入框**:
- 背景色: #2A2A2A
- 前景色: 白色
- 边框色: #555555
- 聚焦效果: 边框色变为CyberBlue，添加阴影效果

**密码输入框**:
- 样式与文本输入框相同
- 支持显示/隐藏密码功能

**下拉框**:
- 背景色: #2A2A2A
- 前景色: 白色
- 边框色: #555555
- 聚焦效果: 边框色变为CyberBlue

### 4.3 表格交互规范

**DataGrid样式**:
- 背景色: #1A1A1A
- 表头背景: #2A2A2A
- 行背景: #1A1A1A
- 交替行背景: #1E1E1E
- 选中行背景: CyberBlue (#00E5FF)
- 悬停行背景: #2A2A2A

**表格操作**:
- 支持排序
- 支持多选
- 支持列宽调整
- 支持水平滚动

### 4.4 对话框交互规范

**模态对话框**:
- 背景遮罩: 半透明黑色
- 对话框背景: #2A2A2A
- 圆角: 8px
- 阴影效果: MaterialDesignElevationShadow4

**对话框按钮**:
- 确认按钮: 主要按钮样式
- 取消按钮: 次要按钮样式
- 按钮间距: 8px

## 5. 响应式设计

### 5.1 窗口尺寸适配

**最小尺寸**:
- 宽度: 900px
- 高度: 600px

**默认尺寸**:
- 宽度: 1200px
- 高度: 1000px

**最大尺寸**:
- 宽度: 屏幕宽度
- 高度: 屏幕高度

### 5.2 布局适配

**导航栏适配**:
- 小屏幕: 显示紧凑导航按钮
- 大屏幕: 显示完整导航按钮

**表格适配**:
- 列宽使用百分比和最小/最大宽度限制
- 支持水平滚动
- 文本截断显示完整内容

**卡片布局适配**:
- 小屏幕: 单列布局
- 大屏幕: 多列布局

## 6. 性能优化

### 6.1 UI性能优化

**虚拟化**:
- DataGrid启用行虚拟化
- DataGrid启用列虚拟化
- 滚动视图启用虚拟化

**动画优化**:
- 使用硬件加速
- 限制同时运行的动画数量
- 使用缓动函数优化动画效果

### 6.2 数据加载优化

**异步加载**:
- 所有数据操作使用异步方法
- 显示加载指示器
- 支持取消操作

**分页加载**:
- 大数据集使用分页加载
- 支持无限滚动
- 缓存已加载数据

## 7. 错误处理

### 7.1 用户友好的错误提示

**错误消息框**:
- 使用MessageBox显示错误信息
- 提供详细的错误描述
- 建议解决方案

**状态栏提示**:
- 实时显示操作状态
- 使用不同颜色区分状态类型
- 自动清除过期的状态信息

### 7.2 异常处理

**网络异常**:
- 检测网络连接状态
- 提供重试机制
- 显示离线模式提示

**数据异常**:
- 验证数据完整性
- 提供数据修复建议
- 支持数据回滚

## 8. 可访问性设计

### 8.1 键盘导航

**Tab键导航**:
- 所有可交互元素支持Tab键导航
- 合理的Tab键顺序
- 清晰的焦点指示器

**快捷键支持**:
- Ctrl+S: 保存
- Ctrl+Z: 撤销
- Ctrl+Y: 重做
- F5: 刷新
- Esc: 取消/关闭

### 8.2 屏幕阅读器支持

**语义化标签**:
- 使用适当的控件类型
- 提供有意义的名称
- 设置正确的角色和状态

**替代文本**:
- 为图标提供文本描述
- 为图片提供替代文本
- 为装饰性元素设置隐藏属性

## 9. 国际化支持

### 9.1 多语言支持

**文本资源**:
- 所有用户界面文本使用资源文件
- 支持动态语言切换
- 提供语言包管理

**日期时间格式**:
- 根据系统区域设置显示日期时间
- 支持多种日期时间格式
- 提供格式自定义选项

### 9.2 本地化适配

**数字格式**:
- 根据地区设置显示数字格式
- 支持千分位分隔符
- 支持不同的小数位数

**货币格式**:
- 根据地区设置显示货币符号
- 支持不同货币格式
- 提供货币转换功能

## 10. 总结

本设计方案详细描述了Excel Processor应用程序的前端页面设计，包括：

1. **完整的页面结构**: 从主窗口到各个功能页面的详细布局
2. **详细的按钮功能**: 每个按钮的点击事件和具体功能实现
3. **交互设计规范**: 统一的用户交互体验标准
4. **响应式设计**: 适配不同屏幕尺寸的布局方案
5. **性能优化**: 提升用户体验的性能优化措施
6. **错误处理**: 完善的异常处理和用户提示机制
7. **可访问性**: 支持键盘导航和屏幕阅读器
8. **国际化**: 多语言和本地化支持

该设计方案确保了应用程序具有现代化、专业化的用户界面，提供了良好的用户体验和高效的数据处理功能。 