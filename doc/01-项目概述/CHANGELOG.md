# 变更日志

## [v1.0] - 2024-01-16

### 🎉 新增功能

#### SQL功能增强
- **自动创建目标表功能**
  - 当输出表不存在时，系统自动根据SQL查询结果创建表结构
  - 支持智能表结构推断和数据插入
  - 提供完整的错误处理和用户反馈

- **SqlConfigs表字段扩展**
  - 新增 `OutputDataSourceId` 字段：为Excel工作表输出指定独立数据源
  - 新增 `ClearSheetBeforeOutput` 字段：控制是否在输出前清空Excel工作表

- **用户界面增强**
  - 添加输出数据源选择控件
  - 添加清空Sheet页选项控件
  - 实现动态显示/隐藏功能
  - 优化界面布局和用户体验

### 🔧 技术改进

#### 数据模型更新
- **SqlConfig模型扩展**
  - 添加 `OutputDataSourceId` 属性
  - 添加 `ClearSheetBeforeOutput` 属性
  - 更新所有相关的CRUD操作

#### 数据库架构更新
- **SqlConfigs表结构扩展**
  - 添加 `OutputDataSourceId TEXT` 字段
  - 添加 `ClearSheetBeforeOutput INTEGER NOT NULL DEFAULT 0` 字段
  - 保持向后兼容性

#### 服务层增强
- **SqlService功能增强**
  - 实现自动表创建逻辑
  - 添加表存在性检查
  - 优化数据插入性能
  - 完善错误处理机制

#### 用户界面改进
- **SqlManagementPage更新**
  - 新增输出数据源选择面板
  - 新增清空Sheet页选项面板
  - 实现动态控件显示控制
  - 优化数据加载和保存逻辑

### 🐛 问题修复

#### 编译错误修复
- 修复XAML控件重复定义错误
- 解决ProgressDialog构造函数冲突
- 修复缺少引用错误
- 清理编译缓存问题

#### 运行时错误修复
- 修复数据库连接字符串传递问题
- 完善异步操作异常处理
- 优化用户反馈机制

### 📊 性能优化

- 优化批量数据处理性能
- 改进内存使用效率
- 增强数据库连接池管理
- 提升用户界面响应速度

### 🧪 测试验证

- 完成自动创建表功能测试
- 验证输出数据源配置功能
- 测试清空Sheet页选项
- 通过界面交互测试
- 完成性能压力测试

### 📚 文档更新

- 创建SQL功能增强实现报告
- 更新项目统计信息
- 完善技术文档
- 添加用户使用指南

### 🔄 向后兼容性

- 保持现有数据库结构兼容
- 维护现有API接口
- 确保用户配置不丢失
- 支持平滑升级

---

## [v0.9] - 2024-01-15

### 🎉 新增功能
- 基础SQL功能实现
- 用户权限管理系统
- Excel处理核心功能

### 🔧 技术改进
- 实现MVVM架构
- 集成Material Design UI
- 建立数据库连接

### 🐛 问题修复
- 修复基础界面问题
- 解决数据绑定错误
- 完善错误处理机制

---

## [v0.8] - 2024-01-14

### 🎉 新增功能
- 项目基础架构搭建
- 核心数据模型定义
- 基础UI框架实现

### 🔧 技术改进
- 建立项目结构
- 配置开发环境
- 设置构建系统

---

**注意**: 此变更日志遵循[语义化版本控制](https://semver.org/lang/zh-CN/)规范。 