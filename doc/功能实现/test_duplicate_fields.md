# 重复字段名处理功能测试

## 测试场景

### 场景1：Excel点击导入时的第一次映射

**测试步骤**：
1. 启动ExcelProcessor应用程序
2. 导航到Excel导入配置页面
3. 选择一个包含重复列名的Excel文件
4. 点击"浏览"按钮选择文件
5. 观察字段映射配置表格中的数据库字段名

**预期结果**：
- 重复的Excel列名应该生成不同的数据库字段名
- 第一个重复字段保持原名
- 后续重复字段添加 `_1`、`_2` 等后缀

### 场景2：选择标题行时的自动映射

**测试步骤**：
1. 在Excel导入配置页面选择Excel文件
2. 修改标题行号（例如从1改为2）
3. 观察字段映射配置表格的更新
4. 检查重复字段名是否正确处理

**预期结果**：
- 标题行变化时字段映射自动更新
- 重复字段名自动添加后缀
- 调试日志显示处理过程

## 测试用例

### 用例1：相同列名
**Excel列名**：
- 客户名称
- 客户名称
- 客户名称

**预期数据库字段名**：
- customer_name
- customer_name_1
- customer_name_2

### 用例2：混合重复
**Excel列名**：
- 客户编号
- 客户名称
- 客户编号
- 联系电话
- 客户名称

**预期数据库字段名**：
- customer_id
- customer_name
- customer_id_1
- phone
- customer_name_1

### 用例3：中文列名
**Excel列名**：
- 姓名
- 姓名
- 部门
- 部门

**预期数据库字段名**：
- name
- name_1
- department
- department_1

## 验证要点

1. **前端处理**：字段映射表格显示正确的数据库字段名
2. **后端处理**：数据导入时正确处理重复字段
3. **调试日志**：控制台输出详细的处理过程
4. **性能表现**：处理大量重复字段时性能良好
5. **用户体验**：自动处理，无需手动干预

## 测试数据准备

创建一个包含重复列名的Excel文件：
1. 使用Excel创建测试文件
2. 添加重复的列名
3. 填充一些测试数据
4. 保存为.xlsx格式

## 注意事项

1. 确保Excel文件格式正确
2. 检查调试日志输出
3. 验证字段映射的完整性
4. 测试不同数量的重复字段
5. 验证特殊字符的处理 