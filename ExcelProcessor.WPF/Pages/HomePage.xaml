<?xml version="1.0" encoding="utf-8"?>
<Page x:Class="ExcelProcessor.WPF.Pages.HomePage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
      Title="首页"
      Background="Transparent">

    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <StackPanel Margin="20">
            
            <!-- 欢迎标题 -->
            <Border Background="{StaticResource DarkBlueBrush}"
                    CornerRadius="8"
                    Padding="24,16"
                    Margin="0,0,0,20"
                    Effect="{StaticResource MaterialDesignElevationShadow2}">
                <StackPanel>
                    <TextBlock Text="欢迎使用 Excel Processor" 
                             FontSize="24" 
                             FontWeight="Bold"
                             Foreground="White"
                             HorizontalAlignment="Center" />
                    <TextBlock Text="专业的Excel数据处理工具" 
                             FontSize="14"
                             Foreground="#CCCCCC"
                             HorizontalAlignment="Center"
                             Margin="0,8,0,0" />
                </StackPanel>
            </Border>

            <!-- 快捷入口卡片 -->
            <TextBlock Text="快捷入口" 
                     FontSize="18" 
                     FontWeight="SemiBold"
                     Foreground="{StaticResource CyberBlueBrush}"
                     Margin="0,0,0,16" />

            <Grid Margin="0,0,0,20">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>

                <!-- Excel导入卡片 -->
                <Border Grid.Column="0" 
                        Background="#2A2A2A"
                        CornerRadius="8"
                        Margin="4,0,4,0"
                        Cursor="Hand"
                        Effect="{StaticResource MaterialDesignElevationShadow1}">
                    <Border.Style>
                        <Style TargetType="Border">
                            <Style.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Background" Value="#3A3A3A" />
                                    <Setter Property="Effect">
                                        <Setter.Value>
                                            <DropShadowEffect Color="{StaticResource CyberBlue}" BlurRadius="10" ShadowDepth="0" Opacity="0.3" />
                                        </Setter.Value>
                                    </Setter>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </Border.Style>
                    
                    <StackPanel Margin="20" HorizontalAlignment="Center">
                        <materialDesign:PackIcon Kind="FileExcel" 
                                               Width="48" 
                                               Height="48"
                                               Foreground="{StaticResource CyberBlueBrush}"
                                               HorizontalAlignment="Center" />
                        <TextBlock Text="Excel导入配置" 
                                 FontSize="16" 
                                 FontWeight="SemiBold"
                                 Foreground="White"
                                 HorizontalAlignment="Center"
                                 Margin="0,12,0,8" />
                        <TextBlock Text="配置Excel文件导入规则和映射关系" 
                                 FontSize="12"
                                 Foreground="#CCCCCC"
                                 HorizontalAlignment="Center"
                                 TextWrapping="Wrap" />
                    </StackPanel>
                </Border>



                <!-- 作业配置卡片 -->
                <Border Grid.Column="1" 
                        Background="#2A2A2A"
                        CornerRadius="8"
                        Margin="4,0,4,0"
                        Cursor="Hand"
                        Effect="{StaticResource MaterialDesignElevationShadow1}">
                    <Border.Style>
                        <Style TargetType="Border">
                            <Style.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Background" Value="#3A3A3A" />
                                    <Setter Property="Effect">
                                        <Setter.Value>
                                            <DropShadowEffect Color="{StaticResource CyberBlue}" BlurRadius="10" ShadowDepth="0" Opacity="0.3" />
                                        </Setter.Value>
                                    </Setter>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </Border.Style>
                    
                    <StackPanel Margin="20" HorizontalAlignment="Center">
                        <materialDesign:PackIcon Kind="PlayCircle" 
                                               Width="48" 
                                               Height="48"
                                               Foreground="{StaticResource HighlightPurpleBrush}"
                                               HorizontalAlignment="Center" />
                        <TextBlock Text="作业配置" 
                                 FontSize="16" 
                                 FontWeight="SemiBold"
                                 Foreground="White"
                                 HorizontalAlignment="Center"
                                 Margin="0,12,0,8" />
                        <TextBlock Text="创建和管理数据处理作业流程" 
                                 FontSize="12"
                                 Foreground="#CCCCCC"
                                 HorizontalAlignment="Center"
                                 TextWrapping="Wrap" />
                    </StackPanel>
                </Border>
            </Grid>

            <!-- 最近执行任务 -->
            <TextBlock Text="最近执行任务" 
                     FontSize="18" 
                     FontWeight="SemiBold"
                     Foreground="{StaticResource CyberBlueBrush}"
                     Margin="0,0,0,16" />

            <Border Background="#2A2A2A"
                    CornerRadius="8"
                    Padding="20"
                    Margin="0,0,0,20"
                    Effect="{StaticResource MaterialDesignElevationShadow1}">
                
                <DataGrid x:Name="RecentTasksDataGrid"
                         Style="{StaticResource CustomDataGridStyle}"
                         ColumnHeaderStyle="{StaticResource CustomDataGridColumnHeaderStyle}"
                         CellStyle="{StaticResource CustomDataGridCellStyle}"
                         RowStyle="{StaticResource CustomDataGridRowStyle}"
                         Height="200"
                         AutoGenerateColumns="False"
                         IsReadOnly="True">
                    
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="作业名称" Binding="{Binding JobName}" Width="*" />
                        <DataGridTextColumn Header="执行时间" Binding="{Binding ExecuteTime}" Width="150" />
                        <DataGridTextColumn Header="状态" Binding="{Binding Status}" Width="100">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="HorizontalAlignment" Value="Center" />
                                    <Setter Property="VerticalAlignment" Value="Center" />
                                    <Setter Property="Padding" Value="8,4" />
                                    <Setter Property="Background" Value="#333333" />
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>
                        <DataGridTemplateColumn Header="操作" Width="120">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <StackPanel Orientation="Horizontal">
                                        <Button Content="查看" 
                                                Style="{StaticResource SecondaryButtonStyle}"
                                                Padding="8,4"
                                                FontSize="11" />
                                        <Button Content="重新执行" 
                                                Style="{StaticResource PrimaryButtonStyle}"
                                                Padding="8,4"
                                                FontSize="11"
                                                Margin="4,0,0,0" />
                                    </StackPanel>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                    </DataGrid.Columns>
                </DataGrid>
            </Border>

            <!-- 系统资源统计 -->
            <TextBlock Text="系统资源" 
                     FontSize="18" 
                     FontWeight="SemiBold"
                     Foreground="{StaticResource CyberBlueBrush}"
                     Margin="0,0,0,16" />

            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>

                <!-- SQLite数据库大小 -->
                <Border Grid.Column="0" 
                        Background="#2A2A2A"
                        CornerRadius="8"
                        Margin="0,0,8,0"
                        Effect="{StaticResource MaterialDesignElevationShadow1}">
                    <StackPanel Margin="20" HorizontalAlignment="Center">
                        <materialDesign:PackIcon Kind="Database" 
                                               Width="32" 
                                               Height="32"
                                               Foreground="{StaticResource NeonGreenBrush}"
                                               HorizontalAlignment="Center" />
                        <TextBlock Text="SQLite数据库" 
                                 FontSize="14" 
                                 FontWeight="SemiBold"
                                 Foreground="White"
                                 HorizontalAlignment="Center"
                                 Margin="0,8,0,4" />
                        <TextBlock Text="2.5 MB" 
                                 FontSize="18" 
                                 FontWeight="Bold"
                                 Foreground="{StaticResource NeonGreenBrush}"
                                 HorizontalAlignment="Center" />
                    </StackPanel>
                </Border>

                <!-- 任务数量 -->
                <Border Grid.Column="1" 
                        Background="#2A2A2A"
                        CornerRadius="8"
                        Margin="4,0,4,0"
                        Effect="{StaticResource MaterialDesignElevationShadow1}">
                    <StackPanel Margin="20" HorizontalAlignment="Center">
                        <materialDesign:PackIcon Kind="PlayCircle" 
                                               Width="32" 
                                               Height="32"
                                               Foreground="{StaticResource HighlightPurpleBrush}"
                                               HorizontalAlignment="Center" />
                        <TextBlock Text="配置任务" 
                                 FontSize="14" 
                                 FontWeight="SemiBold"
                                 Foreground="White"
                                 HorizontalAlignment="Center"
                                 Margin="0,8,0,4" />
                        <TextBlock Text="12 个" 
                                 FontSize="18" 
                                 FontWeight="Bold"
                                 Foreground="{StaticResource HighlightPurpleBrush}"
                                 HorizontalAlignment="Center" />
                    </StackPanel>
                </Border>

                <!-- 执行次数 -->
                <Border Grid.Column="2" 
                        Background="#2A2A2A"
                        CornerRadius="8"
                        Margin="8,0,0,0"
                        Effect="{StaticResource MaterialDesignElevationShadow1}">
                    <StackPanel Margin="20" HorizontalAlignment="Center">
                        <materialDesign:PackIcon Kind="ChartLine" 
                                               Width="32" 
                                               Height="32"
                                               Foreground="{StaticResource CyberBlueBrush}"
                                               HorizontalAlignment="Center" />
                        <TextBlock Text="总执行次数" 
                                 FontSize="14" 
                                 FontWeight="SemiBold"
                                 Foreground="White"
                                 HorizontalAlignment="Center"
                                 Margin="0,8,0,4" />
                        <TextBlock Text="156 次" 
                                 FontSize="18" 
                                 FontWeight="Bold"
                                 Foreground="{StaticResource CyberBlueBrush}"
                                 HorizontalAlignment="Center"
                                 Margin="0,0,0,0" />
                    </StackPanel>
                </Border>
            </Grid>

        </StackPanel>
    </ScrollViewer>
</Page> 