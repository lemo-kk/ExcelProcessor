<?xml version="1.0" encoding="utf-8"?>
<Page x:Class="ExcelProcessor.WPF.Pages.SystemSettingsPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
      Title="系统设置"
      Background="Transparent">

    <Grid>
        <ScrollViewer VerticalScrollBarVisibility="Auto" 
                      HorizontalScrollBarVisibility="Disabled"
                      Padding="24">
            <StackPanel>
                <!-- 页面标题 -->
                <Border Style="{StaticResource ConfigGroupStyle}" Margin="0,0,0,24">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                            <materialDesign:PackIcon Kind="Cog" 
                                                   Width="24" 
                                                   Height="24" 
                                                   Foreground="{StaticResource CyberBlueBrush}"
                                                   VerticalAlignment="Center"
                                                   Margin="0,0,12,0" />
                            <TextBlock Text="系统设置" 
                                     Style="{StaticResource ConfigGroupTitleStyle}"
                                     FontSize="22" 
                                     VerticalAlignment="Center" />
                        </StackPanel>
                        <TextBlock Text="配置应用程序的系统级设置，包括自动保存、日志、主题等选项。"
                                 Foreground="#CCCCCC"
                                 FontSize="14"
                                 TextWrapping="Wrap"
                                 LineHeight="20" />
                    </StackPanel>
                </Border>

                <!-- 设置分类容器 -->
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="1*" />
                        <ColumnDefinition Width="20" />
                        <ColumnDefinition Width="1*" />
                    </Grid.ColumnDefinitions>

                    <!-- 左侧列：基础设置 -->
                    <StackPanel Grid.Column="0">
                        <!-- 基础设置分类 -->
                        <Border Style="{StaticResource ConfigGroupStyle}" Margin="0,0,0,20">
                            <StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                                    <materialDesign:PackIcon Kind="Settings" 
                                                           Width="20" 
                                                           Height="20" 
                                                           Foreground="{StaticResource NeonGreenBrush}"
                                                           VerticalAlignment="Center"
                                                           Margin="0,0,8,0" />
                                    <TextBlock Text="基础设置" 
                                             Style="{StaticResource ConfigGroupTitleStyle}" 
                                             VerticalAlignment="Center" />
                                </StackPanel>
                                
                                <Border Style="{StaticResource ConfigItemContainerStyle}">
                                    <StackPanel>
                                        <!-- 自动保存设置 -->
                                        <TextBlock Text="自动保存" 
                                                 Style="{StaticResource ConfigItemLabelStyle}"
                                                 FontWeight="Bold"
                                                 Margin="0,0,0,8" />
                                        
                                        <CheckBox x:Name="AutoSaveCheckBox"
                                                Content="启用自动保存"
                                                IsChecked="{Binding AutoSaveEnabled}"
                                                Style="{StaticResource ConfigCheckBoxStyle}" />
                                        
                                        <Grid Margin="0,12,0,16">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*" />
                                                <ColumnDefinition Width="Auto" />
                                            </Grid.ColumnDefinitions>
                                            
                                            <TextBlock Grid.Column="0"
                                                     Text="自动保存间隔（分钟）"
                                                     Style="{StaticResource ConfigItemLabelStyle}"
                                                     VerticalAlignment="Center"
                                                     IsEnabled="{Binding AutoSaveIntervalEnabled}" />
                                            
                                            <TextBox Grid.Column="1"
                                                   x:Name="AutoSaveIntervalTextBox"
                                                   Text="{Binding AutoSaveInterval}"
                                                   Style="{StaticResource ConfigInputStyle}"
                                                   Width="100"
                                                   VerticalAlignment="Center"
                                                   IsEnabled="{Binding AutoSaveIntervalEnabled}" />
                                        </Grid>

                                        <!-- 启动设置 -->
                                        <TextBlock Text="启动设置" 
                                                 Style="{StaticResource ConfigItemLabelStyle}"
                                                 FontWeight="Bold"
                                                 Margin="0,16,0,8" />
                                        
                                        <CheckBox x:Name="StartupMinimizeCheckBox"
                                                Content="启动时最小化到系统托盘"
                                                IsChecked="{Binding StartupMinimize}"
                                                Style="{StaticResource ConfigCheckBoxStyle}" />
                                        
                                        <CheckBox x:Name="CheckForUpdatesCheckBox"
                                                Content="启动时检查更新"
                                                IsChecked="{Binding CheckForUpdates}"
                                                Style="{StaticResource ConfigCheckBoxStyle}" />
                                        
                                        <Button x:Name="CheckForUpdatesButton"
                                              Content="立即检查更新"
                                              Style="{StaticResource ConfigButtonStyle}"
                                              Click="CheckForUpdatesButton_Click"
                                              HorizontalAlignment="Left"
                                              Margin="0,12,0,0" />
                                    </StackPanel>
                                </Border>
                            </StackPanel>
                        </Border>

                        <!-- 文件路径设置 -->
                        <Border Style="{StaticResource ConfigGroupStyle}" Margin="0,0,0,20">
                            <StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                                    <materialDesign:PackIcon Kind="Folder" 
                                                           Width="20" 
                                                           Height="20" 
                                                           Foreground="{StaticResource NeonGreenBrush}"
                                                           VerticalAlignment="Center"
                                                           Margin="0,0,8,0" />
                                    <TextBlock Text="文件路径设置" 
                                             Style="{StaticResource ConfigGroupTitleStyle}" 
                                             VerticalAlignment="Center" />
                                </StackPanel>
                                
                                <Border Style="{StaticResource ConfigItemContainerStyle}">
                                    <StackPanel>
                                        <CheckBox x:Name="UseRelativePathCheckBox"
                                                Content="使用相对路径"
                                                IsChecked="{Binding UseRelativePath}"
                                                Style="{StaticResource ConfigCheckBoxStyle}" />
                                        
                                        <TextBlock Text="启用后，Excel文件将使用相对于程序目录的路径"
                                                 Foreground="#888888"
                                                 FontSize="12"
                                                 TextWrapping="Wrap"
                                                 Margin="0,4,0,16" />
                                        
                                        <!-- 输入文件目录 -->
                                        <Grid Margin="0,0,0,12">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*" />
                                                <ColumnDefinition Width="Auto" />
                                            </Grid.ColumnDefinitions>
                                            
                                            <TextBlock Grid.Column="0"
                                                     Text="输入文件目录"
                                                     Style="{StaticResource ConfigItemLabelStyle}"
                                                     VerticalAlignment="Center" />
                                            
                                            <Button Grid.Column="1"
                                                  x:Name="BrowseInputPathButton"
                                                  Content="浏览"
                                                  Style="{StaticResource SecondaryButtonStyle}"
                                                  Padding="8,4"
                                                  FontSize="11"
                                                  VerticalAlignment="Center"
                                                  Click="BrowseInputPathButton_Click" />
                                        </Grid>
                                        
                                        <TextBox x:Name="InputPathTextBox"
                                               Text="{Binding InputPath}"
                                               Style="{StaticResource FilePathTextBoxStyle}"
                                               Margin="0,0,0,16"
                                               materialDesign:HintAssist.Hint="输入文件目录路径" />
                                        
                                        <!-- 输出文件目录 -->
                                        <Grid Margin="0,0,0,12">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*" />
                                                <ColumnDefinition Width="Auto" />
                                            </Grid.ColumnDefinitions>
                                            
                                            <TextBlock Grid.Column="0"
                                                     Text="输出文件目录"
                                                     Style="{StaticResource ConfigItemLabelStyle}"
                                                     VerticalAlignment="Center" />
                                            
                                            <Button Grid.Column="1"
                                                  x:Name="BrowseOutputPathButton"
                                                  Content="浏览"
                                                  Style="{StaticResource SecondaryButtonStyle}"
                                                  Padding="8,4"
                                                  FontSize="11"
                                                  VerticalAlignment="Center"
                                                  Click="BrowseOutputPathButton_Click" />
                                        </Grid>
                                        
                                        <TextBox x:Name="OutputPathTextBox"
                                               Text="{Binding OutputPath}"
                                               Style="{StaticResource FilePathTextBoxStyle}"
                                               Margin="0,0,0,16"
                                               materialDesign:HintAssist.Hint="输出文件目录路径" />
                                        
                                        <Button x:Name="CreateDefaultFoldersButton"
                                              Content="创建默认目录结构"
                                              Style="{StaticResource PrimaryButtonStyle}"
                                              Padding="12,6"
                                              FontSize="12"
                                              Click="CreateDefaultFoldersButton_Click" />
                                    </StackPanel>
                                </Border>
                            </StackPanel>
                        </Border>
                    </StackPanel>

                    <!-- 右侧列：界面设置和安全设置 -->
                    <StackPanel Grid.Column="2">
                        <!-- 界面设置 -->
                        <Border Style="{StaticResource ConfigGroupStyle}" Margin="0,0,0,20">
                            <StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                                    <materialDesign:PackIcon Kind="Palette" 
                                                           Width="20" 
                                                           Height="20" 
                                                           Foreground="{StaticResource NeonGreenBrush}"
                                                           VerticalAlignment="Center"
                                                           Margin="0,0,8,0" />
                                    <TextBlock Text="界面设置" 
                                             Style="{StaticResource ConfigGroupTitleStyle}" 
                                             VerticalAlignment="Center" />
                                </StackPanel>
                                
                                <Border Style="{StaticResource ConfigItemContainerStyle}">
                                    <StackPanel>
                                        <Grid Margin="0,0,0,12">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*" />
                                                <ColumnDefinition Width="Auto" />
                                            </Grid.ColumnDefinitions>
                                            
                                            <TextBlock Grid.Column="0"
                                                     Text="语言"
                                                     Style="{StaticResource ConfigItemLabelStyle}"
                                                     VerticalAlignment="Center" />
                                            
                                            <ComboBox Grid.Column="1"
                                                    x:Name="LanguageComboBox"
                                                    SelectedItem="{Binding Language}"
                                                    Style="{StaticResource ConfigComboBoxStyle}"
                                                    Width="120"
                                                    VerticalAlignment="Center" />
                                        </Grid>
                                        
                                        <Grid Margin="0,0,0,12">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*" />
                                                <ColumnDefinition Width="Auto" />
                                            </Grid.ColumnDefinitions>
                                            
                                            <TextBlock Grid.Column="0"
                                                     Text="主题"
                                                     Style="{StaticResource ConfigItemLabelStyle}"
                                                     VerticalAlignment="Center" />
                                            
                                            <ComboBox Grid.Column="1"
                                                    x:Name="ThemeComboBox"
                                                    SelectedItem="{Binding Theme}"
                                                    Style="{StaticResource ConfigComboBoxStyle}"
                                                    Width="120"
                                                    VerticalAlignment="Center" />
                                        </Grid>
                                        
                                        <CheckBox x:Name="EnableAnimationsCheckBox"
                                                Content="启用动画效果"
                                                IsChecked="{Binding EnableAnimations}"
                                                Style="{StaticResource ConfigCheckBoxStyle}" />
                                        
                                        <CheckBox x:Name="EnableNotificationsCheckBox"
                                                Content="启用通知"
                                                IsChecked="{Binding EnableNotifications}"
                                                Style="{StaticResource ConfigCheckBoxStyle}" />
                                    </StackPanel>
                                </Border>
                            </StackPanel>
                        </Border>

                        <!-- 安全设置 -->
                        <Border Style="{StaticResource ConfigGroupStyle}" Margin="0,0,0,20">
                            <StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                                    <materialDesign:PackIcon Kind="Security" 
                                                           Width="20" 
                                                           Height="20" 
                                                           Foreground="{StaticResource NeonGreenBrush}"
                                                           VerticalAlignment="Center"
                                                           Margin="0,0,8,0" />
                                    <TextBlock Text="安全设置" 
                                             Style="{StaticResource ConfigGroupTitleStyle}" 
                                             VerticalAlignment="Center" />
                                </StackPanel>
                                
                                <Border Style="{StaticResource ConfigItemContainerStyle}">
                                    <StackPanel>
                                        <CheckBox x:Name="EnableLoginCheckBox"
                                                Content="启用用户登录验证"
                                                IsChecked="{Binding EnableLogin}"
                                                Style="{StaticResource ConfigCheckBoxStyle}" />
                                        
                                        <TextBlock Text="启用后需要用户登录才能使用系统功能，禁用时将自动获得最高权限"
                                                 Foreground="#888888"
                                                 FontSize="12"
                                                 TextWrapping="Wrap"
                                                 Margin="0,4,0,16" />
                                        
                                        <StackPanel Orientation="Horizontal" 
                                                  Margin="0,8,0,0">
                                            <Button x:Name="ManageUsersButton"
                                                  Content="用户管理"
                                                  Style="{StaticResource ConfigButtonStyle}"
                                                  Margin="0,0,8,0"
                                                  Click="ManageUsersButton_Click" />
                                            
                                            <Button x:Name="RoleManagementButton"
                                                  Content="角色管理"
                                                  Style="{StaticResource ConfigButtonStyle}"
                                                  Click="RoleManagementButton_Click" />
                                        </StackPanel>
                                    </StackPanel>
                                </Border>
                            </StackPanel>
                        </Border>

                        <!-- 日志设置 -->
                        <Border Style="{StaticResource ConfigGroupStyle}" Margin="0,0,0,20">
                            <StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                                    <materialDesign:PackIcon Kind="FileDocument" 
                                                           Width="20" 
                                                           Height="20" 
                                                           Foreground="{StaticResource NeonGreenBrush}"
                                                           VerticalAlignment="Center"
                                                           Margin="0,0,8,0" />
                                    <TextBlock Text="日志设置" 
                                             Style="{StaticResource ConfigGroupTitleStyle}" 
                                             VerticalAlignment="Center" />
                                </StackPanel>
                                
                                <Border Style="{StaticResource ConfigItemContainerStyle}">
                                    <StackPanel>
                                        <CheckBox x:Name="EnableLoggingCheckBox"
                                                Content="启用日志记录"
                                                IsChecked="{Binding EnableLogging}"
                                                Style="{StaticResource ConfigCheckBoxStyle}" />
                                        
                                        <Grid Margin="0,12,0,16">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*" />
                                                <ColumnDefinition Width="Auto" />
                                            </Grid.ColumnDefinitions>
                                            
                                            <TextBlock Grid.Column="0"
                                                     Text="日志级别"
                                                     Style="{StaticResource ConfigItemLabelStyle}"
                                                     VerticalAlignment="Center"
                                                     IsEnabled="{Binding LogLevelEnabled}" />
                                            
                                            <ComboBox Grid.Column="1"
                                                    x:Name="LogLevelComboBox"
                                                    SelectedItem="{Binding LogLevel}"
                                                    Style="{StaticResource ConfigComboBoxStyle}"
                                                    Width="120"
                                                    VerticalAlignment="Center"
                                                    IsEnabled="{Binding LogLevelEnabled}" />
                                        </Grid>
                                        
                                        <StackPanel Orientation="Horizontal" 
                                                  Margin="0,8,0,0">
                                            <Button x:Name="OpenLogFolderButton"
                                                  Content="打开日志文件夹"
                                                  Style="{StaticResource ConfigButtonStyle}"
                                                  Margin="0,0,8,0"
                                                  Click="OpenLogFolderButton_Click" />
                                            
                                            <Button x:Name="ClearLogsButton"
                                                  Content="清除日志"
                                                  Style="{StaticResource ConfigButtonStyle}"
                                                  Click="ClearLogsButton_Click" />
                                        </StackPanel>
                                    </StackPanel>
                                </Border>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </Grid>

                <!-- 底部区域：系统信息和数据库状态 -->
                <Grid Margin="0,20,0,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="1*" />
                        <ColumnDefinition Width="20" />
                        <ColumnDefinition Width="1*" />
                    </Grid.ColumnDefinitions>

                    <!-- 系统信息 -->
                    <Border Grid.Column="0" Style="{StaticResource ConfigGroupStyle}">
                        <StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                                <materialDesign:PackIcon Kind="Information" 
                                                       Width="20" 
                                                       Height="20" 
                                                       Foreground="{StaticResource NeonGreenBrush}"
                                                       VerticalAlignment="Center"
                                                       Margin="0,0,8,0" />
                                <TextBlock Text="系统信息" 
                                         Style="{StaticResource ConfigGroupTitleStyle}" 
                                         VerticalAlignment="Center" />
                            </StackPanel>
                            
                            <Border Style="{StaticResource ConfigItemContainerStyle}">
                                <StackPanel>
                                    <Grid Margin="0,0,0,12">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        
                                        <TextBlock Grid.Column="0"
                                                 Text="应用版本"
                                                 Style="{StaticResource ConfigItemLabelStyle}"
                                                 VerticalAlignment="Center" />
                                        
                                        <TextBlock Grid.Column="1"
                                                 Text="1.0.0"
                                                 Style="{StaticResource ConfigItemLabelStyle}"
                                                 Foreground="#CCCCCC"
                                                 VerticalAlignment="Center" />
                                    </Grid>
                                    
                                    <Grid Margin="0,0,0,12">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        
                                        <TextBlock Grid.Column="0"
                                                 Text="运行时间"
                                                 Style="{StaticResource ConfigItemLabelStyle}"
                                                 VerticalAlignment="Center" />
                                        
                                        <TextBlock Grid.Column="1"
                                                 Text="2小时15分钟"
                                                 Style="{StaticResource ConfigItemLabelStyle}"
                                                 Foreground="#CCCCCC"
                                                 VerticalAlignment="Center" />
                                    </Grid>
                                    
                                    <Grid Margin="0,0,0,12">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        
                                        <TextBlock Grid.Column="0"
                                                 Text="内存使用"
                                                 Style="{StaticResource ConfigItemLabelStyle}"
                                                 VerticalAlignment="Center" />
                                        
                                        <TextBlock Grid.Column="1"
                                                 Text="45.2 MB"
                                                 Style="{StaticResource ConfigItemLabelStyle}"
                                                 Foreground="#CCCCCC"
                                                 VerticalAlignment="Center" />
                                    </Grid>
                                    
                                    <StackPanel Orientation="Horizontal" 
                                              Margin="0,12,0,0">
                                        <Button x:Name="CheckUpdateButton"
                                              Content="检查更新"
                                              Style="{StaticResource ConfigButtonStyle}"
                                              Margin="0,0,8,0"
                                              Click="CheckUpdateButton_Click" />
                                        
                                        <Button x:Name="SystemInfoButton"
                                              Content="详细信息"
                                              Style="{StaticResource ConfigButtonStyle}"
                                              Click="SystemInfoButton_Click" />
                                    </StackPanel>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </Border>

                    <!-- 数据库状态和备份设置 -->
                    <Border Grid.Column="2" Style="{StaticResource ConfigGroupStyle}">
                        <StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                                <materialDesign:PackIcon Kind="Database" 
                                                       Width="20" 
                                                       Height="20" 
                                                       Foreground="{StaticResource NeonGreenBrush}"
                                                       VerticalAlignment="Center"
                                                       Margin="0,0,8,0" />
                                <TextBlock Text="数据库状态" 
                                         Style="{StaticResource ConfigGroupTitleStyle}" 
                                         VerticalAlignment="Center" />
                            </StackPanel>
                            
                            <Border Style="{StaticResource ConfigItemContainerStyle}">
                                <StackPanel>
                                    <Grid Margin="0,0,0,12">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        
                                        <TextBlock Grid.Column="0"
                                                 Text="数据库类型"
                                                 Style="{StaticResource ConfigItemLabelStyle}"
                                                 VerticalAlignment="Center" />
                                        
                                        <TextBlock Grid.Column="1"
                                                 Text="SQLite"
                                                 Style="{StaticResource ConfigItemLabelStyle}"
                                                 Foreground="{StaticResource CyberBlueBrush}"
                                                 FontWeight="Bold"
                                                 VerticalAlignment="Center" />
                                    </Grid>
                                    
                                    <Grid Margin="0,0,0,12">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        
                                        <TextBlock Grid.Column="0"
                                                 Text="连接状态"
                                                 Style="{StaticResource ConfigItemLabelStyle}"
                                                 VerticalAlignment="Center" />
                                        
                                        <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center">
                                            <materialDesign:PackIcon Kind="CheckCircle" 
                                                                   Width="16" 
                                                                   Height="16"
                                                                   Foreground="{StaticResource NeonGreenBrush}"
                                                                   VerticalAlignment="Center"
                                                                   Margin="0,0,4,0" />
                                            <TextBlock Text="正常"
                                                     Style="{StaticResource ConfigItemLabelStyle}"
                                                     Foreground="{StaticResource NeonGreenBrush}"
                                                     FontWeight="Bold"
                                                     VerticalAlignment="Center" />
                                        </StackPanel>
                                    </Grid>
                                    
                                    <Grid Margin="0,0,0,12">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        
                                        <TextBlock Grid.Column="0"
                                                 Text="数据库大小"
                                                 Style="{StaticResource ConfigItemLabelStyle}"
                                                 VerticalAlignment="Center" />
                                        
                                        <TextBlock Grid.Column="1"
                                                 Text="2.5 MB"
                                                 Style="{StaticResource ConfigItemLabelStyle}"
                                                 Foreground="#CCCCCC"
                                                 VerticalAlignment="Center" />
                                    </Grid>
                                    
                                    <StackPanel Orientation="Horizontal" 
                                              Margin="0,12,0,0">
                                        <Button x:Name="TestConnectionButton"
                                              Content="测试连接"
                                              Style="{StaticResource ConfigButtonStyle}"
                                              Margin="0,0,8,0"
                                              Click="TestConnectionButton_Click" />
                                        
                                        <Button x:Name="BackupDatabaseButton"
                                              Content="备份数据库"
                                              Style="{StaticResource ConfigButtonStyle}"
                                              Click="BackupDatabaseButton_Click" />
                                    </StackPanel>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </Border>
                </Grid>

                <!-- 操作按钮区域 -->
                <Border Style="{StaticResource ConfigGroupStyle}" Margin="0,20,0,0">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                            <materialDesign:PackIcon Kind="Tools" 
                                                   Width="20" 
                                                   Height="20" 
                                                   Foreground="{StaticResource CyberBlueBrush}"
                                                   VerticalAlignment="Center"
                                                   Margin="0,0,8,0" />
                            <TextBlock Text="操作" 
                                     Style="{StaticResource ConfigGroupTitleStyle}" 
                                     VerticalAlignment="Center" />
                        </StackPanel>
                        
                        <StackPanel Orientation="Horizontal">
                            <Button x:Name="SaveSettingsButton"
                                  Content="保存设置"
                                  Style="{StaticResource AccentButtonStyle}"
                                  Margin="0,0,8,0"
                                  Click="SaveSettingsButton_Click" />
                            
                            <Button x:Name="ResetSettingsButton"
                                  Content="重置为默认"
                                  Style="{StaticResource ConfigButtonStyle}"
                                  Click="ResetSettingsButton_Click" />
                        </StackPanel>
                    </StackPanel>
                </Border>
            </StackPanel>
        </ScrollViewer>

        <!-- 消息提示 -->
        <materialDesign:Snackbar x:Name="MainSnackbar"
                               MessageQueue="{materialDesign:MessageQueue}"
                               VerticalAlignment="Bottom"
                               HorizontalAlignment="Left"
                               Margin="24" />
    </Grid>
</Page> 