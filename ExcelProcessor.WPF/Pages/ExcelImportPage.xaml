<?xml version="1.0" encoding="utf-8"?>
<Page x:Class="ExcelProcessor.WPF.Pages.ExcelImportPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
      Title="Excel导入配置"
      Background="Transparent">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <!-- 页面标题和操作栏 -->
        <Border Grid.Row="0"
                Background="{StaticResource DarkBlueBrush}"
                CornerRadius="8,8,0,0"
                Padding="20,16"
                Effect="{StaticResource MaterialDesignElevationShadow2}">
            
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <!-- 标题区域 -->
                <StackPanel Grid.Column="0">
                    <TextBlock Text="Excel导入配置管理" 
                             FontSize="20" 
                             FontWeight="Bold"
                             Foreground="White" />
                </StackPanel>

                <!-- 操作按钮区域 -->
                <StackPanel Grid.Column="1" 
                          Orientation="Horizontal"
                          VerticalAlignment="Center">
                    <Button x:Name="NewConfigButton"
                            Style="{StaticResource PrimaryButtonStyle}"
                            Padding="14,8"
                            Margin="0,0,10,0"
                            Click="NewConfigButton_Click">
                        <StackPanel Orientation="Horizontal">
                            <materialDesign:PackIcon Kind="Plus" 
                                                   Width="16" 
                                                   Height="16"
                                                   VerticalAlignment="Center"
                                                   Margin="0,0,6,0" />
                            <TextBlock Text="新建配置" 
                                     VerticalAlignment="Center"
                                     FontSize="13" />
                        </StackPanel>
                    </Button>
                    <Button x:Name="BatchDeleteButton"
                            Content="批量删除" 
                            Style="{StaticResource DangerButtonStyle}"
                            Padding="14,8"
                            FontSize="13"
                            Click="BatchDeleteButton_Click" />
                </StackPanel>
            </Grid>
        </Border>

        <!-- 主要内容区域 -->
        <Border Grid.Row="1"
                Background="#2A2A2A"
                CornerRadius="0,0,8,8"
                Effect="{StaticResource MaterialDesignElevationShadow2}">
            
            <Grid Margin="16">
                <Grid.RowDefinitions>
                    <RowDefinition Height="*" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>

                <!-- 配置列表表格 -->
                <Border Grid.Row="0"
                        Background="#1A1A1A"
                        CornerRadius="6"
                        Padding="16"
                        Effect="{StaticResource MaterialDesignElevationShadow1}">
                    
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>

                        <!-- 表格标题 -->
                        <TextBlock Grid.Row="0"
                                 Text="导入配置列表" 
                                 FontSize="15" 
                                 FontWeight="SemiBold"
                                 Foreground="{StaticResource CyberBlueBrush}"
                                 Margin="0,0,0,12" />

                        <!-- 数据表格 -->
                        <DataGrid Grid.Row="1"
                                 x:Name="ExcelConfigDataGrid"
                                 Style="{StaticResource CustomDataGridStyle}"
                                 ColumnHeaderStyle="{StaticResource CustomDataGridColumnHeaderStyle}"
                                 CellStyle="{StaticResource CustomDataGridCellStyle}"
                                 RowStyle="{StaticResource CustomDataGridRowStyle}"
                                 AutoGenerateColumns="False"
                                 IsReadOnly="True"
                                 SelectionMode="Extended"
                                 GridLinesVisibility="Horizontal"
                                 HeadersVisibility="Column"
                                 RowHeaderWidth="0"
                                 RowHeight="42"
                                 CanUserAddRows="False"
                                 CanUserDeleteRows="False"
                                 CanUserResizeRows="False"
                                 CanUserSortColumns="True"
                                 CanUserResizeColumns="True"
                                 CanUserReorderColumns="False"
                                 HorizontalScrollBarVisibility="Auto"
                                 VerticalScrollBarVisibility="Auto"
                                 ScrollViewer.CanContentScroll="True"
                                 ScrollViewer.HorizontalScrollBarVisibility="Auto"
                                 AlternatingRowBackground="#1E1E1E"
                                 EnableRowVirtualization="True"
                                 EnableColumnVirtualization="True">
                            
                            <DataGrid.Columns>
                                <DataGridCheckBoxColumn Header="选择" Width="50" MinWidth="40" MaxWidth="60" Binding="{Binding IsSelected}">
                                    <DataGridCheckBoxColumn.HeaderTemplate>
                                        <DataTemplate>
                                            <CheckBox x:Name="SelectAllCheckBox" 
                                                      HorizontalAlignment="Center" 
                                                      VerticalAlignment="Center"
                                                      Click="SelectAllCheckBox_Click" />
                                        </DataTemplate>
                                    </DataGridCheckBoxColumn.HeaderTemplate>
                                </DataGridCheckBoxColumn>
                                <DataGridTextColumn Header="配置名称" Binding="{Binding ConfigName}" Width="0.15*" MinWidth="120" MaxWidth="250">
                                    <DataGridTextColumn.ElementStyle>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="HorizontalAlignment" Value="Left" />
                                            <Setter Property="VerticalAlignment" Value="Center" />
                                            <Setter Property="Padding" Value="6,0" />
                                            <Setter Property="TextTrimming" Value="CharacterEllipsis" />
                                            <Setter Property="ToolTip" Value="{Binding ConfigName}" />
                                        </Style>
                                    </DataGridTextColumn.ElementStyle>
                                </DataGridTextColumn>
                                <DataGridTextColumn Header="Excel文件路径" Binding="{Binding FilePath}" Width="0.4*" MinWidth="200" MaxWidth="800">
                                    <DataGridTextColumn.ElementStyle>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="HorizontalAlignment" Value="Left" />
                                            <Setter Property="VerticalAlignment" Value="Center" />
                                            <Setter Property="Padding" Value="6,0" />
                                            <Setter Property="TextTrimming" Value="CharacterEllipsis" />
                                            <Setter Property="ToolTip" Value="{Binding FilePath}" />
                                        </Style>
                                    </DataGridTextColumn.ElementStyle>
                                </DataGridTextColumn>
                                <DataGridTextColumn Header="目标数据源" Binding="{Binding TargetDataSource}" Width="0.12*" MinWidth="100" MaxWidth="180">
                                    <DataGridTextColumn.ElementStyle>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="HorizontalAlignment" Value="Center" />
                                            <Setter Property="VerticalAlignment" Value="Center" />
                                            <Setter Property="Padding" Value="4,0" />
                                            <Setter Property="TextTrimming" Value="CharacterEllipsis" />
                                            <Setter Property="ToolTip" Value="{Binding TargetDataSource}" />
                                        </Style>
                                    </DataGridTextColumn.ElementStyle>
                                </DataGridTextColumn>
                                <DataGridTextColumn Header="Sheet名称" Binding="{Binding SheetName}" Width="0.1*" MinWidth="80" MaxWidth="150">
                                    <DataGridTextColumn.ElementStyle>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="HorizontalAlignment" Value="Center" />
                                            <Setter Property="VerticalAlignment" Value="Center" />
                                            <Setter Property="Padding" Value="4,0" />
                                            <Setter Property="TextTrimming" Value="CharacterEllipsis" />
                                            <Setter Property="ToolTip" Value="{Binding SheetName}" />
                                        </Style>
                                    </DataGridTextColumn.ElementStyle>
                                </DataGridTextColumn>
                                <DataGridTextColumn Header="标题行" Binding="{Binding HeaderRow}" Width="0.08*" MinWidth="60" MaxWidth="100">
                                    <DataGridTextColumn.ElementStyle>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="HorizontalAlignment" Value="Center" />
                                            <Setter Property="VerticalAlignment" Value="Center" />
                                            <Setter Property="Padding" Value="4,0" />
                                        </Style>
                                    </DataGridTextColumn.ElementStyle>
                                </DataGridTextColumn>
                                <DataGridTextColumn Header="状态" Binding="{Binding Status}" Width="0.08*" MinWidth="70" MaxWidth="120">
                                    <DataGridTextColumn.ElementStyle>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="HorizontalAlignment" Value="Center" />
                                            <Setter Property="VerticalAlignment" Value="Center" />
                                            <Setter Property="Padding" Value="6,3" />
                                            <Setter Property="Background" Value="#2D5A2D" />
                                            <Setter Property="Foreground" Value="#00FF00" />
                                            <Setter Property="FontWeight" Value="SemiBold" />
                                            <Setter Property="FontSize" Value="10" />
                                        </Style>
                                    </DataGridTextColumn.ElementStyle>
                                </DataGridTextColumn>
                                <DataGridTextColumn Header="创建时间" Binding="{Binding CreateTime}" Width="0.12*" MinWidth="120" MaxWidth="200">
                                    <DataGridTextColumn.ElementStyle>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="HorizontalAlignment" Value="Center" />
                                            <Setter Property="VerticalAlignment" Value="Center" />
                                            <Setter Property="Padding" Value="4,0" />
                                            <Setter Property="FontSize" Value="10" />
                                        </Style>
                                    </DataGridTextColumn.ElementStyle>
                                </DataGridTextColumn>
                                <DataGridTemplateColumn Header="操作" Width="0.15*" MinWidth="120" MaxWidth="150">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal" 
                                                        HorizontalAlignment="Center" 
                                                        VerticalAlignment="Center">
                                                <Button x:Name="EditButton"
                                                        Content="编辑" 
                                                        Style="{StaticResource SecondaryButtonStyle}"
                                                        Padding="8,4"
                                                        FontSize="10"
                                                        FontWeight="SemiBold"
                                                        Margin="0,0,4,0"
                                                        MinWidth="45"
                                                        Click="EditButton_Click" />
                                                <Button x:Name="DeleteButton"
                                                        Content="删除" 
                                                        Style="{StaticResource DangerButtonStyle}"
                                                        Padding="8,4"
                                                        FontSize="10"
                                                        FontWeight="SemiBold"
                                                        MinWidth="45"
                                                        Click="DeleteButton_Click" />
                                            </StackPanel>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Grid>
                </Border>

                <!-- 快速操作提示 -->
                <Border Grid.Row="1"
                        Background="#1A1A1A"
                        CornerRadius="6"
                        Padding="16"
                        Margin="0,12,0,0"
                        Effect="{StaticResource MaterialDesignElevationShadow1}">
                    
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>

                        <!-- 图标 -->
                        <materialDesign:PackIcon Grid.Column="0"
                                               Kind="LightbulbOutline"
                                               Width="20"
                                               Height="20"
                                               Foreground="{StaticResource CyberBlueBrush}"
                                               VerticalAlignment="Top"
                                               Margin="0,0,12,0" />

                        <!-- 提示内容 -->
                        <StackPanel Grid.Column="1">
                            <TextBlock Text="操作提示" 
                                     FontSize="14" 
                                     FontWeight="SemiBold"
                                     Foreground="{StaticResource CyberBlueBrush}"
                                     Margin="0,0,0,6" />
                            
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>

                                <StackPanel Grid.Column="0" Margin="0,0,12,0">
                                    <TextBlock Text="📝 新建配置" 
                                             FontSize="12"
                                             FontWeight="SemiBold"
                                             Foreground="#CCCCCC"
                                             Margin="0,0,0,2" />
                                    <TextBlock Text="点击「新建配置」创建新的Excel导入配置，支持自定义字段映射" 
                                             FontSize="11"
                                             Foreground="#AAAAAA"
                                             TextWrapping="Wrap" />
                                </StackPanel>

                                <StackPanel Grid.Column="1" Margin="6,0,6,0">
                                    <TextBlock Text="✏️ 编辑配置" 
                                             FontSize="12"
                                             FontWeight="SemiBold"
                                             Foreground="#CCCCCC"
                                             Margin="0,0,0,2" />
                                    <TextBlock Text="点击「编辑」按钮修改现有配置的参数和字段映射关系" 
                                             FontSize="11"
                                             Foreground="#AAAAAA"
                                             TextWrapping="Wrap" />
                                </StackPanel>

                                <StackPanel Grid.Column="2" Margin="12,0,0,0">
                                    <TextBlock Text="🧪 测试配置" 
                                             FontSize="12"
                                             FontWeight="SemiBold"
                                             Foreground="#CCCCCC"
                                             Margin="0,0,0,2" />
                                    <TextBlock Text="点击「测试」按钮验证配置是否正确，确保数据能正常导入" 
                                             FontSize="11"
                                             Foreground="#AAAAAA"
                                             TextWrapping="Wrap" />
                                </StackPanel>
                            </Grid>
                        </StackPanel>
                    </Grid>
                </Border>
            </Grid>
        </Border>
    </Grid>
</Page> 