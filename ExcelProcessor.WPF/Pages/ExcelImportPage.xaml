<?xml version="1.0" encoding="utf-8"?>
<Page x:Class="ExcelProcessor.WPF.Pages.ExcelImportPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
      Title="Excelå¯¼å…¥é…ç½®"
      Background="Transparent">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <!-- é¡µé¢æ ‡é¢˜å’Œæ“ä½œæ  -->
        <Border Grid.Row="0"
                Background="{StaticResource DarkBlueBrush}"
                CornerRadius="8,8,0,0"
                Padding="20,16"
                Effect="{StaticResource MaterialDesignElevationShadow2}">
            
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <!-- æ ‡é¢˜åŒºåŸŸ -->
                <StackPanel Grid.Column="0">
                    <TextBlock Text="Excelå¯¼å…¥é…ç½®ç®¡ç†" 
                             FontSize="20" 
                             FontWeight="Bold"
                             Foreground="White" />
                </StackPanel>

                <!-- æ“ä½œæŒ‰é’®åŒºåŸŸ -->
                <StackPanel Grid.Column="1" 
                          Orientation="Horizontal"
                          VerticalAlignment="Center">
                    <Button x:Name="NewConfigButton"
                            Style="{StaticResource PrimaryButtonStyle}"
                            Padding="14,8"
                            Margin="0,0,10,0"
                            Click="NewConfigButton_Click">
                        <StackPanel Orientation="Horizontal">
                            <materialDesign:PackIcon Kind="Plus" 
                                                   Width="16" 
                                                   Height="16"
                                                   VerticalAlignment="Center"
                                                   Margin="0,0,6,0" />
                            <TextBlock Text="æ–°å»ºé…ç½®" 
                                     VerticalAlignment="Center"
                                     FontSize="13" />
                        </StackPanel>
                    </Button>
                    <Button x:Name="BatchDeleteButton"
                            Content="æ‰¹é‡åˆ é™¤" 
                            Style="{StaticResource DangerButtonStyle}"
                            Padding="14,8"
                            FontSize="13"
                            Click="BatchDeleteButton_Click" />
                </StackPanel>
            </Grid>
        </Border>

        <!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
        <Border Grid.Row="1"
                Background="#2A2A2A"
                CornerRadius="0,0,8,8"
                Effect="{StaticResource MaterialDesignElevationShadow2}">
            
            <Grid Margin="16">
                <Grid.RowDefinitions>
                    <RowDefinition Height="*" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>

                <!-- é…ç½®åˆ—è¡¨è¡¨æ ¼ -->
                <Border Grid.Row="0"
                        Background="#1A1A1A"
                        CornerRadius="6"
                        Padding="16"
                        Effect="{StaticResource MaterialDesignElevationShadow1}">
                    
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>

                        <!-- è¡¨æ ¼æ ‡é¢˜ -->
                        <TextBlock Grid.Row="0"
                                 Text="å¯¼å…¥é…ç½®åˆ—è¡¨" 
                                 FontSize="15" 
                                 FontWeight="SemiBold"
                                 Foreground="{StaticResource CyberBlueBrush}"
                                 Margin="0,0,0,12" />

                        <!-- æ•°æ®è¡¨æ ¼ -->
                        <DataGrid Grid.Row="1"
                                 x:Name="ExcelConfigDataGrid"
                                 Style="{StaticResource CustomDataGridStyle}"
                                 ColumnHeaderStyle="{StaticResource CustomDataGridColumnHeaderStyle}"
                                 CellStyle="{StaticResource CustomDataGridCellStyle}"
                                 RowStyle="{StaticResource CustomDataGridRowStyle}"
                                 AutoGenerateColumns="False"
                                 IsReadOnly="True"
                                 SelectionMode="Extended"
                                 GridLinesVisibility="Horizontal"
                                 HeadersVisibility="Column"
                                 RowHeaderWidth="0"
                                 RowHeight="42"
                                 CanUserAddRows="False"
                                 CanUserDeleteRows="False"
                                 CanUserResizeRows="False"
                                 CanUserSortColumns="True"
                                 CanUserResizeColumns="True"
                                 CanUserReorderColumns="False"
                                 HorizontalScrollBarVisibility="Auto"
                                 VerticalScrollBarVisibility="Auto"
                                 ScrollViewer.CanContentScroll="True"
                                 ScrollViewer.HorizontalScrollBarVisibility="Auto"
                                 AlternatingRowBackground="#1E1E1E"
                                 EnableRowVirtualization="True"
                                 EnableColumnVirtualization="True">
                            
                            <DataGrid.Columns>
                                <DataGridCheckBoxColumn Header="é€‰æ‹©" Width="50" MinWidth="40" MaxWidth="60" Binding="{Binding IsSelected}">
                                    <DataGridCheckBoxColumn.HeaderTemplate>
                                        <DataTemplate>
                                            <CheckBox x:Name="SelectAllCheckBox" 
                                                      HorizontalAlignment="Center" 
                                                      VerticalAlignment="Center"
                                                      Click="SelectAllCheckBox_Click" />
                                        </DataTemplate>
                                    </DataGridCheckBoxColumn.HeaderTemplate>
                                </DataGridCheckBoxColumn>
                                <DataGridTextColumn Header="é…ç½®åç§°" Binding="{Binding ConfigName}" Width="0.15*" MinWidth="120" MaxWidth="250">
                                    <DataGridTextColumn.ElementStyle>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="HorizontalAlignment" Value="Left" />
                                            <Setter Property="VerticalAlignment" Value="Center" />
                                            <Setter Property="Padding" Value="6,0" />
                                            <Setter Property="TextTrimming" Value="CharacterEllipsis" />
                                            <Setter Property="ToolTip" Value="{Binding ConfigName}" />
                                        </Style>
                                    </DataGridTextColumn.ElementStyle>
                                </DataGridTextColumn>
                                <DataGridTextColumn Header="Excelæ–‡ä»¶è·¯å¾„" Binding="{Binding FilePath}" Width="0.4*" MinWidth="200" MaxWidth="800">
                                    <DataGridTextColumn.ElementStyle>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="HorizontalAlignment" Value="Left" />
                                            <Setter Property="VerticalAlignment" Value="Center" />
                                            <Setter Property="Padding" Value="6,0" />
                                            <Setter Property="TextTrimming" Value="CharacterEllipsis" />
                                            <Setter Property="ToolTip" Value="{Binding FilePath}" />
                                        </Style>
                                    </DataGridTextColumn.ElementStyle>
                                </DataGridTextColumn>
                                <DataGridTextColumn Header="ç›®æ ‡æ•°æ®æº" Binding="{Binding TargetDataSource}" Width="0.12*" MinWidth="100" MaxWidth="180">
                                    <DataGridTextColumn.ElementStyle>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="HorizontalAlignment" Value="Center" />
                                            <Setter Property="VerticalAlignment" Value="Center" />
                                            <Setter Property="Padding" Value="4,0" />
                                            <Setter Property="TextTrimming" Value="CharacterEllipsis" />
                                            <Setter Property="ToolTip" Value="{Binding TargetDataSource}" />
                                        </Style>
                                    </DataGridTextColumn.ElementStyle>
                                </DataGridTextColumn>
                                <DataGridTextColumn Header="Sheetåç§°" Binding="{Binding SheetName}" Width="0.1*" MinWidth="80" MaxWidth="150">
                                    <DataGridTextColumn.ElementStyle>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="HorizontalAlignment" Value="Center" />
                                            <Setter Property="VerticalAlignment" Value="Center" />
                                            <Setter Property="Padding" Value="4,0" />
                                            <Setter Property="TextTrimming" Value="CharacterEllipsis" />
                                            <Setter Property="ToolTip" Value="{Binding SheetName}" />
                                        </Style>
                                    </DataGridTextColumn.ElementStyle>
                                </DataGridTextColumn>
                                <DataGridTextColumn Header="æ ‡é¢˜è¡Œ" Binding="{Binding HeaderRow}" Width="0.08*" MinWidth="60" MaxWidth="100">
                                    <DataGridTextColumn.ElementStyle>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="HorizontalAlignment" Value="Center" />
                                            <Setter Property="VerticalAlignment" Value="Center" />
                                            <Setter Property="Padding" Value="4,0" />
                                        </Style>
                                    </DataGridTextColumn.ElementStyle>
                                </DataGridTextColumn>
                                <DataGridTextColumn Header="çŠ¶æ€" Binding="{Binding Status}" Width="0.08*" MinWidth="70" MaxWidth="120">
                                    <DataGridTextColumn.ElementStyle>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="HorizontalAlignment" Value="Center" />
                                            <Setter Property="VerticalAlignment" Value="Center" />
                                            <Setter Property="Padding" Value="6,3" />
                                            <Setter Property="Background" Value="#2D5A2D" />
                                            <Setter Property="Foreground" Value="#00FF00" />
                                            <Setter Property="FontWeight" Value="SemiBold" />
                                            <Setter Property="FontSize" Value="10" />
                                        </Style>
                                    </DataGridTextColumn.ElementStyle>
                                </DataGridTextColumn>
                                <DataGridTextColumn Header="åˆ›å»ºæ—¶é—´" Binding="{Binding CreateTime}" Width="0.12*" MinWidth="120" MaxWidth="200">
                                    <DataGridTextColumn.ElementStyle>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="HorizontalAlignment" Value="Center" />
                                            <Setter Property="VerticalAlignment" Value="Center" />
                                            <Setter Property="Padding" Value="4,0" />
                                            <Setter Property="FontSize" Value="10" />
                                        </Style>
                                    </DataGridTextColumn.ElementStyle>
                                </DataGridTextColumn>
                                <DataGridTemplateColumn Header="æ“ä½œ" Width="0.15*" MinWidth="120" MaxWidth="150">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal" 
                                                        HorizontalAlignment="Center" 
                                                        VerticalAlignment="Center">
                                                <Button x:Name="EditButton"
                                                        Content="ç¼–è¾‘" 
                                                        Style="{StaticResource SecondaryButtonStyle}"
                                                        Padding="8,4"
                                                        FontSize="10"
                                                        FontWeight="SemiBold"
                                                        Margin="0,0,4,0"
                                                        MinWidth="45"
                                                        Click="EditButton_Click" />
                                                <Button x:Name="DeleteButton"
                                                        Content="åˆ é™¤" 
                                                        Style="{StaticResource DangerButtonStyle}"
                                                        Padding="8,4"
                                                        FontSize="10"
                                                        FontWeight="SemiBold"
                                                        MinWidth="45"
                                                        Click="DeleteButton_Click" />
                                            </StackPanel>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Grid>
                </Border>

                <!-- å¿«é€Ÿæ“ä½œæç¤º -->
                <Border Grid.Row="1"
                        Background="#1A1A1A"
                        CornerRadius="6"
                        Padding="16"
                        Margin="0,12,0,0"
                        Effect="{StaticResource MaterialDesignElevationShadow1}">
                    
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>

                        <!-- å›¾æ ‡ -->
                        <materialDesign:PackIcon Grid.Column="0"
                                               Kind="LightbulbOutline"
                                               Width="20"
                                               Height="20"
                                               Foreground="{StaticResource CyberBlueBrush}"
                                               VerticalAlignment="Top"
                                               Margin="0,0,12,0" />

                        <!-- æç¤ºå†…å®¹ -->
                        <StackPanel Grid.Column="1">
                            <TextBlock Text="æ“ä½œæç¤º" 
                                     FontSize="14" 
                                     FontWeight="SemiBold"
                                     Foreground="{StaticResource CyberBlueBrush}"
                                     Margin="0,0,0,6" />
                            
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>

                                <StackPanel Grid.Column="0" Margin="0,0,12,0">
                                    <TextBlock Text="ðŸ“ æ–°å»ºé…ç½®" 
                                             FontSize="12"
                                             FontWeight="SemiBold"
                                             Foreground="#CCCCCC"
                                             Margin="0,0,0,2" />
                                    <TextBlock Text="ç‚¹å‡»ã€Œæ–°å»ºé…ç½®ã€åˆ›å»ºæ–°çš„Excelå¯¼å…¥é…ç½®ï¼Œæ”¯æŒè‡ªå®šä¹‰å­—æ®µæ˜ å°„" 
                                             FontSize="11"
                                             Foreground="#AAAAAA"
                                             TextWrapping="Wrap" />
                                </StackPanel>

                                <StackPanel Grid.Column="1" Margin="6,0,6,0">
                                    <TextBlock Text="âœï¸ ç¼–è¾‘é…ç½®" 
                                             FontSize="12"
                                             FontWeight="SemiBold"
                                             Foreground="#CCCCCC"
                                             Margin="0,0,0,2" />
                                    <TextBlock Text="ç‚¹å‡»ã€Œç¼–è¾‘ã€æŒ‰é’®ä¿®æ”¹çŽ°æœ‰é…ç½®çš„å‚æ•°å’Œå­—æ®µæ˜ å°„å…³ç³»" 
                                             FontSize="11"
                                             Foreground="#AAAAAA"
                                             TextWrapping="Wrap" />
                                </StackPanel>

                                <StackPanel Grid.Column="2" Margin="12,0,0,0">
                                    <TextBlock Text="ðŸ§ª æµ‹è¯•é…ç½®" 
                                             FontSize="12"
                                             FontWeight="SemiBold"
                                             Foreground="#CCCCCC"
                                             Margin="0,0,0,2" />
                                    <TextBlock Text="ç‚¹å‡»ã€Œæµ‹è¯•ã€æŒ‰é’®éªŒè¯é…ç½®æ˜¯å¦æ­£ç¡®ï¼Œç¡®ä¿æ•°æ®èƒ½æ­£å¸¸å¯¼å…¥" 
                                             FontSize="11"
                                             Foreground="#AAAAAA"
                                             TextWrapping="Wrap" />
                                </StackPanel>
                            </Grid>
                        </StackPanel>
                    </Grid>
                </Border>
            </Grid>
        </Border>
    </Grid>
</Page> 