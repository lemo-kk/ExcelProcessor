<?xml version="1.0" encoding="utf-8"?>
<Page x:Class="ExcelProcessor.WPF.Pages.ImportExportPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
      xmlns:converters="clr-namespace:ExcelProcessor.WPF.Converters"
      Title="å¯¼å…¥å¯¼å‡ºç®¡ç†"
      Background="Transparent">

    <Page.Resources>
        <!-- è½¬æ¢å™¨èµ„æº -->
        <converters:CountToVisibilityConverter x:Key="CountToVisibilityConverter" />
        
        <!-- é¡µé¢æ ‡é¢˜æ ·å¼ -->
        <Style x:Key="PageTitleStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="20" />
            <Setter Property="FontWeight" Value="Bold" />
            <Setter Property="Foreground" Value="{StaticResource CyberBlueBrush}" />
            <Setter Property="Margin" Value="0,0,0,20" />
        </Style>

        <!-- åŒºåŸŸæ ‡é¢˜æ ·å¼ -->
        <Style x:Key="SectionTitleStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="16" />
            <Setter Property="FontWeight" Value="SemiBold" />
            <Setter Property="Foreground" Value="{StaticResource CyberBlueBrush}" />
            <Setter Property="Margin" Value="0,0,0,16" />
        </Style>

        <!-- å¡ç‰‡å®¹å™¨æ ·å¼ -->
        <Style x:Key="CardContainerStyle" TargetType="Border">
            <Setter Property="Background" Value="#2A2A2A" />
            <Setter Property="CornerRadius" Value="12" />
            <Setter Property="Padding" Value="24" />
            <Setter Property="Margin" Value="0,0,0,24" />
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect Color="Black" BlurRadius="8" ShadowDepth="3" Opacity="0.3" />
                </Setter.Value>
            </Setter>
        </Style>

        <!-- ä¸»è¦æŒ‰é’®æ ·å¼ -->
        <Style x:Key="PrimaryButtonStyle" TargetType="Button" BasedOn="{StaticResource MaterialDesignRaisedButton}">
            <Setter Property="Background" Value="{StaticResource CyberBlueBrush}" />
            <Setter Property="Foreground" Value="White" />
            <Setter Property="Padding" Value="20,12" />
            <Setter Property="FontSize" Value="13" />
            <Setter Property="FontWeight" Value="SemiBold" />
            <Setter Property="Height" Value="40" />
            <Setter Property="Margin" Value="0,0,12,0" />
            <Setter Property="Cursor" Value="Hand" />
        </Style>

        <!-- æ¬¡è¦æŒ‰é’®æ ·å¼ -->
        <Style x:Key="SecondaryButtonStyle" TargetType="Button" BasedOn="{StaticResource MaterialDesignOutlinedButton}">
            <Setter Property="BorderBrush" Value="{StaticResource CyberBlueBrush}" />
            <Setter Property="Foreground" Value="{StaticResource CyberBlueBrush}" />
            <Setter Property="Padding" Value="20,12" />
            <Setter Property="FontSize" Value="13" />
            <Setter Property="FontWeight" Value="SemiBold" />
            <Setter Property="Height" Value="40" />
            <Setter Property="Margin" Value="0,0,12,0" />
            <Setter Property="Cursor" Value="Hand" />
        </Style>

        <!-- ä¸‹æ‹‰æ¡†æ ·å¼ -->
        <Style x:Key="ComboBoxStyle" TargetType="ComboBox" BasedOn="{StaticResource MaterialDesignOutlinedComboBox}">
            <Setter Property="Background" Value="#333333" />
            <Setter Property="Foreground" Value="White" />
            <Setter Property="BorderBrush" Value="#404040" />
            <Setter Property="Height" Value="40" />
            <Setter Property="MinWidth" Value="300" />
            <Setter Property="FontSize" Value="13" />
            <Setter Property="Padding" Value="12,8" />
        </Style>

        <!-- æ–‡æœ¬æ¡†æ ·å¼ -->
        <Style x:Key="TextBoxStyle" TargetType="TextBox" BasedOn="{StaticResource MaterialDesignOutlinedTextBox}">
            <Setter Property="Background" Value="#333333" />
            <Setter Property="Foreground" Value="#E0E0E0" />
            <Setter Property="BorderBrush" Value="#404040" />
            <Setter Property="Height" Value="40" />
            <Setter Property="FontSize" Value="13" />
            <Setter Property="Padding" Value="12,8" />
        </Style>

        <!-- å¤é€‰æ¡†æ ·å¼ -->
        <Style x:Key="CheckBoxStyle" TargetType="CheckBox" BasedOn="{StaticResource MaterialDesignCheckBox}">
            <Setter Property="Foreground" Value="#E0E0E0" />
            <Setter Property="FontSize" Value="13" />
            <Setter Property="Margin" Value="0,0,0,8" />
        </Style>

        <!-- çŠ¶æ€æ ‡ç­¾æ ·å¼ -->
        <Style x:Key="StatusTagStyle" TargetType="Border">
            <Setter Property="CornerRadius" Value="12" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="Padding" Value="8,4" />
            <Setter Property="Margin" Value="0,0,8,0" />
        </Style>

        <!-- çŠ¶æ€æ ‡ç­¾æ–‡æœ¬æ ·å¼ -->
        <Style x:Key="StatusTagTextStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="11" />
            <Setter Property="FontWeight" Value="SemiBold" />
        </Style>

        <!-- æ•°æ®è¡¨æ ¼æ ·å¼ -->
        <Style x:Key="DataGridStyle" TargetType="DataGrid" BasedOn="{StaticResource MaterialDesignDataGrid}">
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="BorderBrush" Value="#404040" />
            <Setter Property="GridLinesVisibility" Value="Horizontal" />
            <Setter Property="HorizontalGridLinesBrush" Value="#404040" />
            <Setter Property="RowBackground" Value="Transparent" />
            <Setter Property="AlternatingRowBackground" Value="#1A1A1A" />
            <Setter Property="HeadersVisibility" Value="Column" />
            <Setter Property="CanUserAddRows" Value="False" />
            <Setter Property="CanUserDeleteRows" Value="False" />
            <Setter Property="CanUserResizeRows" Value="False" />
            <Setter Property="CanUserSortColumns" Value="True" />
            <Setter Property="AutoGenerateColumns" Value="False" />
            <Setter Property="IsReadOnly" Value="True" />
            <Setter Property="SelectionMode" Value="Single" />
            <Setter Property="SelectionUnit" Value="FullRow" />
        </Style>
    </Page.Resources>

    <!-- ä¸»å¸ƒå±€å®¹å™¨ -->
    <Grid>
        <!-- ä¸»å†…å®¹åŒºåŸŸ -->
        <ScrollViewer VerticalScrollBarVisibility="Auto" 
                      HorizontalScrollBarVisibility="Disabled"
                      Margin="20">
            <StackPanel>
                <!-- é¡µé¢æ ‡é¢˜ -->
                <TextBlock Text="å¯¼å…¥å¯¼å‡ºç®¡ç†" 
                         Style="{StaticResource PageTitleStyle}"
                         HorizontalAlignment="Center" />

                <!-- é¡µé¢æè¿° -->
                <TextBlock Text="ç®¡ç†ä½œä¸šé…ç½®çš„å¯¼å…¥å’Œå¯¼å‡ºï¼Œæ”¯æŒè·¨çŽ¯å¢ƒéƒ¨ç½²å’Œé…ç½®å¤‡ä»½"
                         FontSize="14"
                         Foreground="#CCCCCC"
                         HorizontalAlignment="Center"
                         TextWrapping="Wrap"
                         TextAlignment="Center"
                         MaxWidth="600"
                         Margin="0,0,0,32" />

                <!-- å¯¼å‡ºä½œä¸šé…ç½®åŒ…åŒºåŸŸ -->
                <Border Style="{StaticResource CardContainerStyle}">
                    <StackPanel>
                        <!-- å¯¼å‡ºåŒºåŸŸæ ‡é¢˜ -->
                        <StackPanel Orientation="Horizontal" 
                                   HorizontalAlignment="Left" 
                                   Margin="0,0,0,20">
                            <materialDesign:PackIcon Kind="PackageVariant" 
                                                   Width="24" 
                                                   Height="24"
                                                   Foreground="{StaticResource CyberBlueBrush}"
                                                   VerticalAlignment="Center"
                                                   Margin="0,0,8,0" />
                            <TextBlock Text="å¯¼å‡ºä½œä¸šé…ç½®åŒ…" 
                                     Style="{StaticResource SectionTitleStyle}" />
                        </StackPanel>

                        <!-- ä½œä¸šé€‰æ‹© -->
                        <StackPanel Orientation="Horizontal" 
                                   HorizontalAlignment="Left" 
                                   Margin="0,0,0,20">
                            <TextBlock Text="é€‰æ‹©ä½œä¸š:" 
                                     Foreground="#E0E0E0"
                                     FontSize="13"
                                     VerticalAlignment="Center"
                                     Margin="0,0,12,0" />
                            <ComboBox x:Name="JobSelectionComboBox"
                                     Style="{StaticResource ComboBoxStyle}"
                                     DisplayMemberPath="Name"
                                     SelectedValuePath="Id"
                                     ItemsSource="{Binding AvailableJobs}"
                                     SelectedItem="{Binding SelectedJob}" />
                        </StackPanel>

                        <!-- å¯¼å‡ºå†…å®¹é¢„è§ˆ -->
                        <TextBlock Text="å¯¼å‡ºå†…å®¹é¢„è§ˆ:" 
                                 Foreground="#E0E0E0"
                                 FontSize="13"
                                 FontWeight="SemiBold"
                                 Margin="0,0,0,12" />

                        <!-- é¢„è§ˆåŠ è½½çŠ¶æ€ -->
                        <Border Background="#1A1A1A"
                                CornerRadius="8"
                                Padding="16"
                                Margin="0,0,0,20"
                                Visibility="{Binding IsPreviewLoading, Converter={StaticResource BoolToVisibilityConverter}}">
                            <StackPanel Orientation="Horizontal">
                                <ProgressBar IsIndeterminate="True" 
                                           Width="20" 
                                           Height="20" 
                                           Margin="0,0,12,0" />
                                <TextBlock Text="{Binding PreviewStatusMessage}" 
                                         Foreground="#CCCCCC"
                                         VerticalAlignment="Center" />
                            </StackPanel>
                        </Border>

                        <!-- å¯¼å‡ºå†…å®¹é¢„è§ˆè¯¦æƒ… -->
                        <Border Background="#1A1A1A"
                                CornerRadius="8"
                                Padding="16"
                                Margin="0,0,0,20"
                                Visibility="{Binding ExportPreviewInfo, Converter={StaticResource NullToVisibilityConverter}}">
                            <StackPanel>
                                <!-- ä½œä¸šåŸºæœ¬ä¿¡æ¯ -->
                                <Border Background="#2A2A2A"
                                        CornerRadius="6"
                                        Padding="12"
                                        Margin="0,0,0,12">
                                    <StackPanel>
                                        <TextBlock Text="ä½œä¸šåŸºæœ¬ä¿¡æ¯" 
                                                 Foreground="#E0E0E0"
                                                 FontSize="12"
                                                 FontWeight="SemiBold"
                                                 Margin="0,0,0,8" />
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>
                                            
                                            <TextBlock Text="ä½œä¸šåç§°:" Grid.Column="0" Grid.Row="0" Foreground="#CCCCCC" FontSize="11" Margin="0,0,8,4"/>
                                            <TextBlock Text="{Binding ExportPreviewInfo.JobName}" Grid.Column="1" Grid.Row="0" Foreground="#FFFFFF" FontSize="11" Margin="0,0,16,4"/>
                                            <TextBlock Text="åˆ›å»ºæ—¶é—´:" Grid.Column="2" Grid.Row="0" Foreground="#CCCCCC" FontSize="11" Margin="0,0,8,4"/>
                                            <TextBlock Text="{Binding ExportPreviewInfo.JobCreatedAt, StringFormat='yyyy-MM-dd HH:mm'}" Grid.Column="3" Grid.Row="0" Foreground="#FFFFFF" FontSize="11" Margin="0,0,16,4"/>
                                            
                                            <TextBlock Text="ä½œä¸šæè¿°:" Grid.Column="0" Grid.Row="1" Foreground="#CCCCCC" FontSize="11" Margin="0,0,8,4"/>
                                            <TextBlock Text="{Binding ExportPreviewInfo.JobDescription}" Grid.Column="1" Grid.Row="1" Foreground="#FFFFFF" FontSize="11" Margin="0,0,16,4"/>
                                            <TextBlock Text="ä½œä¸šçŠ¶æ€:" Grid.Column="2" Grid.Row="1" Foreground="#CCCCCC" FontSize="11" Margin="0,0,8,4"/>
                                            <TextBlock Text="{Binding ExportPreviewInfo.JobIsEnabled, Converter={StaticResource BoolToTextConverter}, ConverterParameter='å¯ç”¨|ç¦ç”¨'}" Grid.Column="3" Grid.Row="1" Foreground="#FFFFFF" FontSize="11" Margin="0,0,16,4"/>
                                        </Grid>
                                    </StackPanel>
                                </Border>

                                <!-- é…ç½®é¡¹ç»Ÿè®¡ -->
                                <Border Background="#2A2A2A"
                                        CornerRadius="6"
                                        Padding="12"
                                        Margin="0,0,0,12">
                                    <StackPanel>
                                        <TextBlock Text="é…ç½®é¡¹ç»Ÿè®¡" 
                                                 Foreground="#E0E0E0"
                                                 FontSize="12"
                                                 FontWeight="SemiBold"
                                                 Margin="0,0,0,8" />
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>
                                            
                                            <StackPanel Grid.Column="0" HorizontalAlignment="Center">
                                                <TextBlock Text="{Binding ExportPreviewInfo.ExcelConfigCount}" Foreground="#4CAF50" FontSize="18" FontWeight="Bold" HorizontalAlignment="Center"/>
                                                <TextBlock Text="Excelé…ç½®" Foreground="#CCCCCC" FontSize="10" HorizontalAlignment="Center"/>
                                            </StackPanel>
                                            
                                            <StackPanel Grid.Column="1" HorizontalAlignment="Center">
                                                <TextBlock Text="{Binding ExportPreviewInfo.SqlScriptCount}" Foreground="#2196F3" FontSize="18" FontWeight="Bold" HorizontalAlignment="Center"/>
                                                <TextBlock Text="SQLè„šæœ¬" Foreground="#CCCCCC" FontSize="10" HorizontalAlignment="Center"/>
                                            </StackPanel>
                                            
                                            <StackPanel Grid.Column="2" HorizontalAlignment="Center">
                                                <TextBlock Text="{Binding ExportPreviewInfo.DataSourceCount}" Foreground="#FF9800" FontSize="18" FontWeight="Bold" HorizontalAlignment="Center"/>
                                                <TextBlock Text="æ•°æ®æº" Foreground="#CCCCCC" FontSize="10" HorizontalAlignment="Center"/>
                                            </StackPanel>
                                            
                                            <StackPanel Grid.Column="3" HorizontalAlignment="Center">
                                                <TextBlock Text="{Binding ExportPreviewInfo.FieldMappingCount}" Foreground="#9C27B0" FontSize="18" FontWeight="Bold" HorizontalAlignment="Center"/>
                                                <TextBlock Text="å­—æ®µæ˜ å°„" Foreground="#CCCCCC" FontSize="10" HorizontalAlignment="Center"/>
                                            </StackPanel>
                                        </Grid>
                                    </StackPanel>
                                </Border>

                                <!-- å¯¼å‡ºä¿¡æ¯ -->
                                <Border Background="#2A2A2A"
                                        CornerRadius="6"
                                        Padding="12"
                                        Margin="0,0,0,12">
                                    <StackPanel>
                                        <TextBlock Text="å¯¼å‡ºä¿¡æ¯" 
                                                 Foreground="#E0E0E0"
                                                 FontSize="12"
                                                 FontWeight="SemiBold"
                                                 Margin="0,0,0,8" />
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>
                                            
                                            <TextBlock Text="é¢„ä¼°åŒ…å¤§å°:" Grid.Column="0" Grid.Row="0" Foreground="#CCCCCC" FontSize="11" Margin="0,0,8,4"/>
                                            <TextBlock Text="{Binding ExportPreviewInfo.FormattedPackageSize}" Grid.Column="1" Grid.Row="0" Foreground="#FFFFFF" FontSize="11" Margin="0,0,16,4"/>
                                            <TextBlock Text="é¢„ä¼°å¯¼å‡ºæ—¶é—´:" Grid.Column="2" Grid.Row="0" Foreground="#CCCCCC" FontSize="11" Margin="0,0,8,4"/>
                                            <TextBlock Text="{Binding ExportPreviewInfo.FormattedExportTime}" Grid.Column="3" Grid.Row="0" Foreground="#FFFFFF" FontSize="11" Margin="0,0,16,4"/>
                                        </Grid>
                                    </StackPanel>
                                </Border>

                                <!-- ä¾èµ–å…³ç³» -->
                                <Border Background="#2A2A2A"
                                        CornerRadius="6"
                                        Padding="12"
                                        Margin="0,0,0,12"
                                        Visibility="{Binding ExportPreviewInfo.Dependencies.Count, Converter={StaticResource CountToVisibilityConverter}}">
                                    <StackPanel>
                                        <TextBlock Text="ä¾èµ–å…³ç³»" 
                                                 Foreground="#E0E0E0"
                                                 FontSize="12"
                                                 FontWeight="SemiBold"
                                                 Margin="0,0,0,8" />
                                        <ItemsControl ItemsSource="{Binding ExportPreviewInfo.Dependencies}">
                                            <ItemsControl.ItemTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding}" Foreground="#CCCCCC" FontSize="11" Margin="0,2"/>
                                                </DataTemplate>
                                            </ItemsControl.ItemTemplate>
                                        </ItemsControl>
                                    </StackPanel>
                                </Border>

                                <!-- è­¦å‘Šä¿¡æ¯ -->
                                <Border Background="#2A2A2A"
                                        CornerRadius="6"
                                        Padding="12"
                                        Margin="0,0,0,12"
                                        Visibility="{Binding ExportPreviewInfo.Warnings.Count, Converter={StaticResource CountToVisibilityConverter}}">
                                    <StackPanel>
                                        <TextBlock Text="âš ï¸ è­¦å‘Šä¿¡æ¯" 
                                                 Foreground="#FF9800"
                                                 FontSize="12"
                                                 FontWeight="SemiBold"
                                                 Margin="0,0,0,8" />
                                        <ItemsControl ItemsSource="{Binding ExportPreviewInfo.Warnings}">
                                            <ItemsControl.ItemTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding}" Foreground="#CCCCCC" FontSize="11" Margin="0,2"/>
                                                </DataTemplate>
                                            </ItemsControl.ItemTemplate>
                                        </ItemsControl>
                                    </StackPanel>
                                </Border>

                                <!-- å»ºè®®ä¿¡æ¯ -->
                                <Border Background="#2A2A2A"
                                        CornerRadius="6"
                                        Padding="12"
                                        Margin="0,0,0,12"
                                        Visibility="{Binding ExportPreviewInfo.Recommendations.Count, Converter={StaticResource CountToVisibilityConverter}}">
                                    <StackPanel>
                                        <TextBlock Text="ðŸ’¡ å»ºè®®ä¿¡æ¯" 
                                                 Foreground="#4CAF50"
                                                 FontSize="12"
                                                 FontWeight="SemiBold"
                                                 Margin="0,0,0,8" />
                                        <ItemsControl ItemsSource="{Binding ExportPreviewInfo.Recommendations}">
                                            <ItemsControl.ItemTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding}" Foreground="#CCCCCC" FontSize="11" Margin="0,2"/>
                                                </DataTemplate>
                                            </ItemsControl.ItemTemplate>
                                        </ItemsControl>
                                    </StackPanel>
                                </Border>
                            </StackPanel>
                        </Border>

                        <!-- å¯¼å‡ºæŒ‰é’® -->
                        <StackPanel Orientation="Horizontal" 
                                   HorizontalAlignment="Left">
                            <Button Content="å¯¼å‡ºé…ç½®åŒ…" 
                                    Style="{StaticResource PrimaryButtonStyle}"
                                    Click="ExportJobPackage_Click" />
                            <Button Content="é¢„è§ˆé…ç½®" 
                                    Style="{StaticResource SecondaryButtonStyle}"
                                    Click="PreviewJobPackage_Click" />
                        </StackPanel>
                    </StackPanel>
                </Border>

                <!-- å¯¼å…¥ä½œä¸šé…ç½®åŒ…åŒºåŸŸ -->
                <Border Style="{StaticResource CardContainerStyle}">
                    <StackPanel>
                        <!-- å¯¼å…¥åŒºåŸŸæ ‡é¢˜ -->
                        <StackPanel Orientation="Horizontal" 
                                   HorizontalAlignment="Left" 
                                   Margin="0,0,0,20">
                            <materialDesign:PackIcon Kind="PackageDown" 
                                                   Width="24" 
                                                   Height="24"
                                                   Foreground="{StaticResource CyberBlueBrush}"
                                                   VerticalAlignment="Center"
                                                   Margin="0,0,8,0" />
                            <TextBlock Text="å¯¼å…¥ä½œä¸šé…ç½®åŒ…" 
                                     Style="{StaticResource SectionTitleStyle}" />
                        </StackPanel>

                        <!-- æ–‡ä»¶é€‰æ‹© -->
                        <StackPanel Orientation="Horizontal" 
                                   HorizontalAlignment="Left" 
                                   Margin="0,0,0,20">
                            <TextBlock Text="é€‰æ‹©æ–‡ä»¶:" 
                                     Foreground="#E0E0E0"
                                     FontSize="13"
                                     VerticalAlignment="Center"
                                     Margin="0,0,12,0" />
                            <Button Content="æµè§ˆ..." 
                                    Style="{StaticResource SecondaryButtonStyle}"
                                    Padding="16,12"
                                    Click="BrowsePackageFile_Click" />
                            <TextBox x:Name="PackageFilePathTextBox"
                                   Style="{StaticResource TextBoxStyle}"
                                   Text="{Binding PackageFilePath}"
                                   IsReadOnly="True"
                                   MinWidth="400"
                                   Margin="12,0,0,0" />
                        </StackPanel>

                        <!-- å¯¼å…¥é€‰é¡¹ -->
                        <TextBlock Text="å¯¼å…¥é€‰é¡¹:" 
                                 Foreground="#E0E0E0"
                                 FontSize="13"
                                 FontWeight="SemiBold"
                                 Margin="0,0,0,12" />

                        <Border Background="#1A1A1A"
                                CornerRadius="8"
                                Padding="16"
                                Margin="0,0,0,20">
                            <StackPanel>
                                <CheckBox Content="è¦†ç›–çŽ°æœ‰é…ç½® (å¦‚æžœé…ç½®å·²å­˜åœ¨)" 
                                         Style="{StaticResource CheckBoxStyle}"
                                         IsChecked="{Binding OverwriteExisting}" />
                                <CheckBox Content="è‡ªåŠ¨åˆ›å»ºæ•°æ®æºè¿žæŽ¥" 
                                         Style="{StaticResource CheckBoxStyle}"
                                         IsChecked="{Binding AutoCreateDataSources}" />
                                <CheckBox Content="å¯¼å…¥åŽè‡ªåŠ¨å¯ç”¨ä½œä¸š" 
                                         Style="{StaticResource CheckBoxStyle}"
                                         IsChecked="{Binding AutoEnableJobs}" />
                            </StackPanel>
                        </Border>

                        <!-- å¯¼å…¥å†…å®¹é¢„è§ˆ -->
                        <TextBlock Text="å¯¼å…¥å†…å®¹é¢„è§ˆ:" 
                                 Foreground="#E0E0E0"
                                 FontSize="13"
                                 FontWeight="SemiBold"
                                 Margin="0,0,0,12" />

                        <Border Background="#1A1A1A"
                                CornerRadius="8"
                                Padding="16"
                                Margin="0,0,0,20">
                            <StackPanel>
                                <TextBlock Text="é…ç½®åŒ…ä¿¡æ¯" 
                                         Foreground="#CCCCCC"
                                         FontSize="12"
                                         Margin="0,0,0,8" />
                                <TextBlock Text="åŒ…å«çš„é…ç½®é¡¹" 
                                         Foreground="#CCCCCC"
                                         FontSize="12"
                                         Margin="0,0,0,8" />
                                <TextBlock Text="å†²çªæ£€æµ‹ç»“æžœ" 
                                         Foreground="#CCCCCC"
                                         FontSize="12"
                                         Margin="0,0,0,8" />
                            </StackPanel>
                        </Border>

                        <!-- å¯¼å…¥æŒ‰é’® -->
                        <StackPanel Orientation="Horizontal" 
                                   HorizontalAlignment="Left">
                            <Button Content="å¯¼å…¥é…ç½®åŒ…" 
                                    Style="{StaticResource PrimaryButtonStyle}"
                                    Click="ImportJobPackage_Click" />
                            <Button Content="éªŒè¯é…ç½®" 
                                    Style="{StaticResource SecondaryButtonStyle}"
                                    Click="ValidateJobPackage_Click" />
                        </StackPanel>
                    </StackPanel>
                </Border>

                <!-- å¯¼å…¥å¯¼å‡ºåŽ†å²è®°å½•åŒºåŸŸ -->
                <Border Style="{StaticResource CardContainerStyle}">
                    <StackPanel>
                        <!-- åŽ†å²è®°å½•åŒºåŸŸæ ‡é¢˜ -->
                        <StackPanel Orientation="Horizontal" 
                                   HorizontalAlignment="Left" 
                                   Margin="0,0,0,20">
                            <materialDesign:PackIcon Kind="History" 
                                                   Width="24" 
                                                   Height="24"
                                                   Foreground="{StaticResource CyberBlueBrush}"
                                                   VerticalAlignment="Center"
                                                   Margin="0,0,8,0" />
                            <TextBlock Text="å¯¼å…¥å¯¼å‡ºåŽ†å²è®°å½•" 
                                     Style="{StaticResource SectionTitleStyle}" />
                        </StackPanel>

                        <!-- åŽ†å²è®°å½•è¡¨æ ¼ -->
                        <DataGrid x:Name="HistoryDataGrid"
                                 Style="{StaticResource DataGridStyle}"
                                 ItemsSource="{Binding ImportExportHistory}"
                                 Height="300"
                                 Margin="0,0,0,16">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="æ“ä½œæ—¶é—´" 
                                                  Binding="{Binding OperationTime}" 
                                                  Width="150" />
                                <DataGridTextColumn Header="æ“ä½œç±»åž‹" 
                                                  Binding="{Binding OperationType}" 
                                                  Width="100" />
                                <DataGridTextColumn Header="ä½œä¸šåç§°" 
                                                  Binding="{Binding JobName}" 
                                                  Width="*" />
                                <DataGridTextColumn Header="çŠ¶æ€" 
                                                  Binding="{Binding Status}" 
                                                  Width="100">
                                    <DataGridTextColumn.ElementStyle>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="HorizontalAlignment" Value="Center" />
                                            <Setter Property="VerticalAlignment" Value="Center" />
                                            <Setter Property="Padding" Value="8,4" />
                                            <Setter Property="Background" Value="{Binding StatusColor}" />
                                            <Setter Property="Foreground" Value="White" />
                                            <Setter Property="FontWeight" Value="SemiBold" />
                                        </Style>
                                    </DataGridTextColumn.ElementStyle>
                                </DataGridTextColumn>
                                <DataGridTemplateColumn Header="æ“ä½œ" Width="120">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal">
                                                <Button Content="æŸ¥çœ‹" 
                                                        Style="{StaticResource SecondaryButtonStyle}"
                                                        Padding="8,4"
                                                        FontSize="11"
                                                        Click="ViewHistoryDetails_Click"
                                                        Tag="{Binding}" />
                                                <Button Content="é‡æ–°å¯¼å…¥" 
                                                        Style="{StaticResource PrimaryButtonStyle}"
                                                        Padding="8,4"
                                                        FontSize="11"
                                                        Margin="4,0,0,0"
                                                        Click="ReImportFromHistory_Click"
                                                        Tag="{Binding}"
                                                        Visibility="{Binding CanReImport, Converter={StaticResource BoolToVisibilityConverter}}" />
                                            </StackPanel>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                            </DataGrid.Columns>
                        </DataGrid>

                        <!-- åŽ†å²è®°å½•æ“ä½œæŒ‰é’® -->
                        <StackPanel Orientation="Horizontal" 
                                   HorizontalAlignment="Left">
                            <Button Content="åˆ·æ–°åŽ†å²" 
                                    Style="{StaticResource SecondaryButtonStyle}"
                                    Click="RefreshHistory_Click" />
                            <Button Content="å¯¼å‡ºæ—¥å¿—" 
                                    Style="{StaticResource SecondaryButtonStyle}"
                                    Click="ExportHistoryLog_Click" />
                            <Button Content="æ¸…ç©ºåŽ†å²" 
                                    Style="{StaticResource SecondaryButtonStyle}"
                                    Click="ClearHistory_Click" />
                        </StackPanel>
                    </StackPanel>
                </Border>

                <!-- å¦‚æžœæ²¡æœ‰åŽ†å²è®°å½•ï¼Œæ˜¾ç¤ºæç¤ºä¿¡æ¯ -->
                <Border x:Name="NoHistoryBorder"
                        Background="#2A2A2A"
                        CornerRadius="12"
                        Padding="50,30"
                        Margin="0,0,0,20"
                        Effect="{StaticResource MaterialDesignElevationShadow1}"
                        Visibility="{Binding HistoryCount, Converter={StaticResource CountToVisibilityConverter}}">
                    <StackPanel HorizontalAlignment="Center">
                        <materialDesign:PackIcon Kind="History" 
                                               Width="56" 
                                               Height="56"
                                               Foreground="#666666"
                                               HorizontalAlignment="Center" />
                        <TextBlock Text="æš‚æ— å¯¼å…¥å¯¼å‡ºè®°å½•" 
                                 FontSize="18" 
                                 FontWeight="SemiBold"
                                 Foreground="#666666"
                                 HorizontalAlignment="Center"
                                 Margin="0,16,0,10" />
                        <TextBlock Text="æ‰§è¡Œå¯¼å…¥æˆ–å¯¼å‡ºæ“ä½œåŽå°†åœ¨æ­¤å¤„æ˜¾ç¤ºè®°å½•" 
                                 FontSize="13"
                                 Foreground="#888888"
                                 HorizontalAlignment="Center"
                                 TextWrapping="Wrap"
                                 TextAlignment="Center"
                                 MaxWidth="400"
                                 LineHeight="18" />
                    </StackPanel>
                </Border>
            </StackPanel>
        </ScrollViewer>
    </Grid>
</Page> 