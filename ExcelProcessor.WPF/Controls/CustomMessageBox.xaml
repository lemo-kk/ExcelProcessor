<UserControl x:Class="ExcelProcessor.WPF.Controls.CustomMessageBox"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             Width="400"
             Height="Auto"
             MinWidth="350"
             MinHeight="200"
             MaxWidth="600"
             MaxHeight="500">

    <UserControl.Resources>
        <!-- 消息框标题样式 -->
        <Style x:Key="MessageBoxTitleStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="16" />
            <Setter Property="FontWeight" Value="Bold" />
            <Setter Property="Foreground" Value="{StaticResource MaterialDesignBody}" />
            <Setter Property="Margin" Value="0,0,0,16" />
        </Style>

        <!-- 消息内容样式 -->
        <Style x:Key="MessageBoxContentStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="14" />
            <Setter Property="Foreground" Value="{StaticResource TextSecondaryBrush}" />
            <Setter Property="TextWrapping" Value="Wrap" />
            <Setter Property="Margin" Value="0,0,0,24" />
            <Setter Property="LineHeight" Value="20" />
        </Style>

        <!-- 按钮样式 -->
        <Style x:Key="MessageBoxButtonStyle" TargetType="Button" BasedOn="{StaticResource MaterialDesignRaisedButton}">
            <Setter Property="Padding" Value="20,8" />
            <Setter Property="FontSize" Value="13" />
            <Setter Property="Height" Value="36" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Margin" Value="8,0,0,0" />
        </Style>

        <!-- 确认按钮样式 -->
        <Style x:Key="ConfirmButtonStyle" TargetType="Button" BasedOn="{StaticResource MessageBoxButtonStyle}">
            <Setter Property="Background" Value="{StaticResource CyberBlueBrush}" />
            <Setter Property="Foreground" Value="White" />
        </Style>

        <!-- 取消按钮样式 -->
        <Style x:Key="CancelButtonStyle" TargetType="Button" BasedOn="{StaticResource MessageBoxButtonStyle}">
            <Setter Property="Background" Value="{StaticResource MaterialDesignDivider}" />
            <Setter Property="Foreground" Value="{StaticResource MaterialDesignBody}" />
        </Style>

        <!-- 警告按钮样式 -->
        <Style x:Key="WarningButtonStyle" TargetType="Button" BasedOn="{StaticResource MessageBoxButtonStyle}">
            <Setter Property="Background" Value="{StaticResource WarningOrangeBrush}" />
            <Setter Property="Foreground" Value="White" />
        </Style>

        <!-- 错误按钮样式 -->
        <Style x:Key="ErrorButtonStyle" TargetType="Button" BasedOn="{StaticResource MessageBoxButtonStyle}">
            <Setter Property="Background" Value="{StaticResource ErrorRedBrush}" />
            <Setter Property="Foreground" Value="White" />
        </Style>

        <!-- 信息按钮样式 -->
        <Style x:Key="InfoButtonStyle" TargetType="Button" BasedOn="{StaticResource MessageBoxButtonStyle}">
            <Setter Property="Background" Value="{StaticResource InfoColor}" />
            <Setter Property="Foreground" Value="White" />
        </Style>
    </UserControl.Resources>

    <Border Background="{StaticResource MaterialDesignPaper}" 
            CornerRadius="8"
            BorderBrush="{StaticResource MaterialDesignDivider}"
            BorderThickness="1"
            Effect="{StaticResource MaterialDesignElevationShadow8}">
        
        <Grid Margin="24">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>

            <!-- 图标和标题 -->
            <StackPanel Grid.Row="0" 
                        Orientation="Horizontal" 
                        HorizontalAlignment="Left"
                        Margin="0,0,0,16">
                
                <!-- 信息图标 -->
                <materialDesign:PackIcon x:Name="InfoIcon" 
                                       Kind="Information" 
                                       Width="24" 
                                       Height="24"
                                       Foreground="{StaticResource InfoColor}"
                                       VerticalAlignment="Center"
                                       Margin="0,0,12,0"
                                       Visibility="Collapsed" />
                
                <!-- 警告图标 -->
                <materialDesign:PackIcon x:Name="WarningIcon" 
                                       Kind="AlertCircle" 
                                       Width="24" 
                                       Height="24"
                                       Foreground="{StaticResource WarningOrangeBrush}"
                                       VerticalAlignment="Center"
                                       Margin="0,0,12,0"
                                       Visibility="Collapsed" />
                
                <!-- 错误图标 -->
                <materialDesign:PackIcon x:Name="ErrorIcon" 
                                       Kind="CloseCircle" 
                                       Width="24" 
                                       Height="24"
                                       Foreground="{StaticResource ErrorRedBrush}"
                                       VerticalAlignment="Center"
                                       Margin="0,0,12,0"
                                       Visibility="Collapsed" />
                
                <!-- 成功图标 -->
                <materialDesign:PackIcon x:Name="SuccessIcon" 
                                       Kind="CheckCircle" 
                                       Width="24" 
                                       Height="24"
                                       Foreground="{StaticResource SuccessColor}"
                                       VerticalAlignment="Center"
                                       Margin="0,0,12,0"
                                       Visibility="Collapsed" />
                
                <!-- 问题图标 -->
                <materialDesign:PackIcon x:Name="QuestionIcon" 
                                       Kind="HelpCircle" 
                                       Width="24" 
                                       Height="24"
                                       Foreground="{StaticResource CyberBlueBrush}"
                                       VerticalAlignment="Center"
                                       Margin="0,0,12,0"
                                       Visibility="Collapsed" />

                <TextBlock x:Name="TitleText" 
                          Text="消息" 
                          Style="{StaticResource MessageBoxTitleStyle}" />
            </StackPanel>

            <!-- 消息内容 -->
            <ScrollViewer Grid.Row="1" 
                          VerticalScrollBarVisibility="Auto"
                          HorizontalScrollBarVisibility="Disabled">
                <TextBlock x:Name="ContentText" 
                          Text="消息内容" 
                          Style="{StaticResource MessageBoxContentStyle}" />
            </ScrollViewer>

            <!-- 按钮区域 -->
            <StackPanel Grid.Row="2" 
                        Orientation="Horizontal" 
                        HorizontalAlignment="Right"
                        Margin="0,16,0,0">
                
                <!-- 确定按钮 -->
                <Button x:Name="OkButton" 
                        Content="确定" 
                        Style="{StaticResource ConfirmButtonStyle}"
                        Click="OkButton_Click"
                        Visibility="Collapsed" />
                
                <!-- 是按钮 -->
                <Button x:Name="YesButton" 
                        Content="是" 
                        Style="{StaticResource ConfirmButtonStyle}"
                        Click="YesButton_Click"
                        Visibility="Collapsed" />
                
                <!-- 否按钮 -->
                <Button x:Name="NoButton" 
                        Content="否" 
                        Style="{StaticResource CancelButtonStyle}"
                        Click="NoButton_Click"
                        Visibility="Collapsed" />
                
                <!-- 取消按钮 -->
                <Button x:Name="CancelButton" 
                        Content="取消" 
                        Style="{StaticResource CancelButtonStyle}"
                        Click="CancelButton_Click"
                        Visibility="Collapsed" />
                
                <!-- 重试按钮 -->
                <Button x:Name="RetryButton" 
                        Content="重试" 
                        Style="{StaticResource WarningButtonStyle}"
                        Click="RetryButton_Click"
                        Visibility="Collapsed" />
                
                <!-- 忽略按钮 -->
                <Button x:Name="IgnoreButton" 
                        Content="忽略" 
                        Style="{StaticResource CancelButtonStyle}"
                        Click="IgnoreButton_Click"
                        Visibility="Collapsed" />
            </StackPanel>
        </Grid>
    </Border>
</UserControl> 