<UserControl x:Class="ExcelProcessor.WPF.Controls.SqlEditor"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:avalonedit="http://icsharpcode.net/sharpdevelop/avalonedit">

    <UserControl.Resources>
        <!-- SQL编辑器样式 -->
        <Style x:Key="SqlEditorStyle" TargetType="{x:Type avalonedit:TextEditor}">
            <Setter Property="Background" Value="#1E1E1E" />
            <Setter Property="Foreground" Value="#D4D4D4" />
            <Setter Property="FontFamily" Value="Consolas, 'Courier New', monospace" />
            <Setter Property="FontSize" Value="14" />
            <Setter Property="LineNumbersForeground" Value="#858585" />
            <Setter Property="ShowLineNumbers" Value="True" />
            <Setter Property="WordWrap" Value="False" />
            <Setter Property="HorizontalScrollBarVisibility" Value="Auto" />
            <Setter Property="VerticalScrollBarVisibility" Value="Auto" />
            <Setter Property="IsReadOnly" Value="False" />
            <Setter Property="BorderBrush" Value="#404040" />
            <Setter Property="BorderThickness" Value="1" />
        </Style>
    </UserControl.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <!-- 编辑器工具栏 -->
        <Border Grid.Row="0" 
                Background="#2A2A2A" 
                BorderBrush="#404040" 
                BorderThickness="0,0,0,1"
                Padding="8,4">
            <StackPanel Orientation="Horizontal">
                <!-- 格式化按钮 -->
                <Button x:Name="FormatButton"
                        Content="🎨 格式化"
                        ToolTip="格式化SQL语句"
                        Padding="8,4"
                        FontSize="12"
                        Background="#404040"
                        Foreground="#E0E0E0"
                        BorderThickness="0"
                        Margin="0,0,8,0"
                        Click="FormatButton_Click" />

                <!-- 语法检查按钮 -->
                <Button x:Name="ValidateButton"
                        Content="✓ 语法检查"
                        ToolTip="检查SQL语法"
                        Padding="8,4"
                        FontSize="12"
                        Background="#404040"
                        Foreground="#E0E0E0"
                        BorderThickness="0"
                        Margin="0,0,8,0"
                        Click="ValidateButton_Click" />

                <!-- 全屏编辑按钮 -->
                <Button x:Name="FullScreenButton"
                        Content="⛶ 全屏"
                        ToolTip="全屏编辑模式"
                        Padding="8,4"
                        FontSize="12"
                        Background="#404040"
                        Foreground="#E0E0E0"
                        BorderThickness="0"
                        Margin="0,0,8,0"
                        Click="FullScreenButton_Click" />

                <!-- 分隔符 -->
                <Rectangle Width="1" 
                          Height="20" 
                          Fill="#606060" 
                          Margin="8,0" />

                <!-- 字体大小控制 -->
                <TextBlock Text="字体:" 
                          VerticalAlignment="Center"
                          Foreground="#E0E0E0"
                          FontSize="12"
                          Margin="0,0,4,0" />
                
                <ComboBox x:Name="FontSizeComboBox"
                          Width="60"
                          FontSize="12"
                          Background="#404040"
                          Foreground="#E0E0E0"
                          BorderBrush="#606060"
                          SelectionChanged="FontSizeComboBox_SelectionChanged">
                    <ComboBoxItem Content="10" />
                    <ComboBoxItem Content="12" />
                    <ComboBoxItem Content="14" IsSelected="True" />
                    <ComboBoxItem Content="16" />
                    <ComboBoxItem Content="18" />
                    <ComboBoxItem Content="20" />
                </ComboBox>

                <!-- 状态信息 -->
                <TextBlock x:Name="StatusText"
                          Text="就绪"
                          VerticalAlignment="Center"
                          Foreground="#888888"
                          FontSize="11"
                          Margin="16,0,0,0" />
            </StackPanel>
        </Border>

        <!-- SQL编辑器主体 -->
        <avalonedit:TextEditor Grid.Row="1"
                               x:Name="SqlTextEditor"
                               Style="{StaticResource SqlEditorStyle}"
                               TextChanged="SqlTextEditor_TextChanged"
                               MouseRightButtonDown="SqlTextEditor_MouseRightButtonDown">
            
            <!-- 右键菜单 -->
            <avalonedit:TextEditor.ContextMenu>
                <ContextMenu Background="#2A2A2A" 
                            Foreground="#E0E0E0"
                            BorderBrush="#404040">
                    <MenuItem Header="剪切" 
                             InputGestureText="Ctrl+X"
                             Click="Cut_Click">
                        <MenuItem.Icon>
                            <TextBlock Text="✂" FontSize="14" />
                        </MenuItem.Icon>
                    </MenuItem>
                    <MenuItem Header="复制" 
                             InputGestureText="Ctrl+C"
                             Click="Copy_Click">
                        <MenuItem.Icon>
                            <TextBlock Text="📋" FontSize="14" />
                        </MenuItem.Icon>
                    </MenuItem>
                    <MenuItem Header="粘贴" 
                             InputGestureText="Ctrl+V"
                             Click="Paste_Click">
                        <MenuItem.Icon>
                            <TextBlock Text="📄" FontSize="14" />
                        </MenuItem.Icon>
                    </MenuItem>
                    <Separator />
                    <MenuItem Header="全选" 
                             InputGestureText="Ctrl+A"
                             Click="SelectAll_Click">
                        <MenuItem.Icon>
                            <TextBlock Text="🔲" FontSize="14" />
                        </MenuItem.Icon>
                    </MenuItem>
                    <Separator />
                    <MenuItem Header="格式化代码" 
                             InputGestureText="Ctrl+Shift+F"
                             Click="Format_Click">
                        <MenuItem.Icon>
                            <TextBlock Text="🎨" FontSize="14" />
                        </MenuItem.Icon>
                    </MenuItem>
                    <MenuItem Header="注释/取消注释" 
                             InputGestureText="Ctrl+/"
                             Click="ToggleComment_Click">
                        <MenuItem.Icon>
                            <TextBlock Text="💬" FontSize="14" />
                        </MenuItem.Icon>
                    </MenuItem>
                </ContextMenu>
            </avalonedit:TextEditor.ContextMenu>
        </avalonedit:TextEditor>

        <!-- 状态栏 -->
        <Border Grid.Row="2" 
                Background="#252525" 
                BorderBrush="#404040" 
                BorderThickness="0,1,0,0"
                Padding="8,4">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <!-- 左侧状态信息 -->
                <StackPanel Grid.Column="0" Orientation="Horizontal">
                    <TextBlock x:Name="LineColumnText"
                              Text="行: 1, 列: 1"
                              Foreground="#888888"
                              FontSize="11"
                              Margin="0,0,16,0" />
                    
                    <TextBlock x:Name="LengthText"
                              Text="长度: 0"
                              Foreground="#888888"
                              FontSize="11"
                              Margin="0,0,16,0" />

                    <TextBlock x:Name="SyntaxStatusText"
                              Text="语法: 正常"
                              Foreground="#4CAF50"
                              FontSize="11" />
                </StackPanel>

                <!-- 右侧编码信息 -->
                <StackPanel Grid.Column="1" Orientation="Horizontal">
                    <TextBlock Text="UTF-8"
                              Foreground="#888888"
                              FontSize="11"
                              Margin="0,0,16,0" />
                    
                    <TextBlock Text="SQL"
                              Foreground="#888888"
                              FontSize="11" />
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</UserControl> 