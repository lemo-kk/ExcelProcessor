<?xml version="1.0" encoding="utf-8"?>
<Window x:Class="ExcelProcessor.WPF.Controls.ImportProgressDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="数据导入进度"
        Width="560"
        Height="360"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize"
        ShowInTaskbar="False"
        WindowStyle="SingleBorderWindow"
        Background="{StaticResource MaterialDesignPaper}"
        TextElement.Foreground="{StaticResource MaterialDesignBody}"
        TextElement.FontWeight="Regular"
        TextElement.FontSize="13"
        TextOptions.TextFormattingMode="Ideal"
        TextOptions.TextRenderingMode="Auto"
        FontFamily="{StaticResource MaterialDesignFont}">
    
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>
        
        <!-- Progress Content -->
        <Grid x:Name="ProgressView">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>

            <!-- Header -->
            <Border Grid.Row="0" CornerRadius="8" Padding="16" Background="{StaticResource MaterialDesignCardBackground}">
                <DockPanel>
                    <TextBlock x:Name="TitleText"
                   Text="正在导入Excel数据..."
                               FontSize="18"
                               FontWeight="Medium"
                               VerticalAlignment="Center" />
                </DockPanel>
            </Border>

            <!-- Progress Bar and Percent -->
            <Border Grid.Row="1" CornerRadius="8" Padding="16" Margin="0,12,0,0" Background="{StaticResource MaterialDesignCardBackground}">
                <DockPanel LastChildFill="True">
                    <TextBlock x:Name="PercentText"
                               Text=""
                               Width="64"
                               HorizontalAlignment="Right"
                               VerticalAlignment="Center"
                               Margin="0,0,8,0">
                        <TextBlock.Style>
                            <Style TargetType="TextBlock">
                                <Setter Property="Visibility" Value="Visible" />
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding IsIndeterminate, ElementName=ProgressBar}" Value="True">
                                        <Setter Property="Visibility" Value="Collapsed" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </TextBlock.Style>
                    </TextBlock>
                    <ProgressBar x:Name="ProgressBar"
                                 Height="4"
                                 Foreground="{DynamicResource PrimaryHueMidBrush}"
                     IsIndeterminate="True"
                                 Minimum="0"
                                 Maximum="100"/>
                </DockPanel>
            </Border>

            <!-- Status line (primary message) -->
            <Border Grid.Row="2" CornerRadius="8" Padding="12" Margin="0,12,0,0" Background="{StaticResource MaterialDesignCardBackground}">
                <TextBlock x:Name="ProgressText"
                   Text="正在读取Excel文件..."
                           FontSize="13"
                           TextAlignment="Center" />
            </Border>
        
            <!-- Stats row -->
            <Border Grid.Row="3" CornerRadius="8" Padding="12" Margin="0,12,0,0" Background="{StaticResource MaterialDesignCardBackground}">
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                    <StackPanel Orientation="Horizontal" Margin="0,0,16,0">
                        <TextBlock Text="总行数:" FontSize="12" FontWeight="SemiBold" />
                        <TextBlock x:Name="TotalRowsText" Text="0" FontSize="12" Margin="4,0,0,0" />
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,0,16,0">
                        <TextBlock Text="已处理:" FontSize="12" FontWeight="SemiBold" />
                        <TextBlock x:Name="ProcessedRowsText" Text="0" FontSize="12" Margin="4,0,0,0" />
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,0,16,0">
                        <TextBlock Text="成功:" FontSize="12" FontWeight="SemiBold" Foreground="{StaticResource SuccessColor}" />
                        <TextBlock x:Name="SuccessRowsText" Text="0" FontSize="12" Foreground="{StaticResource SuccessColor}" Margin="4,0,0,0" />
                    </StackPanel>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="失败:" FontSize="12" FontWeight="SemiBold" Foreground="{StaticResource DangerColor}" />
                        <TextBlock x:Name="FailedRowsText" Text="0" FontSize="12" Foreground="{StaticResource DangerColor}" Margin="4,0,0,0" />
                    </StackPanel>
        </StackPanel>
            </Border>
        
            <!-- Details area -->
            <Border Grid.Row="4" CornerRadius="8" Padding="12" Margin="0,12,0,0" Background="{StaticResource MaterialDesignCardBackground}">
                <StackPanel>
                    <TextBlock x:Name="CurrentRowText"
                   Text=""
                               FontSize="12"
                   Foreground="#666666"
                               TextAlignment="Center"
                               Margin="0,0,0,8" />
        
                    <TextBlock x:Name="BatchInfoText"
                   Text=""
                               FontSize="12"
                   Foreground="#666666"
                               TextAlignment="Center"
                               Margin="0,0,0,8" />
        
                    <TextBlock x:Name="StatusText"
                   Text="请稍候，正在导入数据..."
                   FontSize="12"
                   Foreground="#666666"
                               TextAlignment="Center"
                   TextWrapping="Wrap" />
                </StackPanel>
            </Border>
        </Grid>
    </Grid>
</Window> 