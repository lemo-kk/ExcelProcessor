<?xml version="1.0" encoding="utf-8"?>
<UserControl x:Class="ExcelProcessor.WPF.Controls.SqlManagementPage"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             xmlns:local="clr-namespace:ExcelProcessor.WPF.Controls">

    <UserControl.Resources>
        <!-- SQLç®¡ç†é¡µé¢æ ·å¼ -->
        <Style x:Key="SqlPageStyle" TargetType="Border">
            <Setter Property="Background" Value="#1A1A1A" />
            <Setter Property="CornerRadius" Value="8" />
            <Setter Property="Padding" Value="20" />
            <Setter Property="Margin" Value="0,0,0,20" />
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect Color="Black" BlurRadius="6" ShadowDepth="2" Opacity="0.3" />
                </Setter.Value>
            </Setter>
        </Style>

        <!-- é¡µé¢æ ‡é¢˜æ ·å¼ -->
        <Style x:Key="PageTitleStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="20" />
            <Setter Property="FontWeight" Value="Bold" />
            <Setter Property="Foreground" Value="{StaticResource CyberBlueBrush}" />
            <Setter Property="Margin" Value="0,0,0,20" />
        </Style>

        <!-- åˆ†ç»„æ ‡é¢˜æ ·å¼ -->
        <Style x:Key="GroupTitleStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="16" />
            <Setter Property="FontWeight" Value="SemiBold" />
            <Setter Property="Foreground" Value="{StaticResource CyberBlueBrush}" />
            <Setter Property="Margin" Value="0,0,0,16" />
        </Style>

        <!-- æ ‡ç­¾æ ·å¼ -->
        <Style x:Key="LabelStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="13" />
            <Setter Property="FontWeight" Value="SemiBold" />
            <Setter Property="Foreground" Value="#E0E0E0" />
            <Setter Property="Margin" Value="0,0,0,6" />
            <Setter Property="MinWidth" Value="120" />
            <Setter Property="TextWrapping" Value="Wrap" />
        </Style>

        <!-- è¾“å…¥æ¡†æ ·å¼ -->
        <Style x:Key="InputStyle" TargetType="TextBox" BasedOn="{StaticResource MaterialDesignOutlinedTextBox}">
            <Setter Property="FontSize" Value="13" />
            <Setter Property="Height" Value="40" />
            <Setter Property="MinWidth" Value="200" />
            <Setter Property="Background" Value="#2A2A2A" />
            <Setter Property="Foreground" Value="#E0E0E0" />
            <Setter Property="BorderBrush" Value="#404040" />
            <Setter Property="CaretBrush" Value="{StaticResource CyberBlueBrush}" />
            <Setter Property="VerticalAlignment" Value="Center" />
            <Setter Property="VerticalContentAlignment" Value="Center" />
            <Setter Property="Padding" Value="12,8" />
        </Style>

        <!-- å¤šè¡Œè¾“å…¥æ¡†æ ·å¼ -->
        <Style x:Key="MultiLineInputStyle" TargetType="TextBox" BasedOn="{StaticResource MaterialDesignOutlinedTextBox}">
            <Setter Property="FontSize" Value="13" />
            <Setter Property="MinWidth" Value="300" />
            <Setter Property="MinHeight" Value="100" />
            <Setter Property="Height" Value="Auto" />
            <Setter Property="MaxHeight" Value="900" />
            <Setter Property="Background" Value="#2A2A2A" />
            <Setter Property="Foreground" Value="#E0E0E0" />
            <Setter Property="BorderBrush" Value="#404040" />
            <Setter Property="CaretBrush" Value="{StaticResource CyberBlueBrush}" />
            <Setter Property="AcceptsReturn" Value="True" />
            <Setter Property="TextWrapping" Value="Wrap" />
            <Setter Property="VerticalScrollBarVisibility" Value="Auto" />
            <Setter Property="Padding" Value="8,12" />
        </Style>

        <!-- ä¸‹æ‹‰æ¡†æ ·å¼ -->
        <Style x:Key="ComboBoxStyle" TargetType="ComboBox" BasedOn="{StaticResource MaterialDesignOutlinedComboBox}">
            <Setter Property="FontSize" Value="13" />
            <Setter Property="FontFamily" Value="Microsoft YaHei" />
            <Setter Property="FontWeight" Value="Normal" />
            <Setter Property="MinHeight" Value="40" />
            <Setter Property="Height" Value="Auto" />
            <Setter Property="MinWidth" Value="200" />
            <Setter Property="Background" Value="#2A2A2A" />
            <Setter Property="Foreground" Value="#E0E0E0" />
            <Setter Property="BorderBrush" Value="#404040" />
            <Setter Property="MaxDropDownHeight" Value="200" />
            <Setter Property="ScrollViewer.VerticalScrollBarVisibility" Value="Auto" />
            <Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Auto" />
            <Setter Property="Padding" Value="8,8" />
            <Setter Property="ItemContainerStyle">
                <Setter.Value>
                    <Style TargetType="ComboBoxItem">
                        <Setter Property="Padding" Value="8,8" />
                        <Setter Property="FontSize" Value="13" />
                        <Setter Property="FontFamily" Value="Microsoft YaHei" />
                        <Setter Property="FontWeight" Value="Normal" />
                        <Setter Property="Foreground" Value="#E0E0E0" />
                        <Setter Property="Background" Value="Transparent" />
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="ComboBoxItem">
                                    <Border Background="{TemplateBinding Background}"
                                            Padding="{TemplateBinding Padding}">
                                        <ContentPresenter HorizontalAlignment="Left" 
                                                        VerticalAlignment="Center" />
                                    </Border>
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="IsHighlighted" Value="True">
                                            <Setter Property="Background" Value="#404040" />
                                            <Setter Property="Foreground" Value="#E0E0E0" />
                                        </Trigger>
                                        <Trigger Property="IsSelected" Value="True">
                                            <Setter Property="Background" Value="#505050" />
                                            <Setter Property="Foreground" Value="#E0E0E0" />
                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </Style>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- æŒ‰é’®æ ·å¼ -->
        <Style x:Key="ButtonStyle" TargetType="Button" BasedOn="{StaticResource MaterialDesignRaisedButton}">
            <Setter Property="Padding" Value="16,8" />
            <Setter Property="FontSize" Value="12" />
            <Setter Property="FontWeight" Value="SemiBold" />
            <Setter Property="Height" Value="36" />
            <Setter Property="MinWidth" Value="80" />
            <Setter Property="Margin" Value="0,0,8,0" />
        </Style>

        <!-- æ•°æ®ç½‘æ ¼æ ·å¼ -->
        <Style x:Key="DataGridStyle" TargetType="DataGrid">
            <Setter Property="Background" Value="#2A2A2A" />
            <Setter Property="Foreground" Value="#E0E0E0" />
            <Setter Property="BorderBrush" Value="#404040" />
            <Setter Property="GridLinesVisibility" Value="Horizontal" />
            <Setter Property="HorizontalGridLinesBrush" Value="#404040" />
            <Setter Property="RowBackground" Value="#2A2A2A" />
            <Setter Property="AlternatingRowBackground" Value="#252525" />
            <Setter Property="HeadersVisibility" Value="Column" />
            <Setter Property="AutoGenerateColumns" Value="False" />
            <Setter Property="CanUserAddRows" Value="False" />
            <Setter Property="CanUserDeleteRows" Value="False" />
            <Setter Property="SelectionMode" Value="Single" />
            <Setter Property="SelectionUnit" Value="FullRow" />
        </Style>

        <!-- é…ç½®å¤é€‰æ¡†æ ·å¼ -->
        <Style x:Key="ConfigCheckBoxStyle" TargetType="CheckBox">
            <Setter Property="FontSize" Value="12" />
            <Setter Property="Foreground" Value="#E0E0E0" />
            <Setter Property="Margin" Value="0,0,0,8" />
        </Style>

        <!-- å‚æ•°é¡¹æ ·å¼ -->
        <Style x:Key="ParameterItemStyle" TargetType="Border">
            <Setter Property="Background" Value="#2A2A2A" />
            <Setter Property="CornerRadius" Value="8" />
            <Setter Property="BorderBrush" Value="#404040" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="Padding" Value="12" />
            <Setter Property="Margin" Value="0,0,0,12" />
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect Color="Black" BlurRadius="4" ShadowDepth="2" Opacity="0.3" />
                </Setter.Value>
            </Setter>
        </Style>

        <!-- å‚æ•°æ ‡é¢˜æ ·å¼ -->
        <Style x:Key="ParameterTitleStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="13" />
            <Setter Property="FontWeight" Value="SemiBold" />
            <Setter Property="Foreground" Value="#E0E0E0" />
            <Setter Property="Margin" Value="0,0,0,8" />
        </Style>

        <!-- å‚æ•°æ ‡ç­¾æ ·å¼ -->
        <Style x:Key="ParameterLabelStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="11" />
            <Setter Property="FontWeight" Value="Medium" />
            <Setter Property="Foreground" Value="#CCCCCC" />
            <Setter Property="VerticalAlignment" Value="Center" />
            <Setter Property="Margin" Value="0,0,8,0" />
        </Style>

        <!-- å‚æ•°è¾“å…¥æ¡†æ ·å¼ -->
        <Style x:Key="ParameterInputStyle" TargetType="TextBox">
            <Setter Property="FontSize" Value="11" />
            <Setter Property="MinHeight" Value="32" />
            <Setter Property="Height" Value="Auto" />
            <Setter Property="MaxHeight" Value="80" />
            <Setter Property="TextWrapping" Value="Wrap" />
            <Setter Property="VerticalScrollBarVisibility" Value="Auto" />
            <Setter Property="AcceptsReturn" Value="True" />
            <Setter Property="Background" Value="#1A1A1A" />
            <Setter Property="Foreground" Value="#E0E0E0" />
            <Setter Property="BorderBrush" Value="#404040" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="Padding" Value="8,6" />
            <Setter Property="VerticalContentAlignment" Value="Center" />
        </Style>

        <!-- å±é™©æŒ‰é’®æ ·å¼ -->
        <Style x:Key="DangerButtonStyle" TargetType="Button">
            <Setter Property="Padding" Value="8,4" />
            <Setter Property="FontSize" Value="10" />
            <Setter Property="Height" Value="24" />
            <Setter Property="Foreground" Value="#FF6B6B" />
            <Setter Property="Background" Value="#2A2A2A" />
            <Setter Property="BorderBrush" Value="#FF6B6B" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="Cursor" Value="Hand" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="6">
                            <ContentPresenter HorizontalAlignment="Center" 
                                            VerticalAlignment="Center" />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#FF6B6B" />
                                <Setter Property="Foreground" Value="White" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- åˆ†ç±»æ ‡ç­¾æ ·å¼ -->
        <Style x:Key="CategoryTagStyle" TargetType="Border">
            <Setter Property="Background" Value="#2A2A2A" />
            <Setter Property="CornerRadius" Value="12" />
            <Setter Property="BorderBrush" Value="#404040" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="Padding" Value="8,4" />
            <Setter Property="Margin" Value="0,0,8,8" />
            <Setter Property="Cursor" Value="Hand" />
        </Style>

        <!-- åˆ†ç±»æ ‡ç­¾æ–‡æœ¬æ ·å¼ -->
        <Style x:Key="CategoryTagTextStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="11" />
            <Setter Property="Foreground" Value="#CCCCCC" />
            <Setter Property="FontWeight" Value="SemiBold" />
        </Style>
    </UserControl.Resources>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="320" MinWidth="280" MaxWidth="400" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>

        <!-- å·¦ä¾§ï¼šSQLåˆ†ç±»å’Œåˆ—è¡¨ -->
        <Border Grid.Column="0" Style="{StaticResource SqlPageStyle}" Margin="0,0,10,0">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>
                
                <!-- æ ‡é¢˜ -->
                <TextBlock Grid.Row="0" Text="SQLç®¡ç†" Style="{StaticResource PageTitleStyle}" />
                
                <!-- SQLåˆ†ç±» -->
                <Border Grid.Row="1" Style="{StaticResource SqlPageStyle}">
                    <StackPanel>
                        <Grid Margin="0,0,0,16">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            
                            <TextBlock Grid.Column="0"
                                     Text="SQLåˆ†ç±»" 
                                     Style="{StaticResource GroupTitleStyle}" />
                            
                            <Button Grid.Column="1"
                                  x:Name="AddCategoryButton"
                                  Content="+"
                                  Style="{StaticResource ButtonStyle}"
                                  Background="{StaticResource SuccessColor}"
                                  Foreground="White"
                                  Padding="8,4"
                                  FontSize="12"
                                  FontWeight="Bold"
                                  Height="36"
                                  Width="36"
                                  Margin="8,0,0,0"
                                  ToolTip="æ·»åŠ æ–°åˆ†ç±»" />
                        </Grid>

                        <!-- åˆ†ç±»æ ‡ç­¾ -->
                        <WrapPanel x:Name="CategoryTagsPanel">
                            <Border Style="{StaticResource CategoryTagStyle}" 
                                  Background="{StaticResource CyberBlueBrush}">
                                <TextBlock Text="å…¨éƒ¨" Style="{StaticResource CategoryTagTextStyle}" 
                                         Foreground="White" />
                            </Border>
                            <Border Style="{StaticResource CategoryTagStyle}">
                                <TextBlock Text="æ•°æ®æŸ¥è¯¢" Style="{StaticResource CategoryTagTextStyle}" />
                            </Border>
                            <Border Style="{StaticResource CategoryTagStyle}">
                                <TextBlock Text="æ•°æ®ç»Ÿè®¡" Style="{StaticResource CategoryTagTextStyle}" />
                            </Border>
                            <Border Style="{StaticResource CategoryTagStyle}">
                                <TextBlock Text="æŠ¥è¡¨ç”Ÿæˆ" Style="{StaticResource CategoryTagTextStyle}" />
                            </Border>
                            <Border Style="{StaticResource CategoryTagStyle}">
                                <TextBlock Text="æ•°æ®æ¸…æ´—" Style="{StaticResource CategoryTagTextStyle}" />
                            </Border>
                        </WrapPanel>
                    </StackPanel>
                </Border>

                <!-- æœç´¢æ¡† -->
                <TextBox Grid.Row="2" x:Name="SearchTextBox"
                       Style="{StaticResource InputStyle}"
                       materialDesign:HintAssist.Hint="æœç´¢SQL..."
                       Margin="0,0,0,16" />

                <!-- SQLåˆ—è¡¨ -->
                <DataGrid Grid.Row="3" x:Name="SqlListDataGrid"
                        Style="{StaticResource DataGridStyle}"
                        MinHeight="200"
                        MaxHeight="400"
                        Margin="0,0,0,16"
                        SelectionChanged="SqlListDataGrid_SelectionChanged">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="SQLåç§°" Binding="{Binding Name}" Width="*" />
                        <DataGridTextColumn Header="åˆ†ç±»" Binding="{Binding Category}" Width="60" />
                        <DataGridTextColumn Header="ç±»åž‹" Binding="{Binding OutputType}" Width="60" />
                    </DataGrid.Columns>
                </DataGrid>

                <!-- æ“ä½œæŒ‰é’® -->
                <StackPanel Grid.Row="4" Orientation="Horizontal">
                    <Button x:Name="AddSqlButton"
                          Content="æ–°å¢žSQL"
                          Style="{StaticResource ButtonStyle}"
                          Background="{StaticResource SuccessColor}"
                          Foreground="White"
                          Click="AddSqlButton_Click" />
                    
                    <Button x:Name="DeleteSqlButton"
                          Content="åˆ é™¤SQL"
                          Style="{StaticResource ButtonStyle}"
                          Background="{StaticResource DangerColor}"
                          Foreground="White"
                          Click="DeleteSqlButton_Click" />
                </StackPanel>
            </Grid>
        </Border>

        <!-- å³ä¾§ï¼šSQLè¯¦æƒ…å’Œé…ç½® -->
        <Border Grid.Column="1" Style="{StaticResource SqlPageStyle}" Margin="10,0,0,0">
            <ScrollViewer VerticalScrollBarVisibility="Auto">
                <StackPanel>
                    <!-- é¡µé¢å¤´éƒ¨ -->
                    <Grid Margin="0,0,0,20">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        
                        <StackPanel Grid.Column="0">
                            <TextBlock Text="SQLè¯¦æƒ…ä¸Žé…ç½®" Style="{StaticResource PageTitleStyle}" />
                            <TextBlock Text="é…ç½®å’Œç®¡ç†SQLæŸ¥è¯¢è¯­å¥åŠå…¶æ‰§è¡Œå‚æ•°" 
                                     FontSize="12" 
                                     Foreground="#AAAAAA" 
                                     Margin="0,-15,0,0" />
                        </StackPanel>
                        
                        <StackPanel Grid.Column="1" Orientation="Horizontal">
                            <Button x:Name="SaveSqlButton"
                                  Content="ä¿å­˜SQL"
                                  Style="{StaticResource ButtonStyle}"
                                  Background="{StaticResource SuccessColor}"
                                  Foreground="White"
                                  Click="SaveSqlButton_Click" />
                        </StackPanel>
                    </Grid>
                    
                    <!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="3*" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        
                        <!-- å·¦ä¾§ï¼šä¸»è¦é…ç½® -->
                        <StackPanel Grid.Column="0" Margin="0,0,10,0">
                            <!-- SQLåŸºæœ¬ä¿¡æ¯å¡ç‰‡ -->
                            <Border Style="{StaticResource SqlPageStyle}" Margin="0,0,0,15">
                                <StackPanel>
                                    <Grid Margin="0,0,0,16">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        
                                        <TextBlock Grid.Column="0"
                                                 Text="åŸºæœ¬ä¿¡æ¯" 
                                                 Style="{StaticResource GroupTitleStyle}" />
                                        
                                        <Border Grid.Column="1" 
                                              Background="#2A2A2A" 
                                              CornerRadius="4" 
                                              Padding="6,2">
                                            <TextBlock Text="å¿…å¡«" 
                                                     FontSize="10" 
                                                     Foreground="#FF6B6B" 
                                                     FontWeight="Bold" />
                                        </Border>
                                    </Grid>
                                    
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                        </Grid.RowDefinitions>

                                        <!-- SQLåç§° -->
                                        <StackPanel Grid.Row="0" Grid.Column="0" Margin="0,0,8,0">
                                            <TextBlock Text="SQLåç§°" Style="{StaticResource LabelStyle}" />
                                            <TextBox x:Name="SqlNameTextBox"
                                                   Style="{StaticResource InputStyle}"
                                                   materialDesign:HintAssist.Hint="è¯·è¾“å…¥SQLåç§°" />
                                        </StackPanel>

                                        <!-- SQLåˆ†ç±» -->
                                        <StackPanel Grid.Row="0" Grid.Column="1" Margin="8,0,8,0">
                                            <TextBlock Text="SQLåˆ†ç±»" Style="{StaticResource LabelStyle}" />
                                            <ComboBox x:Name="CategoryComboBox"
                                                    Style="{StaticResource ComboBoxStyle}"
                                                    FontFamily="Microsoft YaHei"
                                                    materialDesign:HintAssist.Hint="è¯·é€‰æ‹©åˆ†ç±»">
                                                <ComboBoxItem Content="æ•°æ®æŸ¥è¯¢" />
                                                <ComboBoxItem Content="æ•°æ®ç»Ÿè®¡" />
                                                <ComboBoxItem Content="æŠ¥è¡¨ç”Ÿæˆ" />
                                                <ComboBoxItem Content="æ•°æ®æ¸…æ´—" />
                                            </ComboBox>
                                        </StackPanel>

                                        <!-- æŸ¥è¯¢æ•°æ®æº -->
                                        <StackPanel Grid.Row="0" Grid.Column="2" Margin="0,0,0,0">
                                            <TextBlock Text="æŸ¥è¯¢æ•°æ®æº" Style="{StaticResource LabelStyle}" />
                                            <ComboBox x:Name="QueryDataSourceComboBox"
                                                    Style="{StaticResource ComboBoxStyle}"
                                                    FontFamily="Microsoft YaHei"
                                                    materialDesign:HintAssist.Hint="è¯·é€‰æ‹©æŸ¥è¯¢æ•°æ®æº"
                                                    SelectionChanged="QueryDataSourceComboBox_SelectionChanged" />
                                        </StackPanel>

                                        <!-- è¾“å‡ºæ•°æ®æº - å·²éšè—ï¼Œä¸å†éœ€è¦ -->
                                        <StackPanel Grid.Row="1" Grid.Column="2" Margin="0,16,0,0" x:Name="OutputDataSourcePanel" Visibility="Collapsed">
                                            <!-- æ­¤é¢æ¿å·²éšè—ï¼Œä¸å†æ˜¾ç¤ºè¾“å‡ºæ•°æ®æºå­—æ®µ -->
                                        </StackPanel>

                                        <!-- è¾“å‡ºç±»åž‹ -->
                                        <StackPanel Grid.Row="1" Grid.Column="0" Margin="0,16,8,0">
                                            <TextBlock Text="è¾“å‡ºç±»åž‹" Style="{StaticResource LabelStyle}" />
                                            <ComboBox x:Name="OutputTypeComboBox"
                                                    Style="{StaticResource ComboBoxStyle}"
                                                    FontFamily="Microsoft YaHei"
                                                    materialDesign:HintAssist.Hint="è¯·é€‰æ‹©è¾“å‡ºç±»åž‹"
                                                    SelectionChanged="OutputTypeComboBox_SelectionChanged">
                                                <ComboBoxItem Content="æ•°æ®è¡¨" />
                                                <ComboBoxItem Content="Excelå·¥ä½œè¡¨" />
                                            </ComboBox>
                                        </StackPanel>

                                        <!-- æ•°æ®è¡¨é…ç½®é¢æ¿ -->
                                        <StackPanel Grid.Row="1" Grid.Column="1" Margin="8,16,0,0" x:Name="DataTablePanel">
                                            <TextBlock Text="ç›®æ ‡æ•°æ®æº" Style="{StaticResource LabelStyle}" />
                                            <ComboBox x:Name="DataSourceComboBox"
                                                    Style="{StaticResource ComboBoxStyle}"
                                                    FontFamily="Microsoft YaHei"
                                                    materialDesign:HintAssist.Hint="è¯·é€‰æ‹©æ•°æ®æº" />
                                        </StackPanel>

                                        <!-- æ•°æ®è¡¨åç§° -->
                                        <StackPanel Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="3" Margin="0,16,0,0" x:Name="DataTableNamePanel">
                                            <TextBlock Text="æ•°æ®è¡¨åç§°" Style="{StaticResource LabelStyle}" />
                                            <ComboBox x:Name="DataTableNameComboBox"
                                                    Style="{StaticResource ComboBoxStyle}"
                                                    FontFamily="Microsoft YaHei"
                                                    materialDesign:HintAssist.Hint="è¯·é€‰æ‹©æˆ–æœç´¢æ•°æ®è¡¨åç§°"
                                                    IsEditable="True"
                                                    IsTextSearchEnabled="True"
                                                    TextSearch.TextPath="."
                                                    SelectionChanged="DataTableNameComboBox_SelectionChanged" />
                                        </StackPanel>

                                        <!-- æ¸…ç©ºè¡¨é€‰é¡¹ -->
                                        <StackPanel Grid.Row="3" Grid.Column="0" Grid.ColumnSpan="3" Margin="0,16,0,0" x:Name="ClearTablePanel">
                                            <CheckBox x:Name="ClearTableCheckBox"
                                                    Content="æ’å…¥å‰æ¸…ç©ºè¡¨"
                                                    Style="{StaticResource ConfigCheckBoxStyle}"
                                                    ToolTip="é€‰ä¸­åŽå°†åœ¨æ’å…¥æ•°æ®å‰æ¸…ç©ºç›®æ ‡è¡¨çš„æ‰€æœ‰æ•°æ®"
                                                    Checked="ClearTableCheckBox_Checked"
                                                    Unchecked="ClearTableCheckBox_Unchecked" />
                                        </StackPanel>

                                        <!-- æ¸…ç©ºSheeté¡µé€‰é¡¹ -->
                                        <StackPanel Grid.Row="4" Grid.Column="0" Grid.ColumnSpan="3" Margin="0,16,0,0" x:Name="ClearSheetPanel" Visibility="Collapsed">
                                            <CheckBox x:Name="ClearSheetCheckBox"
                                                    Content="è¾“å‡ºå‰æ¸…ç©ºSheeté¡µ"
                                                    Style="{StaticResource ConfigCheckBoxStyle}"
                                                    ToolTip="é€‰ä¸­åŽå°†åœ¨è¾“å‡ºæ•°æ®å‰æ¸…ç©ºç›®æ ‡Sheeté¡µçš„æ‰€æœ‰æ•°æ®"
                                                    Checked="ClearSheetCheckBox_Checked"
                                                    Unchecked="ClearSheetCheckBox_Unchecked" />
                                        </StackPanel>

                                        <!-- Excelè¾“å‡ºè·¯å¾„ -->
                                        <StackPanel Grid.Row="5" Grid.Column="0" Grid.ColumnSpan="3" Margin="0,16,0,0" x:Name="ExcelPathPanel" Visibility="Collapsed">
                                            <TextBlock Text="è¾“å‡ºè·¯å¾„" Style="{StaticResource LabelStyle}" />
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*" />
                                                    <ColumnDefinition Width="Auto" />
                                                </Grid.ColumnDefinitions>
                                                <TextBox x:Name="OutputPathTextBox"
                                                       Grid.Column="0"
                                                       Style="{StaticResource InputStyle}"
                                                       materialDesign:HintAssist.Hint="Excelæ–‡ä»¶è¾“å‡ºè·¯å¾„"
                                                       Text="Output/Excel"
                                                       TextChanged="OutputPathTextBox_TextChanged" />
                                                <Button Grid.Column="1"
                                                      x:Name="PathSelectButton"
                                                      Content="é€‰æ‹©è·¯å¾„"
                                                      Style="{StaticResource ButtonStyle}"
                                                      Background="#2A2A2A"
                                                      Foreground="#CCCCCC"
                                                      Padding="8,4"
                                                      FontSize="10"
                                                      Height="36"
                                                      Margin="8,0,0,0" />
                                            </Grid>
                                        </StackPanel>

                                        <!-- Excelæ–‡ä»¶å -->
                                        <StackPanel Grid.Row="6" Grid.Column="0" Margin="0,16,8,0" x:Name="ExcelFileNamePanel" Visibility="Collapsed">
                                            <TextBlock Text="Excelæ–‡ä»¶å" Style="{StaticResource LabelStyle}" />
                                            <TextBox x:Name="ExcelFileNameTextBox"
                                                   Style="{StaticResource InputStyle}"
                                                   materialDesign:HintAssist.Hint="è¯·è¾“å…¥Excelæ–‡ä»¶åï¼ˆä¸å«æ‰©å±•åï¼‰"
                                                   TextChanged="ExcelFileNameTextBox_TextChanged" />
                                        </StackPanel>

                                        <!-- Sheetåç§° -->
                                        <StackPanel Grid.Row="6" Grid.Column="1" Margin="8,16,0,0" x:Name="SheetNamePanel" Visibility="Collapsed">
                                            <TextBlock Text="Sheetåç§°" Style="{StaticResource LabelStyle}" />
                                            <TextBox x:Name="SheetNameTextBox"
                                                   Style="{StaticResource InputStyle}"
                                                   materialDesign:HintAssist.Hint="è¯·è¾“å…¥Sheetåç§°"
                                                   TextChanged="SheetNameTextBox_TextChanged" />
                                        </StackPanel>

                                        <!-- è¾“å‡ºç›®æ ‡ -->
                                        <StackPanel Grid.Row="7" Grid.Column="0" Grid.ColumnSpan="3" Margin="0,16,0,0" x:Name="OutputTargetPanel" Visibility="Collapsed">
                                            <TextBlock Text="è¾“å‡ºç›®æ ‡" Style="{StaticResource LabelStyle}" />
                                            <TextBox x:Name="OutputTargetTextBox"
                                                   Style="{StaticResource InputStyle}"
                                                   IsReadOnly="True"
                                                   Background="#1A1A1A"
                                                   materialDesign:HintAssist.Hint="è‡ªåŠ¨ç”Ÿæˆçš„è¾“å‡ºç›®æ ‡è·¯å¾„" />
                                        </StackPanel>

                                        <!-- æè¿° -->
                                        <StackPanel Grid.Row="8" Grid.Column="0" Grid.ColumnSpan="3" Margin="0,16,0,0">
                                            <TextBlock Text="SQLæè¿°ä¿¡æ¯" Style="{StaticResource LabelStyle}" />
                                            <TextBox x:Name="DescriptionTextBox"
                                                   Style="{StaticResource MultiLineInputStyle}"
                                                   MinHeight="80"
                                                   materialDesign:HintAssist.Hint="è¯·è¾“å…¥SQLæè¿°ä¿¡æ¯" />
                                        </StackPanel>
                                    </Grid>
                                </StackPanel>
                            </Border>

                            <!-- SQLè¯­å¥å¡ç‰‡ -->
                            <Border Style="{StaticResource SqlPageStyle}" Margin="0,0,0,15">
                                <StackPanel>
                                    <Grid Margin="0,0,0,16">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        
                                        <TextBlock Grid.Column="0"
                                                 Text="SQLè¯­å¥ç¼–è¾‘å™¨" 
                                                 Style="{StaticResource GroupTitleStyle}" />
                                    </Grid>
                                    
                                    <!-- ä½¿ç”¨æ–°çš„SQLç¼–è¾‘å™¨ -->
                                    <local:SqlEditor x:Name="SqlEditor"
                                                   Height="400"
                                                   SqlTextChanged="SqlEditor_TextChanged"
                                                   FormatRequested="SqlEditor_FormatRequested"
                                                   ValidateRequested="SqlEditor_ValidateRequested" />
                                </StackPanel>
                            </Border>
                        </StackPanel>
                        
                        <!-- å³ä¾§ï¼šè¾…åŠ©é…ç½®å’Œæµ‹è¯• -->
                        <StackPanel Grid.Column="1" Margin="10,0,0,0">
                            <!-- æ‰§è¡Œé…ç½®å¡ç‰‡ -->
                            <Border Style="{StaticResource SqlPageStyle}" Margin="0,0,0,15">
                                <StackPanel>
                                    <TextBlock Text="æ‰§è¡Œé…ç½®" Style="{StaticResource GroupTitleStyle}" />

                                    <StackPanel Margin="0,0,0,12">
                                        <TextBlock Text="æŸ¥è¯¢è¶…æ—¶(ç§’)" Style="{StaticResource LabelStyle}" />
                                        <TextBox x:Name="TimeoutTextBox"
                                               Style="{StaticResource InputStyle}"
                                               materialDesign:HintAssist.Hint="é»˜è®¤30ç§’"
                                               Text="30" />
                                    </StackPanel>

                                    <StackPanel Margin="0,0,0,12">
                                        <TextBlock Text="æœ€å¤§è¿”å›žè¡Œæ•°" Style="{StaticResource LabelStyle}" />
                                        <TextBox x:Name="MaxRowsTextBox"
                                               Style="{StaticResource InputStyle}"
                                               materialDesign:HintAssist.Hint="é»˜è®¤1000è¡Œ"
                                               Text="1000" />
                                    </StackPanel>

                                    <StackPanel Margin="0,0,0,12">
                                        <TextBlock Text="æ‰§è¡Œæ¨¡å¼" Style="{StaticResource LabelStyle}" />
                                        <ComboBox x:Name="ExecutionModeComboBox"
                                                Style="{StaticResource ComboBoxStyle}"
                                                FontFamily="Microsoft YaHei"
                                                materialDesign:HintAssist.Hint="è¯·é€‰æ‹©æ‰§è¡Œæ¨¡å¼" />
                                    </StackPanel>

                                    <TextBlock Text="æ‰§è¡Œé€‰é¡¹" Style="{StaticResource LabelStyle}" />
                                    <StackPanel Margin="0,8,0,0">
                                        <CheckBox x:Name="EnableLoggingCheckBox"
                                                Content="å¯ç”¨è¯¦ç»†æ—¥å¿—"
                                                Style="{StaticResource ConfigCheckBoxStyle}"
                                                IsChecked="True" />
                                        <CheckBox x:Name="CacheResultsCheckBox"
                                                Content="ç¼“å­˜æŸ¥è¯¢ç»“æžœ"
                                                Style="{StaticResource ConfigCheckBoxStyle}" />
                                        <CheckBox x:Name="ValidateParametersCheckBox"
                                                Content="å‚æ•°éªŒè¯"
                                                Style="{StaticResource ConfigCheckBoxStyle}"
                                                IsChecked="True" />
                                    </StackPanel>
                                </StackPanel>
                            </Border>

                            <!-- æµ‹è¯•æ“ä½œå¡ç‰‡ -->
                            <Border Style="{StaticResource SqlPageStyle}" Margin="0,0,0,15">
                                <StackPanel>
                                    <TextBlock Text="æµ‹è¯•ä¸ŽéªŒè¯" Style="{StaticResource GroupTitleStyle}" />
                                    
                                    <StackPanel Margin="0,0,0,12">
                                        <Button x:Name="TestSqlButton"
                                              Content="æ‰§è¡ŒSQLæŸ¥è¯¢æ•°æ®"
                                              Style="{StaticResource ButtonStyle}"
                                              Background="{StaticResource InfoColor}"
                                              Foreground="White"
                                              Click="TestSqlButton_Click" />
                                    </StackPanel>
                                    

                                    
                                    <StackPanel Margin="0,0,0,12">
                                        <Button x:Name="TestOutputButton"
                                              Content="æµ‹è¯•è¾“å‡ºæ ¼å¼"
                                              Style="{StaticResource ButtonStyle}"
                                              Background="{StaticResource WarningColor}"
                                              Foreground="White"
                                              Click="TestOutputButton_Click" />
                                    </StackPanel>
                                </StackPanel>
                            </Border>

                            <!-- å‚æ•°é…ç½®å¡ç‰‡ -->
                            <Border Style="{StaticResource SqlPageStyle}">
                                <StackPanel>
                                    <Grid Margin="0,0,0,16">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        
                                        <TextBlock Grid.Column="0"
                                                 Text="å‚æ•°é…ç½®" 
                                                 Style="{StaticResource GroupTitleStyle}" />
                                        
                                        <Button Grid.Column="1"
                                              x:Name="AddParameterButton"
                                              Content="æ·»åŠ å‚æ•°"
                                              Style="{StaticResource ButtonStyle}"
                                              Background="{StaticResource SuccessColor}"
                                              Foreground="White"
                                              Click="AddParameterButton_Click" />
                                    </Grid>

                                    <!-- å‚æ•°é…ç½®æç¤º -->
                                    <TextBlock Text="ðŸ’¡ æç¤ºï¼šå‚æ•°åç§°ä»¥@å¼€å¤´ï¼Œå¦‚@startDateã€@endDateç­‰"
                                             FontSize="10"
                                             Foreground="#888888"
                                             Margin="0,0,0,8"
                                             TextWrapping="Wrap" />
                                    
                                    <!-- å‚æ•°åˆ—è¡¨ -->
                                    <ScrollViewer Height="280" 
                                                VerticalScrollBarVisibility="Auto">
                                        <StackPanel x:Name="ParametersPanel">
                                            <!-- ç¤ºä¾‹å‚æ•°é¡¹ -->
                                            <Border Style="{StaticResource ParameterItemStyle}">
                                                <Grid>
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="Auto" />
                                                    </Grid.RowDefinitions>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*" />
                                                        <ColumnDefinition Width="Auto" />
                                                    </Grid.ColumnDefinitions>

                                                    <StackPanel Grid.Row="0" Grid.Column="0" 
                                                              Orientation="Horizontal">
                                                        <TextBlock Text="âš™ï¸" 
                                                                 FontSize="14" 
                                                                 VerticalAlignment="Center" 
                                                                 Margin="0,0,6,0" />
                                                        <TextBlock Text="å‚æ•°é…ç½®"
                                                                 Style="{StaticResource ParameterTitleStyle}" />
                                                    </StackPanel>
                                                    
                                                    <Button Grid.Row="0" Grid.Column="1"
                                                          Content="åˆ é™¤"
                                                          Style="{StaticResource DangerButtonStyle}" />

                                                    <!-- å‚æ•°åç§°å’Œé»˜è®¤å€¼ -->
                                                    <Grid Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="Auto" />
                                                            <ColumnDefinition Width="*" />
                                                            <ColumnDefinition Width="Auto" />
                                                            <ColumnDefinition Width="*" />
                                                        </Grid.ColumnDefinitions>
                                                        
                                                        <TextBlock Grid.Column="0"
                                                                 Text="å‚æ•°åç§°:"
                                                                 Style="{StaticResource ParameterLabelStyle}" />
                                                        
                                                        <TextBox Grid.Column="1"
                                                               Style="{StaticResource ParameterInputStyle}"
                                                               materialDesign:HintAssist.Hint="å‚æ•°åç§°"
                                                               Text="@parameter"
                                                               Margin="0,0,16,0" />
                                                        
                                                        <TextBlock Grid.Column="2"
                                                                 Text="é»˜è®¤å€¼:"
                                                                 Style="{StaticResource ParameterLabelStyle}" />
                                                        
                                                        <TextBox Grid.Column="3"
                                                               Style="{StaticResource ParameterInputStyle}"
                                                               materialDesign:HintAssist.Hint="é»˜è®¤å€¼"
                                                               Text="" />
                                                    </Grid>
                                                </Grid>
                                            </Border>
                                        </StackPanel>
                                    </ScrollViewer>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </Grid>
                </StackPanel>
            </ScrollViewer>
        </Border>
    </Grid>
</UserControl> 