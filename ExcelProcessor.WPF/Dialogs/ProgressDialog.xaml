<Window x:Class="ExcelProcessor.WPF.Dialogs.ProgressDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        Title="{Binding Title}" 
        Height="200" 
        Width="400"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize"
        ShowInTaskbar="False"
        WindowStyle="ToolWindow"
        Background="{DynamicResource MaterialDesignPaper}"
        TextElement.Foreground="{DynamicResource MaterialDesignBody}"
        TextElement.FontWeight="Regular"
        TextElement.FontSize="13"
        TextOptions.TextFormattingMode="Ideal"
        TextOptions.TextRenderingMode="Auto"
        FontFamily="{DynamicResource MaterialDesignFont}">
    
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- 标题 -->
        <TextBlock Grid.Row="0" 
                   Text="{Binding Title}" 
                   Style="{StaticResource MaterialDesignHeadline6TextBlock}"
                   HorizontalAlignment="Center"
                   Margin="0,0,0,20"/>

        <!-- 进度条 -->
        <ProgressBar Grid.Row="1" 
                     Style="{StaticResource MaterialDesignLinearProgressBar}"
                     IsIndeterminate="True"
                     Height="4"
                     Margin="0,0,0,20"/>

        <!-- 消息 -->
        <TextBlock Grid.Row="2" 
                   Text="{Binding Message}" 
                   Style="{StaticResource MaterialDesignBody1TextBlock}"
                   HorizontalAlignment="Center"
                   TextWrapping="Wrap"
                   TextAlignment="Center"/>

        <!-- 取消按钮 -->
        <Button Grid.Row="3" 
                Content="取消" 
                Style="{StaticResource MaterialDesignOutlinedButton}"
                HorizontalAlignment="Center"
                VerticalAlignment="Bottom"
                Margin="0,20,0,0"
                Click="CancelButton_Click"
                Visibility="{Binding ShowCancelButton, Converter={StaticResource BooleanToVisibilityConverter}}"/>
    </Grid>
</Window> 