<?xml version="1.0" encoding="utf-8"?>
<Window x:Class="ExcelProcessor.WPF.Dialogs.UserEditDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        Title="用户编辑"
        Width="500"
        Height="600"
        WindowStartupLocation="CenterOwner"
        Background="{StaticResource MaterialDesignPaper}"
        TextElement.Foreground="{StaticResource MaterialDesignBody}"
        TextElement.FontWeight="Regular"
        TextElement.FontSize="13"
        TextOptions.TextFormattingMode="Ideal"
        TextOptions.TextRenderingMode="Auto"
        FontFamily="{StaticResource MaterialDesignFont}">

    <Grid Margin="24">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <!-- 标题 -->
        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,24">
            <materialDesign:PackIcon Kind="AccountEdit" 
                                   Width="24" 
                                   Height="24" 
                                   Foreground="{StaticResource CyberBlueBrush}"
                                   VerticalAlignment="Center"
                                   Margin="0,0,12,0" />
            <TextBlock Text="{Binding DialogTitle}" 
                     Style="{StaticResource ConfigGroupTitleStyle}"
                     FontSize="20" 
                     VerticalAlignment="Center" />
        </StackPanel>

        <!-- 表单内容 -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <StackPanel>
                <!-- 用户名 -->
                <TextBlock Text="用户名 *" 
                         Style="{StaticResource ConfigItemLabelStyle}"
                         Margin="0,0,0,8" />
                <TextBox x:Name="UsernameTextBox"
                       Text="{Binding User.Username, UpdateSourceTrigger=PropertyChanged}"
                       Style="{StaticResource ConfigInputStyle}"
                       materialDesign:HintAssist.Hint="请输入用户名"
                       Margin="0,0,0,16" />

                <!-- 显示名称 -->
                <TextBlock Text="显示名称 *" 
                         Style="{StaticResource ConfigItemLabelStyle}"
                         Margin="0,0,0,8" />
                <TextBox x:Name="DisplayNameTextBox"
                       Text="{Binding User.DisplayName, UpdateSourceTrigger=PropertyChanged}"
                       Style="{StaticResource ConfigInputStyle}"
                       materialDesign:HintAssist.Hint="请输入显示名称"
                       Margin="0,0,0,16" />

                <!-- 邮箱 -->
                <TextBlock Text="邮箱" 
                         Style="{StaticResource ConfigItemLabelStyle}"
                         Margin="0,0,0,8" />
                <TextBox x:Name="EmailTextBox"
                       Text="{Binding User.Email, UpdateSourceTrigger=PropertyChanged}"
                       Style="{StaticResource ConfigInputStyle}"
                       materialDesign:HintAssist.Hint="请输入邮箱地址"
                       Margin="0,0,0,16" />

                <!-- 角色 -->
                <TextBlock Text="角色 *" 
                         Style="{StaticResource ConfigItemLabelStyle}"
                         Margin="0,0,0,8" />
                <ComboBox x:Name="RoleComboBox"
                        SelectedItem="{Binding SelectedRole}"
                        ItemsSource="{Binding AvailableRoles}"
                        DisplayMemberPath="Name"
                        Style="{StaticResource ConfigComboBoxStyle}"
                        materialDesign:HintAssist.Hint="请选择角色"
                        Margin="0,0,0,16" />

                <!-- 密码 -->
                <TextBlock Text="密码" 
                         Style="{StaticResource ConfigItemLabelStyle}"
                         Margin="0,0,0,8" />
                <PasswordBox x:Name="PasswordBox"
                          Style="{StaticResource ConfigInputStyle}"
                          materialDesign:HintAssist.Hint="请输入密码（留空则不修改）"
                          Margin="0,0,0,16" />

                <!-- 确认密码 -->
                <TextBlock Text="确认密码" 
                         Style="{StaticResource ConfigItemLabelStyle}"
                         Margin="0,0,0,8" />
                <PasswordBox x:Name="ConfirmPasswordBox"
                          Style="{StaticResource ConfigInputStyle}"
                          materialDesign:HintAssist.Hint="请再次输入密码"
                          Margin="0,0,0,16" />

                <!-- 状态 -->
                <CheckBox x:Name="IsEnabledCheckBox"
                        Content="启用用户"
                        IsChecked="{Binding User.IsEnabled}"
                        Style="{StaticResource ConfigCheckBoxStyle}"
                        Margin="0,0,0,16" />

                <!-- 备注 -->
                <TextBlock Text="备注" 
                         Style="{StaticResource ConfigItemLabelStyle}"
                         Margin="0,0,0,8" />
                <TextBox x:Name="RemarksTextBox"
                       Text="{Binding User.Remarks, UpdateSourceTrigger=PropertyChanged}"
                       Style="{StaticResource ConfigInputStyle}"
                       materialDesign:HintAssist.Hint="请输入备注信息"
                       AcceptsReturn="True"
                       TextWrapping="Wrap"
                       Height="80"
                       VerticalScrollBarVisibility="Auto"
                       Margin="0,0,0,16" />
            </StackPanel>
        </ScrollViewer>

        <!-- 按钮 -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,24,0,0">
            <Button x:Name="CancelButton"
                  Content="取消"
                  Style="{StaticResource ConfigButtonStyle}"
                  Click="CancelButton_Click"
                  Margin="0,0,12,0" />
            
            <Button x:Name="SaveButton"
                  Content="保存"
                  Style="{StaticResource AccentButtonStyle}"
                  Click="SaveButton_Click" />
        </StackPanel>
    </Grid>
</Window> 