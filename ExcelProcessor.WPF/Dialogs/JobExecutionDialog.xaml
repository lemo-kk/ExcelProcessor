<Window x:Class="ExcelProcessor.WPF.Dialogs.JobExecutionDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        Title="作业执行"
        Height="600"
        Width="800"
        WindowStartupLocation="CenterOwner"
        Background="#1E1E1E"
        Foreground="White"
        ResizeMode="CanResize"
        MinHeight="500"
        MinWidth="700">

    <Window.Resources>
        <!-- 按钮样式 -->
        <Style x:Key="ActionButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#2A2A2A" />
            <Setter Property="Foreground" Value="#E0E0E0" />
            <Setter Property="BorderBrush" Value="#444444" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="Padding" Value="16,8" />
            <Setter Property="Margin" Value="4" />
            <Setter Property="FontSize" Value="12" />
            <Setter Property="FontWeight" Value="Medium" />
            <Setter Property="Cursor" Value="Hand" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="4">
                            <ContentPresenter HorizontalAlignment="Center" 
                                            VerticalAlignment="Center"
                                            Margin="{TemplateBinding Padding}" />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#3A3A3A" />
                                <Setter Property="BorderBrush" Value="#555555" />
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="#1A1A1A" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- 执行按钮样式 -->
        <Style x:Key="ExecuteButtonStyle" TargetType="Button" BasedOn="{StaticResource ActionButtonStyle}">
            <Setter Property="Background" Value="#4CAF50" />
            <Setter Property="Foreground" Value="White" />
            <Setter Property="BorderBrush" Value="#45A049" />
            <Setter Property="FontSize" Value="14" />
            <Setter Property="FontWeight" Value="SemiBold" />
            <Setter Property="Padding" Value="24,12" />
        </Style>

        <!-- 打开路径按钮样式 -->
        <Style x:Key="OpenPathButtonStyle" TargetType="Button" BasedOn="{StaticResource ActionButtonStyle}">
            <Setter Property="Background" Value="#2196F3" />
            <Setter Property="Foreground" Value="White" />
            <Setter Property="BorderBrush" Value="#1976D2" />
            <Setter Property="Padding" Value="12,6" />
            <Setter Property="FontSize" Value="11" />
        </Style>

        <!-- 列表项样式 -->
        <Style x:Key="ExcelStepItemStyle" TargetType="Border">
            <Setter Property="Background" Value="#2A2A2A" />
            <Setter Property="BorderBrush" Value="#444444" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="CornerRadius" Value="6" />
            <Setter Property="Padding" Value="16" />
            <Setter Property="Margin" Value="0,0,0,8" />
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect Color="Black" BlurRadius="8" ShadowDepth="2" Opacity="0.3" />
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <!-- 标题 -->
        <StackPanel Grid.Row="0" Margin="0,0,0,20">
            <TextBlock Text="作业执行详情" 
                       FontSize="20" 
                       FontWeight="Bold"
                       Foreground="White"
                       HorizontalAlignment="Center" />
            <TextBlock x:Name="JobNameText" 
                       Text="作业名称" 
                       FontSize="16" 
                       Foreground="#CCCCCC"
                       HorizontalAlignment="Center"
                       Margin="0,8,0,0" />
        </StackPanel>

        <!-- Excel步骤列表 -->
        <ScrollViewer Grid.Row="1" 
                      VerticalScrollBarVisibility="Auto"
                      Margin="0,0,0,20">
            <StackPanel>
                <TextBlock Text="Excel导入步骤" 
                           FontSize="16" 
                           FontWeight="SemiBold"
                           Foreground="White"
                           Margin="0,0,0,16" />
                
                <ItemsControl x:Name="ExcelStepsList">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Border Style="{StaticResource ExcelStepItemStyle}">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>
                                    
                                    <!-- 步骤信息 -->
                                    <StackPanel Grid.Column="0">
                                        <TextBlock Text="{Binding Name}" 
                                                   FontSize="14" 
                                                   FontWeight="SemiBold"
                                                   Foreground="White"
                                                   Margin="0,0,0,8" />
                                        <TextBlock Text="{Binding Description}" 
                                                   FontSize="12" 
                                                   Foreground="#CCCCCC"
                                                   Margin="0,0,0,8"
                                                   TextWrapping="Wrap" />
                                        <TextBlock Text="{Binding FilePath}" 
                                                   FontSize="11" 
                                                   Foreground="#888888"
                                                   TextWrapping="Wrap"
                                                   FontFamily="Consolas" />
                                    </StackPanel>
                                    
                                    <!-- 操作按钮 -->
                                    <StackPanel Grid.Column="1" 
                                                VerticalAlignment="Center"
                                                Margin="16,0,0,0">
                                        <Button Content="打开路径"
                                                Style="{StaticResource OpenPathButtonStyle}"
                                                Click="OpenPathButton_Click"
                                                Tag="{Binding FilePath}" />
                                        <Button Content="放入Excel"
                                                Style="{StaticResource OpenPathButtonStyle}"
                                                Background="#FF9800"
                                                BorderBrush="#F57C00"
                                                Click="OpenExcelButton_Click"
                                                Tag="{Binding FilePath}"
                                                Margin="0,8,0,0" />
                                    </StackPanel>
                                </Grid>
                            </Border>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
                
                <!-- 如果没有Excel步骤 -->
                <Border x:Name="NoExcelStepsBorder"
                        Style="{StaticResource ExcelStepItemStyle}"
                        Background="#1A1A1A"
                        BorderBrush="#333333">
                    <StackPanel HorizontalAlignment="Center" 
                                VerticalAlignment="Center"
                                Margin="40,20">
                        <materialDesign:PackIcon Kind="FileExcelOutline" 
                                               Width="48" 
                                               Height="48"
                                               Foreground="#666666"
                                               HorizontalAlignment="Center" />
                        <TextBlock Text="该作业不包含Excel导入步骤" 
                                   FontSize="14" 
                                   Foreground="#666666"
                                   HorizontalAlignment="Center"
                                   Margin="0,16,0,0" />
                    </StackPanel>
                </Border>
            </StackPanel>
        </ScrollViewer>

        <!-- 执行结果 -->
        <Border Grid.Row="2" 
                Background="#1A1A1A" 
                BorderBrush="#444444" 
                BorderThickness="1"
                CornerRadius="6"
                Padding="16"
                Margin="0,0,0,20"
                x:Name="ExecutionResultBorder"
                Visibility="Collapsed">
            <StackPanel>
                <TextBlock Text="执行结果" 
                           FontSize="16" 
                           FontWeight="SemiBold"
                           Foreground="White"
                           Margin="0,0,0,12" />
                <TextBlock x:Name="ExecutionResultText" 
                           Text="执行结果将显示在这里" 
                           FontSize="12" 
                           Foreground="#CCCCCC"
                           TextWrapping="Wrap" />
            </StackPanel>
        </Border>

        <!-- 底部按钮 -->
        <StackPanel Grid.Row="3" 
                    Orientation="Horizontal" 
                    HorizontalAlignment="Center">
            <Button x:Name="ExecuteButton"
                    Content="执行作业"
                    Style="{StaticResource ExecuteButtonStyle}"
                    Click="ExecuteButton_Click" />
            <Button Content="关闭"
                    Style="{StaticResource ActionButtonStyle}"
                    Click="CloseButton_Click"
                    Margin="16,0,0,0" />
        </StackPanel>
    </Grid>
</Window> 