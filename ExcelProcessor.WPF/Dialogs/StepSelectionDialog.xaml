<Window x:Class="ExcelProcessor.WPF.Dialogs.StepSelectionDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        Title="选择步骤类型" 
        Height="500" 
        Width="700"
        WindowStartupLocation="CenterOwner"
        Background="#1A1A1A"
        Foreground="#E0E0E0"
        ResizeMode="CanResize"
        MinHeight="400"
        MinWidth="600">

    <Window.Resources>
        <!-- 按钮样式 -->
        <Style x:Key="ButtonStyle" TargetType="Button" BasedOn="{StaticResource MaterialDesignOutlinedButton}">
            <Setter Property="FontSize" Value="13" />
            <Setter Property="Height" Value="36" />
            <Setter Property="Padding" Value="16,8" />
            <Setter Property="Margin" Value="0,0,8,0" />
            <Setter Property="Background" Value="#2A2A2A" />
            <Setter Property="Foreground" Value="#E0E0E0" />
            <Setter Property="BorderBrush" Value="#404040" />
        </Style>

        <!-- 下拉框样式 -->
        <Style x:Key="ComboBoxStyle" TargetType="ComboBox" BasedOn="{StaticResource MaterialDesignOutlinedComboBox}">
            <Setter Property="FontSize" Value="13" />
            <Setter Property="Height" Value="40" />
            <Setter Property="Background" Value="#2A2A2A" />
            <Setter Property="Foreground" Value="#E0E0E0" />
            <Setter Property="BorderBrush" Value="#404040" />
            <Setter Property="Margin" Value="0,0,0,16" />
            <Setter Property="VerticalAlignment" Value="Center" />
            <Setter Property="VerticalContentAlignment" Value="Center" />
            <Setter Property="Padding" Value="8,8" />
        </Style>

        <!-- 卡片样式 -->
        <Style x:Key="CardStyle" TargetType="Border">
            <Setter Property="Background" Value="#2A2A2A" />
            <Setter Property="BorderBrush" Value="#404040" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="CornerRadius" Value="8" />
            <Setter Property="Padding" Value="16" />
            <Setter Property="Margin" Value="0,0,0,12" />
        </Style>

        <!-- 标题样式 -->
        <Style x:Key="TitleStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="16" />
            <Setter Property="FontWeight" Value="SemiBold" />
            <Setter Property="Foreground" Value="#E0E0E0" />
            <Setter Property="Margin" Value="0,0,0,12" />
        </Style>

        <!-- 列表项样式 -->
        <Style x:Key="ListItemStyle" TargetType="Border">
            <Setter Property="Background" Value="#1A1A1A" />
            <Setter Property="BorderBrush" Value="#404040" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="CornerRadius" Value="4" />
            <Setter Property="Padding" Value="12" />
            <Setter Property="Margin" Value="0,0,0,8" />
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#3A3A3A" />
                    <Setter Property="BorderBrush" Value="#606060" />
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- 颜色资源 -->
        <SolidColorBrush x:Key="CyberBlueBrush" Color="#00A2FF" />
        <SolidColorBrush x:Key="SuccessColor" Color="#4CAF50" />
        <SolidColorBrush x:Key="WarningColor" Color="#FF9800" />
        <SolidColorBrush x:Key="DangerColor" Color="#F44336" />
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <!-- 主要内容 -->
        <ScrollViewer Grid.Row="0" VerticalScrollBarVisibility="Auto" Margin="20">
            <StackPanel>
                <!-- 标题 -->
                <TextBlock Text="选择要添加的步骤类型" 
                         Style="{StaticResource TitleStyle}" 
                         FontSize="18" 
                         Margin="0,0,0,20" />

                <!-- 步骤类型选择 -->
                <Border Style="{StaticResource CardStyle}">
                    <StackPanel>
                        <TextBlock Text="步骤类型" Style="{StaticResource TitleStyle}" />
                        
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>

                            <!-- Excel导入步骤 -->
                            <Border Grid.Column="0" 
                                  Style="{StaticResource ListItemStyle}" 
                                  Margin="0,0,8,0"
                                  x:Name="ExcelImportCard"
                                  MouseLeftButtonDown="ExcelImportCard_MouseLeftButtonDown">
                                <StackPanel>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        
                                        <materialDesign:PackIcon Grid.Column="0"
                                                             Kind="FileExcel"
                                                             Width="24"
                                                             Height="24"
                                                             Foreground="{StaticResource SuccessColor}"
                                                             Margin="0,0,12,0" />
                                        
                                        <StackPanel Grid.Column="1">
                                            <TextBlock Text="Excel导入步骤" 
                                                     FontWeight="SemiBold" 
                                                     FontSize="14" />
                                            <TextBlock Text="从Excel文件导入数据到数据库" 
                                                     FontSize="12" 
                                                     Foreground="#AAAAAA" 
                                                     Margin="0,4,0,0" />
                                        </StackPanel>
                                    </Grid>
                                </StackPanel>
                            </Border>

                            <!-- SQL执行步骤 -->
                            <Border Grid.Column="1" 
                                  Style="{StaticResource ListItemStyle}" 
                                  Margin="8,0,0,0"
                                  x:Name="SqlExecutionCard"
                                  MouseLeftButtonDown="SqlExecutionCard_MouseLeftButtonDown">
                                <StackPanel>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        
                                        <materialDesign:PackIcon Grid.Column="0"
                                                             Kind="Database"
                                                             Width="24"
                                                             Height="24"
                                                             Foreground="{StaticResource CyberBlueBrush}"
                                                             Margin="0,0,12,0" />
                                        
                                        <StackPanel Grid.Column="1">
                                            <TextBlock Text="SQL执行步骤" 
                                                     FontWeight="SemiBold" 
                                                     FontSize="14" />
                                            <TextBlock Text="执行SQL查询并处理结果" 
                                                     FontSize="12" 
                                                     Foreground="#AAAAAA" 
                                                     Margin="0,4,0,0" />
                                        </StackPanel>
                                    </Grid>
                                </StackPanel>
                            </Border>
                        </Grid>
                    </StackPanel>
                </Border>

                <!-- Excel配置选择 -->
                <Border Style="{StaticResource CardStyle}" 
                      x:Name="ExcelConfigSection"
                      Visibility="Collapsed">
                    <StackPanel>
                        <TextBlock Text="选择Excel配置" Style="{StaticResource TitleStyle}" />
                        
                        <TextBlock Text="从已配置的Excel模版中选择一个：" 
                                 FontSize="12" 
                                 Foreground="#AAAAAA" 
                                 Margin="0,0,0,12" />
                        
                        <ComboBox x:Name="ExcelConfigComboBox"
                                Style="{StaticResource ComboBoxStyle}"
                                DisplayMemberPath="ConfigName"
                                SelectedValuePath="Id"
                                Margin="0,0,0,16" />
                        
                        <TextBlock x:Name="ExcelConfigInfoText"
                                 FontSize="12" 
                                 Foreground="#888888" 
                                 TextWrapping="Wrap" />
                    </StackPanel>
                </Border>

                <!-- SQL配置选择 -->
                <Border Style="{StaticResource CardStyle}" 
                      x:Name="SqlConfigSection"
                      Visibility="Collapsed">
                    <StackPanel>
                        <TextBlock Text="选择SQL配置" Style="{StaticResource TitleStyle}" />
                        
                        <TextBlock Text="从已配置的SQL中选择一个：" 
                                 FontSize="12" 
                                 Foreground="#AAAAAA" 
                                 Margin="0,0,0,12" />
                        
                        <ComboBox x:Name="SqlConfigComboBox"
                                Style="{StaticResource ComboBoxStyle}"
                                DisplayMemberPath="Name"
                                SelectedValuePath="Id"
                                Margin="0,0,0,16" />
                        
                        <TextBlock x:Name="SqlConfigInfoText"
                                 FontSize="12" 
                                 Foreground="#888888" 
                                 TextWrapping="Wrap" />
                    </StackPanel>
                </Border>
            </StackPanel>
        </ScrollViewer>

        <!-- 按钮区域 -->
        <Border Grid.Row="1" 
              Background="#2A2A2A" 
              CornerRadius="8" 
              Padding="20">
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                <Button x:Name="CancelButton"
                      Content="取消"
                      Style="{StaticResource ButtonStyle}"
                      Background="#2A2A2A"
                      Foreground="#CCCCCC"
                      Click="CancelButton_Click" />

                <Button x:Name="ConfirmButton"
                      Content="确认添加"
                      Style="{StaticResource ButtonStyle}"
                      Background="{StaticResource SuccessColor}"
                      Foreground="White"
                      Click="ConfirmButton_Click" />
            </StackPanel>
        </Border>
    </Grid>
</Window> 