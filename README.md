# Excel处理系统 V1.0

## 系统概述

这是一个基于WPF的Excel数据处理系统，采用现代化的Material Design界面设计，提供了完整的Excel文件导入、数据处理、作业调度和用户管理功能。系统采用分层架构设计，具有良好的可扩展性和维护性。

## 主要功能

### 1. Excel配置管理 ✅
- **Excel文件导入配置**: 支持多种Excel格式(.xlsx, .xls)的导入配置
- **字段映射配置**: 灵活的字段映射关系配置，支持数据类型转换
- **数据源配置**: 支持多种数据库连接配置
- **配置引用管理**: 支持配置模板的复用和引用

### 2. 作业管理 ✅
- **作业创建和编辑**: 可视化作业配置界面
- **作业调度**: 支持Cron表达式和多种调度策略
- **作业执行历史**: 详细的执行记录和状态跟踪
- **作业状态监控**: 实时监控作业执行状态

### 3. 数据导入 ✅
- **支持多种Excel格式**: .xlsx, .xls等格式
- **批量数据处理**: 支持大量数据的批量导入
- **进度显示**: 实时显示导入进度
- **错误处理和日志记录**: 完善的错误处理机制

### 4. SQL管理 ✅
- **SQL脚本编辑和执行**: 内置SQL编辑器
- **数据库连接管理**: 支持多种数据库类型
- **查询结果展示**: 表格化展示查询结果
- **参数化查询**: 支持参数化SQL查询

### 5. 用户管理 ✅
- **用户角色管理**: 基于角色的权限控制
- **权限控制**: 细粒度的功能权限控制
- **用户认证**: 安全的用户登录认证

### 6. 系统设置 ✅
- **系统配置**: 系统级配置管理
- **数据源管理**: 数据库连接配置
- **日志管理**: 系统日志查看和管理

## 技术架构

### 项目结构
```
ExcelProcessor/
├── ExcelProcessor.Models/          # 数据模型层
│   ├── Enums/                     # 枚举定义
│   ├── ExcelConfig.cs             # Excel配置模型
│   ├── JobConfig.cs               # 作业配置模型
│   ├── User.cs                    # 用户模型
│   ├── Role.cs                    # 角色模型
│   └── ...
├── ExcelProcessor.Core/            # 核心业务逻辑层
│   ├── Interfaces/                # 业务接口定义
│   ├── Services/                  # 业务服务实现
│   └── DependencyInjection/       # 依赖注入配置
├── ExcelProcessor.Data/            # 数据访问层
│   ├── Services/                  # 数据服务实现
│   ├── Repositories/              # 仓储模式实现
│   ├── Database/                  # 数据库相关
│   └── Infrastructure/            # 基础设施
└── ExcelProcessor.WPF/             # WPF用户界面层
    ├── Views/                     # 主窗口
    ├── Pages/                     # 页面组件
    ├── Controls/                  # 自定义控件
    ├── Dialogs/                   # 对话框
    ├── Styles/                    # 样式定义
    └── ViewModels/                # 视图模型
```

### 技术栈
- **.NET 6.0** - 基础框架
- **WPF** - 用户界面框架
- **MaterialDesignInXamlToolkit** - Material Design UI组件
- **SQLite** - 本地数据库
- **Quartz.NET** - 作业调度框架
- **EPPlus** - Excel处理库
- **Microsoft.Extensions.DependencyInjection** - 依赖注入容器
- **Microsoft.Extensions.Logging** - 日志框架

### 设计模式
- **MVVM** - 模型-视图-视图模型模式
- **Repository Pattern** - 仓储模式
- **Dependency Injection** - 依赖注入模式
- **Factory Pattern** - 工厂模式
- **Observer Pattern** - 观察者模式

## 安装和运行

### 系统要求
- Windows 10/11 (64位)
- .NET 6.0 Runtime
- 至少 4GB RAM
- 1GB 可用磁盘空间

### 安装步骤
1. 下载并安装 .NET 6.0 Runtime
2. 克隆或下载项目代码
3. 在项目根目录运行：
   ```bash
   dotnet restore
   dotnet build
   dotnet run --project ExcelProcessor.WPF
   ```

### 快速启动
```bash
# 进入项目目录
cd "E:\code\code demo\EXCEL_V1.0"

# 编译项目
dotnet build

# 运行应用
   dotnet run --project ExcelProcessor.WPF
   ```

## 使用指南

### 首次启动
1. 系统会自动创建本地SQLite数据库
2. 默认使用管理员账户登录（无需密码）
3. 首次使用建议配置数据源

### Excel导入配置
1. 点击"Excel配置"菜单
2. 创建新的导入配置
3. 设置Excel文件路径和字段映射
4. 配置目标数据源
5. 保存配置

### 创建作业
1. 点击"作业管理"菜单
2. 点击"新建作业"
3. 选择作业类型和配置
4. 设置调度时间（支持Cron表达式）
5. 保存作业

### 执行作业
1. 在作业管理页面选择要执行的作业
2. 点击"执行"按钮
3. 查看执行进度和结果
4. 查看执行历史记录

### SQL管理
1. 点击"SQL管理"菜单
2. 选择数据源
3. 编写或导入SQL脚本
4. 执行查询并查看结果

## 配置说明

### 数据库配置
- 默认使用SQLite本地数据库
- 数据库文件位置：`data/ExcelProcessor.db`
- 支持自定义数据库连接字符串

### 日志配置
- 日志级别：Information
- 支持控制台和文件输出
- 日志文件位置：`logs/`

### 作业调度配置
- 支持Cron表达式
- 支持一次性执行
- 支持重复执行
- 支持条件触发

### 系统配置
- 主题设置：支持深色/浅色主题
- 语言设置：支持中文界面
- 性能设置：可配置内存使用限制

## 开发说明

### 项目结构说明
- **Models**: 定义数据实体和DTO，包含业务模型
- **Core**: 包含业务逻辑接口和核心服务，定义业务规则
- **Data**: 数据访问层，包含仓储和服务实现，处理数据持久化
- **WPF**: 用户界面层，包含窗口、页面和控件，提供用户交互

### 扩展开发
1. **添加新的数据模型**：
   - 在Models项目中添加新的实体类
   - 在Enums目录添加相关枚举

2. **实现业务逻辑**：
   - 在Core/Interfaces中定义接口
   - 在Core/Services中实现业务逻辑

3. **添加数据访问**：
   - 在Data/Services中实现数据服务
   - 在Data/Repositories中添加仓储实现

4. **创建用户界面**：
   - 在WPF/Pages中创建新页面
   - 在WPF/Controls中添加自定义控件

### 代码规范
- 使用C#编码规范
- 遵循SOLID原则
- 添加适当的注释和文档
- 使用异步编程模式

## 故障排除

### 常见问题
1. **系统启动失败**
   - 检查.NET 6.0是否正确安装
   - 检查是否有足够的磁盘空间
   - 检查数据库文件权限

2. **Excel导入失败**
   - 检查Excel文件格式是否支持
   - 检查字段映射配置是否正确
   - 检查目标数据库连接是否正常

3. **作业执行失败**
   - 检查数据源连接是否正常
   - 查看执行日志获取详细错误信息
   - 检查作业配置是否正确

4. **界面显示异常**
   - 检查系统DPI设置
   - 更新显卡驱动
   - 检查.NET Framework版本

### 日志查看
- 系统日志在控制台输出
- 详细错误信息会显示在界面上
- 日志文件保存在logs目录

### 性能优化
- 大数据量导入时建议分批处理
- 定期清理执行历史记录
- 优化数据库查询性能

## 版本历史

### V1.0 (当前版本) ✅
- ✅ 基础Excel导入功能
- ✅ 作业调度系统
- ✅ 用户管理和权限控制
- ✅ SQL管理和执行
- ✅ 配置管理系统
- ✅ Material Design界面
- ✅ 数据源管理
- ✅ 系统设置

### 计划功能
- 🔄 数据可视化图表
- 🔄 报表生成功能
- 🔄 数据导出功能
- 🔄 插件系统
- 🔄 云端同步

## 许可证

本项目采用MIT许可证。

## 联系方式

如有问题或建议，请联系开发团队。 

## 更新日志

### 2024-01-XX
- 完成基础架构搭建
- 实现核心功能模块
- 优化用户界面设计
- 完善错误处理机制 